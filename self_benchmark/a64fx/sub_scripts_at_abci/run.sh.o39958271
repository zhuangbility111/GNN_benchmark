NUM_THREADS: 20
CONDA_PREFIX: /home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10
Running 2 tasks on 1 nodes
CCL count: ,2
Affinity: , 0 1 20 21
/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/bin/python
/bin/gcc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpicc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpiexec.hydra
#### INITIAL ENV ####
Using CCL_ROOT=/groups/4/gac50544/gaa10008ku.ori/gaa10008ku.group2/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/python3.9/site-packages/oneccl_bind_pt-1.10.0-py3.9-linux-x86_64.egg/torch_ccl
Using CCL_WORKER_AFFINITY=0,1,20,21
Using CCL_WORKER_COUNT=2
Using I_MPI_HYDRA_BOOTSTRAP=sge
Using I_MPI_JOB_RESPECT_PROCESS_PLACEMENT=0
Using I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000]
Using I_MPI_ROOT=/apps/intel/2023.0/mpi/2021.8.0
Using KMP_AFFINITY=compact,1,granularity=fine,verbose
Using KMP_BLOCKTIME=1
Using OMP_NUM_THREADS=18
Using LD_PRELOAD=/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/libiomp5.so
Using ARGS_NTASKS=2
Using ARGS_PPN=1
#### INITIAL ENV ####
PyTorch version: 1.10.0
MASTER_ADDR=g0005.abci.local
Running mpiexec.hydra -np 2 -ppn 1  -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18  python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=true --num_epochs=20
[0] g0005.abci.local
[1] g0008.abci.local
Running mpiexec.hydra -np 2 -ppn 1 -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18 python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=true --num_epochs=20
Start Time:  Fri Jun  9 11:19:05 JST 2023
[0] elapsed time of allocating memory (spmm on forward): [1] elapsed time of allocating memory (spmm on forward): [0] 0.000837
[1] 0.002117
[1] elapsed time of no tile's kernel = 648.788ms
[1] elapsed time of no tile's spmm:649.737
[0] elapsed time of no tile's kernel = 830.322ms
[0] elapsed time of no tile's spmm:859.169
[1] elapsed time of allocating memory (spmm on forward): 0.000866
[1] elapsed time of no tile's kernel = 37.299ms
[1] elapsed time of no tile's spmm:37.3648
[0] elapsed time of allocating memory (spmm on forward): 0.000801
[0] elapsed time of no tile's kernel = 37.4041ms
[0] elapsed time of no tile's spmm:37.4689
[0] elapsed time of allocating memory (spmm on forward): 0.001364
[1] elapsed time of allocating memory (spmm on forward): 0.001117
[1] elapsed time of no tile's kernel = 664.834ms
[1] elapsed time of no tile's spmm:664.9
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001422
[1] elapsed time of no tile's kernel = 36.8485ms
[1] elapsed time of no tile's spmm:36.9191
[0] elapsed time of no tile's kernel = 847.81ms
[0] elapsed time of no tile's spmm:847.867
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001308
[0] elapsed time of no tile's kernel = [0] 37.3862ms
[0] elapsed time of no tile's spmm:37.4641
[0] elapsed time of allocating memory (spmm on forward): 0.000871
[1] elapsed time of allocating memory (spmm on forward): 0.000998
[1] elapsed time of no tile's kernel = 127.495ms
[1] elapsed time of no tile's spmm:127.553
[1] elapsed time of allocating memory (spmm on forward): 0.001036
[1] elapsed time of no tile's kernel = [1] 7.15302ms
[1] elapsed time of no tile's spmm:7.21728
[0] elapsed time of no tile's kernel = 161.525ms
[0] elapsed time of no tile's spmm:161.588
[0] elapsed time of allocating memory (spmm on forward): 0.001176
[0] elapsed time of no tile's kernel = [0] 6.94701ms
[0] elapsed time of no tile's spmm:7.01512
[0] elapsed time of allocating memory (spmm on forward): 0.00113
[0] elapsed time of no tile's kernel = 4.23018ms
[0] elapsed time of no tile's spmm:4.29033
[1] elapsed time of allocating memory (spmm on forward): 0.001797
[1] elapsed time of no tile's kernel = 4.13425ms[1] 
[1] elapsed time of no tile's spmm:4.18982
[1] elapsed time of allocating memory (spmm on forward): 0.001078
[1] elapsed time of no tile's kernel = 128.008ms
[1] elapsed time of no tile's spmm:128.081
[1] elapsed time of allocating memory (spmm on forward): 0.001291
[1] elapsed time of no tile's kernel = 20.0496[1] ms
[1] elapsed time of no tile's spmm:20.1106
[1] elapsed time of allocating memory (spmm on forward): 0.000992
[0] elapsed time of allocating memory (spmm on forward): 0.001238
[0] elapsed time of no tile's kernel = 160.875ms
[0] elapsed time of no tile's spmm:160.93
[0] elapsed time of allocating memory (spmm on forward): 0.00111
[0] elapsed time of no tile's kernel = 21.6028ms
[0] elapsed time of no tile's spmm:21.6618
[0] elapsed time of allocating memory (spmm on forward): 0.001208
[1] elapsed time of no tile's kernel = 1174.05ms
[1] elapsed time of no tile's spmm:1174.14
[1] elapsed time of allocating memory (spmm on forward): 0.001482
[1] elapsed time of no tile's kernel = 19.9682ms
[1] elapsed time of no tile's spmm:20.0278[1] 
[1] elapsed time of allocating memory (spmm on forward): 0.001064
[0] elapsed time of no tile's kernel = 839.453ms
[0] elapsed time of no tile's spmm:839.511
[0] elapsed time of allocating memory (spmm on forward): 0.001196
[0] elapsed time of no tile's kernel = 21.4814ms
[0] elapsed time of no tile's spmm:21.5377
[0] elapsed time of allocating memory (spmm on forward): 0.000974
[1] elapsed time of no tile's kernel = 1026.87ms
[1] elapsed time of no tile's spmm:1026.94
[0] elapsed time of no tile's kernel = 847.352ms
[0] elapsed time of no tile's spmm:847.411
[1] elapsed time of allocating memory (spmm on forward): 0.001104
[0] elapsed time of allocating memory (spmm on forward): 0.000968
[1] elapsed time of no tile's kernel = 663.08ms
[1] elapsed time of no tile's spmm:663.142
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001166
[1] elapsed time of no tile's kernel = [1] 36.8033ms
[1] elapsed time of no tile's spmm:36.8738
[0] elapsed time of no tile's kernel = 847.373ms
[0] elapsed time of no tile's spmm:847.433
[0] elapsed time of allocating memory (spmm on forward): 0.001647
[0] elapsed time of no tile's kernel = [0] 37.4637ms
[0] elapsed time of no tile's spmm:37.5454
[1] elapsed time of allocating memory (spmm on forward): 0.001163
[0] elapsed time of allocating memory (spmm on forward): 0.000894
[1] elapsed time of no tile's kernel = 668.183ms
[1] elapsed time of no tile's spmm:668.266
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001162
[1] elapsed time of no tile's kernel = [1] 36.8381ms
[1] elapsed time of no tile's spmm:36.9088
[0] elapsed time of no tile's kernel = 847.82ms
[0] elapsed time of no tile's spmm:847.881
[0] elapsed time of allocating memory (spmm on forward): 0.001673
[0] elapsed time of no tile's kernel = 37.053ms
[0] elapsed time of no tile's spmm:37.13
[0] elapsed time of allocating memory (spmm on forward): 0.000994
[1] elapsed time of allocating memory (spmm on forward): 0.001417
[1] elapsed time of no tile's kernel = 127.387ms
[1] elapsed time of no tile's spmm:127.457
[1] elapsed time of allocating memory (spmm on forward): [1] 0.00094
[1] elapsed time of no tile's kernel = [1] 7.11712ms
[1] elapsed time of no tile's spmm:7.18079
[1] graph_name = products, model_name = sage, is_async = False, is_fp16 = True
[1] num_epochs = 20, in_channels = 100, hidden_channels = 256, out_channels = 47
[1] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[1] PMI_SIZE = 2
[1] PMI_RANK = 1
[1] use ccl backend for torch.distributed package on x86 cpu.
[1] dist_info RANK: 1, SIZE: 2
[1] Rank = 1, Number of threads = 18
[1] int64
[1] nodes_id_range: 1239902 - 2449028
[1] nodes_feat_list.shape:
[1] (1209127, 100)
[1] float32
[1] int64
[1] [[    567    1560    3949 ... 1127231 1158662 1174515]
[1]  [      0       0       0 ... 1209126 1209126 1209126]]
[1] local remote_nodes_num_from_each_subgraph:
[1] tensor([289377,      0])
[1] int64
[1] elapsed time of loading dataset mask(ms) = 176.32115609012544
[1] elapsed time of obtaining number of remote nodes(ms) = 2528.5126988310367
[1] elapsed time of obtaining list of remote nodes(ms) = 170.3398679383099
[1] convs.0.bias torch.Size([256])
[1] convs.0.lin.weight torch.Size([256, 100])
[1] convs.1.bias torch.Size([256])
[1] convs.1.lin.weight torch.Size([256, 256])
[1] convs.2.bias torch.Size([47])
[1] convs.2.lin.weight torch.Size([47, 256])
[1] $$$$
[1] Time of prepare send data(ms): 9.842681931331754
[1] Time of prepare recv data(ms): 0.0010230578482151031
[1] Time of barrier (all to all)(ms): 2.830678829923272
[1] Time of comm data (all to all)(ms): 32.52048813737929
[1] $$$$
[1] tensor([      0,   18811,   37912,   80820,  168637,  255166,  342785,  430229,
[1]          517378,  604507,  623852,  642929,  687592,  774203,  861392,  948028,
[1]         1035403, 1122003, 1209127], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([      0,   15916,   31391,   48270,  132969,  228000,  321734,  415264,
[1]          507817,  603262,  620173,  636779,  656423,  742172,  835993,  929044,
[1]         1020174, 1113710, 1209127], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0674249604344368
[1] Time of comm_forward(ms): 49.84415811486542
[1] Time of local aggregate(ms): 6297.381778014824
[1] Time of async wait(ms): 6.960356840863824
[1] Time of remote aggregate(ms): 5418.637029128149
[1] Time of sum up message(ms): 0.0008738134056329727
[1] Time of 1 dist conv forward(inner)(ms): 11772.891620872542
[1] #########
[1] Time of propagate(inner)(ms) = 11773.151124827564
[1] **************
[1] Time of linear(ms): 331.5890431404114
[1] Time of propagate(ms): 11773.170673986897
[1] Time of add_bias(ms): 74.3044710252434
[1] Time of 1 dist conv forward(ms): 12394.776117056608
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 12398.1267
[1] Time of relu(ms): 50.3500
[1] Time of dropout(ms): 515.8456
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.417784865945578
[1] Time of prepare recv data(ms): 0.0003969762474298477
[1] Time of barrier (all to all)(ms): 35.24087416008115
[1] Time of comm data (all to all)(ms): 17.2206477727741
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03154715523123741
[1] Time of comm_forward(ms): 65.5931388027966
[1] Time of local aggregate(ms): 729.1697920300066
[1] Time of async wait(ms): 5.815059179440141
[1] Time of remote aggregate(ms): 37.36565983854234
[1] Time of sum up message(ms): 0.0008151400834321976
[1] Time of 1 dist conv forward(inner)(ms): 837.9760121461004
[1] #########
[1] Time of propagate(inner)(ms) = 838.0912139546126
[1] **************
[1] Time of linear(ms): 116.9181140139699
[1] Time of propagate(ms): 838.1081388797611
[1] Time of add_bias(ms): 74.45362117141485
[1] Time of 1 dist conv forward(ms): 1208.8422300294042
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1212.0117
[1] Time of relu(ms): 52.5952
[1] Time of dropout(ms): 200.1090
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.157921902835369
[1] Time of prepare recv data(ms): 0.0004039611667394638
[1] Time of barrier (all to all)(ms): 219.27729318849742
[1] Time of comm data (all to all)(ms): 13.583680847659707
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03143097274005413
[1] Time of comm_forward(ms): 235.7353640254587
[1] Time of local aggregate(ms): 137.5115269329399
[1] Time of async wait(ms): 1.236232928931713
[1] Time of remote aggregate(ms): 7.667285157367587
[1] Time of sum up message(ms): 0.0007918570190668106
[1] Time of 1 dist conv forward(inner)(ms): 382.182631874457
[1] #########
[1] Time of propagate(inner)(ms) = 382.3012160137296
[1] **************
[1] Time of linear(ms): 25.3710791002959
[1] Time of propagate(ms): 382.3182499036193
[1] Time of add_bias(ms): 15.949581982567906
[1] Time of 1 dist conv forward(ms): 601.634314050898
[1] **************
[1] tensor([     0,   9829,  19500,  30552,  49736,  68963,  88285, 107570, 126177,
[1]         145115, 154987, 164728, 175614, 194539, 213368, 232381, 251589, 270601,
[1]         289377], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([      0,   18811,   37912,   80820,  168637,  255166,  342785,  430229,
[1]          517378,  604507,  623852,  642929,  687592,  774203,  861392,  948028,
[1]         1035403, 1122003, 1209127], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 0, loss: 3.7785940170288086
[1] $$$$
[1] Time of prepare send data(ms): 9.335818933323026
[1] Time of prepare recv data(ms): 0.0002470333129167557
[1] Time of barrier (all to all)(ms): 3.713419893756509
[1] Time of comm data (all to all)(ms): 17.000901978462934
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03112107515335083
[1] Time of comm_forward(ms): 33.6793209426105
[1] Time of local aggregate(ms): 718.319962034002
[1] Time of async wait(ms): 5.862287012860179
[1] Time of remote aggregate(ms): 37.323202937841415
[1] Time of sum up message(ms): 0.0007650814950466156
[1] Time of 1 dist conv forward(inner)(ms): 795.2166590839624
[1] #########
[1] Time of propagate(inner)(ms) = 795.3333728946745
[1] **************
[1] Time of linear(ms): 53.926276974380016
[1] Time of propagate(ms): 795.3512789681554
[1] Time of add_bias(ms): 75.26728790253401
[1] Time of 1 dist conv forward(ms): 924.5462929829955
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 927.8593
[1] Time of relu(ms): 50.1423
[1] Time of dropout(ms): 196.2468
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.275598917156458
[1] Time of prepare recv data(ms): 0.0011220108717679977
[1] Time of barrier (all to all)(ms): 198.57262098230422
[1] Time of comm data (all to all)(ms): 17.432428197935224
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.034747179597616196
[1] Time of comm_forward(ms): 228.94959594123065
[1] Time of local aggregate(ms): 722.6616819389164
[1] Time of async wait(ms): 5.858460906893015
[1] Time of remote aggregate(ms): 37.3705520760268
[1] Time of sum up message(ms): 0.0008051283657550812
[1] Time of 1 dist conv forward(inner)(ms): 994.8758431710303
[1] #########
[1] Time of propagate(inner)(ms) = 994.9981430545449
[1] **************
[1] Time of linear(ms): 99.34950806200504
[1] Time of propagate(ms): 995.019085938111
[1] Time of add_bias(ms): 74.65038308873773
[1] Time of 1 dist conv forward(ms): 1169.0207251813263
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1172.1503
[1] Time of relu(ms): 51.3966
[1] Time of dropout(ms): 195.0231
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1834811195731163
[1] Time of prepare recv data(ms): 0.0001778826117515564
[1] Time of barrier (all to all)(ms): 187.09946796298027
[1] Time of comm data (all to all)(ms): 13.417280977591872
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030094990506768227
[1] Time of comm_forward(ms): 203.55681492947042
[1] Time of local aggregate(ms): 136.2933360505849
[1] Time of async wait(ms): 1.2061288580298424
[1] Time of remote aggregate(ms): 7.639033021405339
[1] Time of sum up message(ms): 0.0009699724614620209
[1] Time of 1 dist conv forward(inner)(ms): 348.72637782245874
[1] #########
[1] Time of propagate(inner)(ms) = 348.84071606211364
[1] **************
[1] Time of linear(ms): 25.12973896227777
[1] Time of propagate(ms): 348.8584749866277
[0] elapsed time of no tile's kernel = 161.524ms
[0] elapsed time of no tile's spmm:161.584
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00132
[0] elapsed time of no tile's kernel = [0] 7.00199ms
[0] elapsed time of no tile's spmm:7.07184
[0] graph_name = products, model_name = sage, is_async = False, is_fp16 = True
[0] num_epochs = 20, in_channels = 100, hidden_channels = 256, out_channels = 47
[0] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[0] PMI_SIZE = 2
[0] PMI_RANK = 0
[0] use ccl backend for torch.distributed package on x86 cpu.
[0] dist_info RANK: 0, SIZE: 2
[0] Rank = 0, Number of threads = 18
[0] int64
[0] nodes_id_range: 0 - 1239901
[0] nodes_feat_list.shape:
[0] (1239902, 100)
[0] float32
[0] int64
[0] [[    100     642    1983 ...  499311  808625  964678]
[0]  [      0       0       0 ... 1239901 1239901 1239901]]
[0] local remote_nodes_num_from_each_subgraph:
[0] tensor([     0, 244144])
[0] int64
[0] elapsed time of loading dataset mask(ms) = 113.99914603680372
[0] elapsed time of obtaining number of remote nodes(ms) = 2590.8196789678186
[0] elapsed time of obtaining list of remote nodes(ms) = 170.39594193920493
[0] convs.0.bias torch.Size([256])
[0] convs.0.lin.weight torch.Size([256, 100])
[0] convs.1.bias torch.Size([256])
[0] convs.1.lin.weight torch.Size([256, 256])
[0] convs.2.bias torch.Size([47])
[0] convs.2.lin.weight torch.Size([47, 256])
[0] $$$$
[0] Time of prepare send data(ms): 11.05346786789596
[0] Time of prepare recv data(ms): 0.0008230563253164291
[0] Time of barrier (all to all)(ms): 0.2641140017658472
[0] Time of comm data (all to all)(ms): 33.35311892442405
[0] $$$$
[0] tensor([      0,   21333,   42311,   88203,  177342,  265521,  354027,  443478,
[0]          531520,  620004,  641089,  662380,  708070,  796881,  885306,  974404,
[0]         1063502, 1150841, 1239902], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([      0,   18381,   36432,   59127,  151566,  245519,  340904,  436183,
[0]          527671,  620203,  638579,  656712,  679207,  770768,  863870,  958966,
[0]         1053315, 1146733, 1239902], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.06465986371040344
[0] Time of comm_forward(ms): 49.9586071819067
[0] Time of local aggregate(ms): 6478.228662861511
[0] Time of async wait(ms): 5.854766117408872
[0] Time of remote aggregate(ms): 5340.034739812836
[0] Time of sum up message(ms): 0.0007681082934141159
[0] Time of 1 dist conv forward(inner)(ms): 11874.142203945667
[0] #########
[0] Time of propagate(inner)(ms) = 11874.301188858226
[0] **************
[0] Time of linear(ms): 303.9618139155209
[0] Time of propagate(ms): 11874.32082509622
[0] Time of add_bias(ms): 76.83684583753347
[0] Time of 1 dist conv forward(ms): 12499.187992885709
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 12502.3993
[0] Time of relu(ms): 53.7200
[0] Time of dropout(ms): 429.9497
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.918586049228907
[0] Time of prepare recv data(ms): 0.000684056431055069
[0] Time of barrier (all to all)(ms): 0.2798140048980713
[0] Time of comm data (all to all)(ms): 18.082953989505768
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03430596552789211
[0] Time of comm_forward(ms): 33.52076909504831
[0] Time of local aggregate(ms): 907.687827013433
[0] Time of async wait(ms): 4.93742898106575
[0] Time of remote aggregate(ms): 37.91669104248285
[0] Time of sum up message(ms): 0.0007490161806344986
[0] Time of 1 dist conv forward(inner)(ms): 984.0977711137384
[0] #########
[0] Time of propagate(inner)(ms) = 984.2190321069211
[0] **************
[0] Time of linear(ms): 101.51039808988571
[0] Time of propagate(ms): 984.2385509982705
[0] Time of add_bias(ms): 76.2774080503732
[0] Time of 1 dist conv forward(ms): 1367.908660089597
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1371.0796
[0] Time of relu(ms): 53.0144
[0] Time of dropout(ms): 205.5502
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4506449699401855
[0] Time of prepare recv data(ms): 0.0003220047801733017
[0] Time of barrier (all to all)(ms): 0.2692278940230608
[0] Time of comm data (all to all)(ms): 13.441261136904359
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030360184609889984
[0] Time of comm_forward(ms): 16.90155896358192
[0] Time of local aggregate(ms): 170.44612998142838
[0] Time of async wait(ms): 1.0183739941567183
[0] Time of remote aggregate(ms): 7.458332926034927
[0] Time of sum up message(ms): 0.0008989591151475906
[0] Time of 1 dist conv forward(inner)(ms): 195.855655008927
[0] #########
[0] Time of propagate(inner)(ms) = 195.97619213163853
[0] **************
[0] Time of linear(ms): 25.489357067272067
[0] Time of propagate(ms): 195.99447096697986
[0] Time of add_bias(ms): 14.43486800417304
[0] Time of 1 dist conv forward(ms): 445.74631191790104
[0] **************
[0] tensor([     0,   7539,  14851,  22574,  38655,  55428,  71988,  88566, 105040,
[0]         121970, 129669, 137539, 145923, 161808, 178295, 194544, 210692, 227341,
[0]         244144], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([      0,   21333,   42311,   88203,  177342,  265521,  354027,  443478,
[0]          531520,  620004,  641089,  662380,  708070,  796881,  885306,  974404,
[0]         1063502, 1150841, 1239902], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 0, loss: 3.8650994300842285
[0] $$$$
[0] Time of prepare send data(ms): 10.953363962471485
[0] Time of prepare recv data(ms): 0.0004130415618419647
[0] Time of barrier (all to all)(ms): 0.29117497615516186
[0] Time of comm data (all to all)(ms): 17.857161117717624
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03252900205552578
[0] Time of comm_forward(ms): 33.358425134792924
[0] Time of local aggregate(ms): 903.5750268958509
[0] Time of async wait(ms): 4.971305141225457
[0] Time of remote aggregate(ms): 37.99469489604235
[0] Time of sum up message(ms): 0.0007990747690200806
[0] Time of 1 dist conv forward(inner)(ms): 979.9327801447362
[0] #########
[0] Time of propagate(inner)(ms) = 980.0576469860971
[0] **************
[0] Time of linear(ms): 55.08583295159042
[0] Time of propagate(ms): 980.0762571394444
[0] Time of add_bias(ms): 76.70431700535119
[0] Time of 1 dist conv forward(ms): 1111.8676580954343
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.0800
[0] Time of relu(ms): 53.3222
[0] Time of dropout(ms): 200.3625
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.924441972747445
[0] Time of prepare recv data(ms): 0.0007259659469127655
[0] Time of barrier (all to all)(ms): 0.2980360295623541
[0] Time of comm data (all to all)(ms): 18.267994048073888
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.034245895221829414
[0] Time of comm_forward(ms): 33.692723140120506
[0] Time of local aggregate(ms): 903.313155984506
[0] Time of async wait(ms): 4.942396888509393
[0] Time of remote aggregate(ms): 37.57582511752844
[0] Time of sum up message(ms): 0.0008209608495235443
[0] Time of 1 dist conv forward(inner)(ms): 979.5591679867357
[0] #########
[0] Time of propagate(inner)(ms) = 979.6781749464571
[0] **************
[0] Time of linear(ms): 100.92979995533824
[0] Time of propagate(ms): 979.6978970989585
[0] Time of add_bias(ms): 76.68004091829062
[0] Time of 1 dist conv forward(ms): 1157.3090490419418
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1160.5767
[0] Time of relu(ms): 52.6615
[0] Time of dropout(ms): 197.8424
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.456784015521407
[0] Time of prepare recv data(ms): 0.0003159511834383011
[0] Time of barrier (all to all)(ms): 0.27066795155406
[0] Time of comm data (all to all)(ms): 13.250304153189063
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032294075936079025
[0] Time of comm_forward(ms): 16.744178952649236
[0] Time of local aggregate(ms): 170.71963101625443
[0] Time of async wait(ms): 1.0091080330312252
[0] Time of remote aggregate(ms): 7.518055150285363
[0] Time of sum up message(ms): 0.0007529743015766144
[0] Time of 1 dist conv forward(inner)(ms): 196.0240202024579
[0] #########
[0] Time of propagate(inner)(ms) = 196.14888983778656
[0] **************
[0] Time of linear(ms): 24.74965900182724
[0] Time of propagate(ms): 196.16582081653178
[1] elapsed time of allocating memory (spmm on forward): 0.000989
[1] elapsed time of no tile's kernel = 3.79257ms
[1] elapsed time of no tile's spmm:3.8453
[0] elapsed time of allocating memory (spmm on forward): 0.001082
[1] elapsed time of allocating memory (spmm on forward): 0.001006
[0] elapsed time of no tile's kernel = 3.8222ms
[0] elapsed time of no tile's spmm:3.87885
[0] elapsed time of allocating memory (spmm on forward): 0.001508
[1] elapsed time of no tile's kernel = 138.437ms
[1] elapsed time of no tile's spmm:138.49
[0] elapsed time of no tile's kernel = 161.709ms
[0] elapsed time of no tile's spmm:161.762
[1] elapsed time of allocating memory (spmm on forward): 0.001405
[1] elapsed time of no tile's kernel = 20.1868ms[1] 
[1] elapsed time of no tile's spmm:20.2474
[0] elapsed time of allocating memory (spmm on forward): 0.001285
[0] elapsed time of no tile's kernel = 21.5578ms
[0] elapsed time of no tile's spmm:21.6178
[1] elapsed time of allocating memory (spmm on forward): 0.001024
[0] elapsed time of allocating memory (spmm on forward): 0.001295
[1] elapsed time of no tile's kernel = 690.564ms
[1] elapsed time of no tile's spmm:690.626
[0] elapsed time of no tile's kernel = 846.727ms
[0] elapsed time of no tile's spmm:846.814
[1] elapsed time of allocating memory (spmm on forward): 0.001482
[1] elapsed time of no tile's kernel = 20.028ms
[1] elapsed time of no tile's spmm:20.0838
[1] elapsed time of allocating memory (spmm on forward): 0.001214
[0] elapsed time of allocating memory (spmm on forward): 0.001748
[0] elapsed time of no tile's kernel = 21.5584ms
[0] elapsed time of no tile's spmm:21.6186
[0] elapsed time of allocating memory (spmm on forward): 0.000923
[1] elapsed time of no tile's kernel = 766.938ms
[1] elapsed time of no tile's spmm:767.001
[0] elapsed time of no tile's kernel = 850.247ms
[0] elapsed time of no tile's spmm:850.314
[1] elapsed time of allocating memory (spmm on forward): 0.001245
[0] elapsed time of allocating memory (spmm on forward): 0.001257
[1] elapsed time of no tile's kernel = 663.926ms
[1] elapsed time of no tile's spmm:663.989
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001198
[1] elapsed time of no tile's kernel = [1] 36.9041ms
[1] elapsed time of no tile's spmm:36.9778
[0] elapsed time of no tile's kernel = 846.559ms[0] 
[0] elapsed time of no tile's spmm:846.624
[0] elapsed time of allocating memory (spmm on forward): 0.000973
[0] elapsed time of no tile's kernel = 37.3125ms
[0] elapsed time of no tile's spmm:37.3818
[1] elapsed time of allocating memory (spmm on forward): 0.001294
[0] elapsed time of allocating memory (spmm on forward): 0.001019
[1] elapsed time of no tile's kernel = 670.793ms
[1] elapsed time of no tile's spmm:670.876
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001269
[1] elapsed time of no tile's kernel = [1] 36.7835ms
[1] elapsed time of no tile's spmm:36.8574
[0] elapsed time of no tile's kernel = 846.199ms
[0] elapsed time of no tile's spmm:846.259
[0] elapsed time of allocating memory (spmm on forward): 0.001331
[0] elapsed time of no tile's kernel = 37.5136ms
[0] elapsed time of no tile's spmm:37.5859
[0] elapsed time of allocating memory (spmm on forward): 0.001206
[1] elapsed time of allocating memory (spmm on forward): 0.001004
[1] elapsed time of no tile's kernel = 127.616ms
[1] elapsed time of no tile's spmm:127.686
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000985
[1] elapsed time of no tile's kernel = [1] 7.02302ms
[1] elapsed time of no tile's spmm:7.08727
[0] elapsed time of no tile's kernel = [0] 190.372ms
[0] elapsed time of no tile's spmm:190.44
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001115
[0] elapsed time of no tile's kernel = 6.94819ms
[0] elapsed time of no tile's spmm:7.01063
[1] elapsed time of allocating memory (spmm on forward): 0.001173
[1] elapsed time of no tile's kernel = 3.83112ms[1] 
[1] elapsed time of no tile's spmm:3.88465
[1] elapsed time of allocating memory (spmm on forward): 0.001063
[0] elapsed time of allocating memory (spmm on forward): 0.001128
[0] elapsed time of no tile's kernel = 3.88518ms
[0] elapsed time of no tile's spmm:3.94175
[0] elapsed time of allocating memory (spmm on forward): 0.001729
[1] elapsed time of no tile's kernel = 150.79ms
[1] elapsed time of no tile's spmm:150.844
[0] elapsed time of no tile's kernel = 162.089ms
[0] elapsed time of no tile's spmm:162.148
[1] elapsed time of allocating memory (spmm on forward): 0.001236
[1] elapsed time of no tile's kernel = 20.1991ms[1] 
[1] elapsed time of no tile's spmm:20.2629
[0] elapsed time of allocating memory (spmm on forward): 0.001169
[1] elapsed time of allocating memory (spmm on forward): 0.001491
[0] elapsed time of no tile's kernel = 21.4785ms
[0] elapsed time of no tile's spmm:21.5373
[0] elapsed time of allocating memory (spmm on forward): 0.001148
[1] elapsed time of no tile's kernel = 709.706ms
[1] elapsed time of no tile's spmm:709.772
[0] elapsed time of no tile's kernel = 855.021ms
[0] elapsed time of no tile's spmm:855.092
[1] elapsed time of allocating memory (spmm on forward): 0.001396
[1] elapsed time of no tile's kernel = 19.9679ms
[1] elapsed time of no tile's spmm:20.0259
[1] elapsed time of allocating memory (spmm on forward): 0.001761
[0] elapsed time of allocating memory (spmm on forward): 0.001528
[0] elapsed time of no tile's kernel = 21.5294ms
[0] elapsed time of no tile's spmm:21.5904[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.000958
[1] elapsed time of no tile's kernel = 775.846ms
[1] elapsed time of no tile's spmm:775.909
[0] elapsed time of no tile's kernel = 850.741ms
[0] elapsed time of no tile's spmm:850.802
[1] elapsed time of allocating memory (spmm on forward): 0.001045
[0] elapsed time of allocating memory (spmm on forward): 0.001015
[1] elapsed time of no tile's kernel = 664.216ms
[1] elapsed time of no tile's spmm:664.284
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001126
[1] elapsed time of no tile's kernel = [1] 36.7931ms
[1] elapsed time of no tile's spmm:36.8603
[0] elapsed time of no tile's kernel = 847.087ms
[0] elapsed time of no tile's spmm:847.161
[0] elapsed time of allocating memory (spmm on forward): 0.001347
[0] elapsed time of no tile's kernel = 37.4208ms
[0] elapsed time of no tile's spmm:37.4951
[0] elapsed time of allocating memory (spmm on forward): 0.001261
[1] elapsed time of allocating memory (spmm on forward): 0.001123
[1] elapsed time of no tile's kernel = 654.738ms
[1] elapsed time of no tile's spmm:654.802
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001397
[1] elapsed time of no tile's kernel = [1] 36.8945ms
[1] elapsed time of no tile's spmm:36.9737
[0] elapsed time of no tile's kernel = 845.952ms
[0] elapsed time of no tile's spmm:846.018
[0] elapsed time of allocating memory (spmm on forward): 0.001877
[0] elapsed time of no tile's kernel = [0] 37.287ms
[0] elapsed time of no tile's spmm:37.3603
[0] elapsed time of allocating memory (spmm on forward): 0.001101
[1] elapsed time of allocating memory (spmm on forward): 0.001001
[1] elapsed time of no tile's kernel = 127.532ms
[1] elapsed time of no tile's spmm:127.602
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001878
[1] elapsed time of no tile's kernel = [1] 7.13578ms
[1] elapsed time of no tile's spmm:7.20019
[0] elapsed time of no tile's kernel = 161.775ms
[0] elapsed time of no tile's spmm:161.838
[0] elapsed time of allocating memory (spmm on forward): 0.00112
[0] elapsed time of no tile's kernel = [0] 7.05937ms
[0] elapsed time of no tile's spmm:7.12889
[1] elapsed time of allocating memory (spmm on forward): 0.001169
[1] elapsed time of no tile's kernel = [1] 3.77092ms
[1] elapsed time of no tile's spmm:3.82642
[1] elapsed time of allocating memory (spmm on forward): 0.001032
[0] elapsed time of allocating memory (spmm on forward): 0.001061
[0] elapsed time of no tile's kernel = 3.8345ms
[0] elapsed time of no tile's spmm:3.89184
[0] elapsed time of allocating memory (spmm on forward): 0.00096
[1] elapsed time of no tile's kernel = 138.891ms
[1] elapsed time of no tile's spmm:138.946
[0] elapsed time of no tile's kernel = 161.793ms
[0] elapsed time of no tile's spmm:161.847
[1] elapsed time of allocating memory (spmm on forward): 0.001386
[1] elapsed time of no tile's kernel = 20.046ms[1] 
[1] elapsed time of no tile's spmm:20.1056
[0] elapsed time of allocating memory (spmm on forward): 0.001276[0] 
[0] elapsed time of no tile's kernel = 21.5332ms
[0] elapsed time of no tile's spmm:21.595
[1] elapsed time of allocating memory (spmm on forward): 0.00106
[0] elapsed time of allocating memory (spmm on forward): 0.001195
[1] elapsed time of no tile's kernel = 699.562ms
[1] elapsed time of no tile's spmm:699.623
[0] elapsed time of no tile's kernel = 850.566ms
[0] elapsed time of no tile's spmm:850.633
[1] elapsed time of allocating memory (spmm on forward): 0.001514
[1] elapsed time of no tile's kernel = 19.9531ms[1] 
[1] elapsed time of no tile's spmm:20.0149
[1] elapsed time of allocating memory (spmm on forward): 0.001486
[0] elapsed time of allocating memory (spmm on forward): 0.001639
[0] elapsed time of no tile's kernel = 21.516ms
[0] elapsed time of no tile's spmm:21.575[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.000905
[1] elapsed time of no tile's kernel = 772.138ms
[1] elapsed time of no tile's spmm:772.199
[0] elapsed time of no tile's kernel = 849.538ms
[0] elapsed time of no tile's spmm:849.603
[1] elapsed time of allocating memory (spmm on forward): 0.001171
[0] elapsed time of allocating memory (spmm on forward): 0.001236
[1] elapsed time of no tile's kernel = 665.06ms
[1] elapsed time of no tile's spmm:665.124
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001142
[1] elapsed time of no tile's kernel = [1] 36.9782ms
[1] elapsed time of no tile's spmm:37.0465
[0] elapsed time of no tile's kernel = 848.038ms
[0] elapsed time of no tile's spmm:848.096
[0] elapsed time of allocating memory (spmm on forward): 0.001719
[0] elapsed time of no tile's kernel = [0] 37.5454ms
[0] elapsed time of no tile's spmm:37.6178
[1] Time of add_bias(ms): 16.608600039035082
[1] Time of 1 dist conv forward(ms): 390.5984170269221
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 1, loss: 2.0179367065429688
[1] $$$$
[1] Time of prepare send data(ms): 9.419555077329278
[1] Time of prepare recv data(ms): 0.000817934051156044
[1] Time of barrier (all to all)(ms): 3.934450913220644
[1] Time of comm data (all to all)(ms): 16.985725145787
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.033556949347257614
[1] Time of comm_forward(ms): 33.92490302212536
[1] Time of local aggregate(ms): 718.9699879381806
[1] Time of async wait(ms): 5.81296905875206
[1] Time of remote aggregate(ms): 37.429549964144826
[1] Time of sum up message(ms): 0.0007711350917816162
[1] Time of 1 dist conv forward(inner)(ms): 796.1717380676419
[1] #########
[1] Time of propagate(inner)(ms) = 796.2872700300068
[1] **************
[1] Time of linear(ms): 53.755049128085375
[1] Time of propagate(ms): 796.3058559689671
[1] Time of add_bias(ms): 73.94311297684908
[1] Time of 1 dist conv forward(ms): 924.0053310059011
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 927.4065
[1] Time of relu(ms): 50.8161
[1] Time of dropout(ms): 195.9134
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.267359972000122
[1] Time of prepare recv data(ms): 0.0005939509719610214
[1] Time of barrier (all to all)(ms): 197.81176513060927
[1] Time of comm data (all to all)(ms): 17.48502696864307
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03328709863126278
[1] Time of comm_forward(ms): 228.25543698854744
[1] Time of local aggregate(ms): 725.3573338966817
[1] Time of async wait(ms): 5.880710203200579
[1] Time of remote aggregate(ms): 37.319313967600465
[1] Time of sum up message(ms): 0.0008889473974704742
[1] Time of 1 dist conv forward(inner)(ms): 996.8469711020589
[1] #########
[1] Time of propagate(inner)(ms) = 996.9622339121997
[1] **************
[1] Time of linear(ms): 99.26052298396826
[1] Time of propagate(ms): 996.980314143002
[1] Time of add_bias(ms): 74.38197894953191
[1] Time of 1 dist conv forward(ms): 1170.6244489178061
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1173.8044
[1] Time of relu(ms): 51.2774
[1] Time of dropout(ms): 195.5314
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.202774165198207
[1] Time of prepare recv data(ms): 0.00023585744202136993
[1] Time of barrier (all to all)(ms): 187.56406102329493
[1] Time of comm data (all to all)(ms): 13.68217309936881
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.04571606405079365
[1] Time of comm_forward(ms): 204.16148798540235
[1] Time of local aggregate(ms): 136.3600599579513
[1] Time of async wait(ms): 1.2101740576326847
[1] Time of remote aggregate(ms): 7.564062951132655
[1] Time of sum up message(ms): 0.0012279488146305084
[1] Time of 1 dist conv forward(inner)(ms): 349.3427289649844
[1] #########
[1] Time of propagate(inner)(ms) = 349.45524693466723
[1] **************
[1] Time of linear(ms): 24.65797495096922
[1] Time of propagate(ms): 349.4720789603889
[1] Time of add_bias(ms): 15.833358047530055
[1] Time of 1 dist conv forward(ms): 389.9649940431118
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 2, loss: 1.307379126548767
[1] $$$$
[1] Time of prepare send data(ms): 9.36447991989553
[1] Time of prepare recv data(ms): 0.000616069883108139
[1] Time of barrier (all to all)(ms): 3.6955929826945066
[1] Time of comm data (all to all)(ms): 16.993651865050197
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.033980002626776695
[1] Time of comm_forward(ms): 33.62534404732287
[1] Time of local aggregate(ms): 719.031963031739
[1] Time of async wait(ms): 5.804118933156133
[1] Time of remote aggregate(ms): 37.31668507680297
[1] Time of sum up message(ms): 0.0007960479706525803
[1] Time of 1 dist conv forward(inner)(ms): 795.8128871396184
[1] #########
[1] Time of propagate(inner)(ms) = 795.923514990136
[1] **************
[1] Time of linear(ms): 53.85095183737576
[1] Time of propagate(ms): 795.9559431765229
[1] Time of add_bias(ms): 74.62062779814005
[1] Time of 1 dist conv forward(ms): 924.4289849884808
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 927.7516
[1] Time of relu(ms): 50.5835
[1] Time of dropout(ms): 195.6933
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.204172994941473
[1] Time of prepare recv data(ms): 0.000391155481338501
[1] Time of barrier (all to all)(ms): 201.27350697293878
[1] Time of comm data (all to all)(ms): 17.129956977441907
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02881116233766079
[1] Time of comm_forward(ms): 231.19597788900137
[1] Time of local aggregate(ms): 721.2033721152693
[1] Time of async wait(ms): 5.8625799138098955
[1] Time of remote aggregate(ms): 37.43897005915642
[1] Time of sum up message(ms): 0.0010379590094089508
[1] Time of 1 dist conv forward(inner)(ms): 995.730749098584
[1] #########
[1] Time of propagate(inner)(ms) = 995.8401690237224
[1] **************
[1] Time of linear(ms): 99.22118997201324
[1] Time of propagate(ms): 995.8565540146083
[1] Time of add_bias(ms): 74.10401804372668
[1] Time of 1 dist conv forward(ms): 1169.1834039520472
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1172.2808
[1] Time of relu(ms): 50.7490
[1] Time of dropout(ms): 195.8915
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1719501819461584
[1] Time of prepare recv data(ms): 0.00025192275643348694
[1] Time of barrier (all to all)(ms): 187.59104888886213
[1] Time of comm data (all to all)(ms): 13.340111123397946
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030656810849905014
[1] Time of comm_forward(ms): 203.92581820487976
[1] Time of local aggregate(ms): 137.1431238949299
[1] Time of async wait(ms): 1.2007670011371374
[1] Time of remote aggregate(ms): 7.666758960112929
[1] Time of sum up message(ms): 0.0008100178092718124
[1] Time of 1 dist conv forward(inner)(ms): 349.9679348897189
[1] #########
[1] Time of propagate(inner)(ms) = 350.0789979007095
[1] **************
[1] Time of linear(ms): 25.50693112425506
[1] Time of propagate(ms): 350.09540989995
[1] Time of add_bias(ms): 15.890419017523527
[1] Time of 1 dist conv forward(ms): 391.4944480638951
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 3, loss: 1.147058367729187
[1] $$$$
[1] Time of prepare send data(ms): 9.361393982544541
[1] Time of prepare recv data(ms): 0.0006449408829212189
[1] Time of barrier (all to all)(ms): 3.7324419245123863
[1] Time of comm data (all to all)(ms): 17.089252127334476
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.04023103974759579
[1] Time of comm_forward(ms): 33.745029009878635
[1] Time of local aggregate(ms): 719.9517090339214
[1] Time of async wait(ms): 5.839324789121747
[1] Time of remote aggregate(ms): 37.50480618327856
[1] Time of sum up message(ms): 0.0011648517102003098
[1] Time of 1 dist conv forward(inner)(ms): 797.0822649076581
[1] #########
[1] Time of propagate(inner)(ms) = 797.1968539059162
[1] **************
[1] Time of linear(ms): 53.771575912833214
[1] Time of propagate(ms): 797.2136549651623
[1] Time of add_bias(ms): 74.78799601085484
[1] Time of 1 dist conv forward(ms): 925.774889998138
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.1951
[1] Time of relu(ms): 51.1473
[1] Time of dropout(ms): 196.0798
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.201840963214636
[0] Time of add_bias(ms): 13.854402117431164
[0] Time of 1 dist conv forward(ms): 234.77115598507226
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 1, loss: 3.251446008682251
[0] $$$$
[0] Time of prepare send data(ms): 10.964920045807958
[0] Time of prepare recv data(ms): 0.0004039611667394638
[0] Time of barrier (all to all)(ms): 0.3069608937948942
[0] Time of comm data (all to all)(ms): 17.822758061811328
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031194882467389107
[0] Time of comm_forward(ms): 33.367545111104846
[0] Time of local aggregate(ms): 902.9680558014661
[0] Time of async wait(ms): 4.924034001305699
[0] Time of remote aggregate(ms): 37.8428699914366
[0] Time of sum up message(ms): 0.0007729977369308472
[0] Time of 1 dist conv forward(inner)(ms): 979.1344727855176
[0] #########
[0] Time of propagate(inner)(ms) = 979.250768898055
[0] **************
[0] Time of linear(ms): 55.1866430323571
[0] Time of propagate(ms): 979.2671757750213
[0] Time of add_bias(ms): 77.18323217704892
[0] Time of 1 dist conv forward(ms): 1111.638150177896
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1114.9015
[0] Time of relu(ms): 53.6427
[0] Time of dropout(ms): 199.3153
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.891793062910438
[0] Time of prepare recv data(ms): 0.00036298297345638275
[0] Time of barrier (all to all)(ms): 0.22091902792453766
[0] Time of comm data (all to all)(ms): 18.325699027627707
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.04334002733230591
[0] Time of comm_forward(ms): 33.628415083512664
[0] Time of local aggregate(ms): 903.4184219781309
[0] Time of async wait(ms): 4.981183912605047
[0] Time of remote aggregate(ms): 38.020753068849444
[0] Time of sum up message(ms): 0.0007310882210731506
[0] Time of 1 dist conv forward(inner)(ms): 980.0928451586515
[0] #########
[0] Time of propagate(inner)(ms) = 980.2142679691315
[0] **************
[0] Time of linear(ms): 100.99879186600447
[0] Time of propagate(ms): 980.2321570459753
[0] Time of add_bias(ms): 75.93577192164958
[0] Time of 1 dist conv forward(ms): 1157.1681778877974
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1160.4177
[0] Time of relu(ms): 53.1448
[0] Time of dropout(ms): 199.0637
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.474701963365078
[0] Time of prepare recv data(ms): 0.00036694109439849854
[0] Time of barrier (all to all)(ms): 0.21178810857236385
[0] Time of comm data (all to all)(ms): 13.526563998311758
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03096996806561947
[0] Time of comm_forward(ms): 17.150389961898327
[0] Time of local aggregate(ms): 199.40010900609195
[0] Time of async wait(ms): 1.0517630726099014
[0] Time of remote aggregate(ms): 7.479392923414707
[0] Time of sum up message(ms): 0.0007860362529754639
[0] Time of 1 dist conv forward(inner)(ms): 225.11341096833348
[0] #########
[0] Time of propagate(inner)(ms) = 225.24960292503238
[0] **************
[0] Time of linear(ms): 25.79196891747415
[0] Time of propagate(ms): 225.26546916924417
[0] Time of add_bias(ms): 14.060989953577518
[0] Time of 1 dist conv forward(ms): 265.11964993551373
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 2, loss: 2.791989326477051
[0] $$$$
[0] Time of prepare send data(ms): 11.01594790816307
[0] Time of prepare recv data(ms): 0.0002430751919746399
[0] Time of barrier (all to all)(ms): 0.29870797879993916
[0] Time of comm data (all to all)(ms): 21.82396803982556
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03029010258615017
[0] Time of comm_forward(ms): 37.389185978099704
[0] Time of local aggregate(ms): 903.2363358419389
[0] Time of async wait(ms): 4.958756035193801
[0] Time of remote aggregate(ms): 37.94781700707972
[0] Time of sum up message(ms): 0.0007480848580598831
[0] Time of 1 dist conv forward(inner)(ms): 983.5631330497563
[0] #########
[0] Time of propagate(inner)(ms) = 983.6773241404444
[0] **************
[0] Time of linear(ms): 54.97924494557083
[0] Time of propagate(ms): 983.6949629243463
[0] Time of add_bias(ms): 76.24212908558547
[0] Time of 1 dist conv forward(ms): 1114.917476894334
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1118.1799
[0] Time of relu(ms): 52.6485
[0] Time of dropout(ms): 200.1585
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.946766939014196
[0] Time of prepare recv data(ms): 0.00046798959374427795
[0] Time of barrier (all to all)(ms): 0.28877914883196354
[0] Time of comm data (all to all)(ms): 17.94717088341713
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02860487438738346
[0] Time of comm_forward(ms): 33.41345093213022
[0] Time of local aggregate(ms): 901.9964342005551
[0] Time of async wait(ms): 4.927376983687282
[0] Time of remote aggregate(ms): 37.81779482960701
[0] Time of sum up message(ms): 0.0007960479706525803
[0] Time of 1 dist conv forward(inner)(ms): 978.1844578683376
[0] #########
[0] Time of propagate(inner)(ms) = 978.3121459186077
[0] **************
[0] Time of linear(ms): 100.90598394162953
[0] Time of propagate(ms): 978.3302841242403
[0] Time of add_bias(ms): 76.04924193583429
[0] Time of 1 dist conv forward(ms): 1155.287089990452
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1158.5514
[0] Time of relu(ms): 52.8835
[0] Time of dropout(ms): 198.3237
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4744749534875154
[0] Time of prepare recv data(ms): 0.0002400483936071396
[0] Time of barrier (all to all)(ms): 0.3006670158356428
[0] Time of comm data (all to all)(ms): 13.189709978178144
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03566802479326725
[0] Time of comm_forward(ms): 16.721773892641068
[0] Time of local aggregate(ms): 171.6429281514138
[0] Time of async wait(ms): 0.9487208444625139
[0] Time of remote aggregate(ms): 7.5703870970755816
[0] Time of sum up message(ms): 0.0007620546966791153
[0] Time of 1 dist conv forward(inner)(ms): 196.9202400650829
[0] #########
[0] Time of propagate(inner)(ms) = 197.0401438884437
[0] **************
[0] Time of linear(ms): 24.785032030194998
[0] Time of propagate(ms): 197.05792795866728
[0] Time of add_bias(ms): 13.923331163823605
[0] Time of 1 dist conv forward(ms): 235.76741199940443
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 3, loss: 2.176938533782959
[0] $$$$
[0] Time of prepare send data(ms): 10.935295838862658
[0] Time of prepare recv data(ms): 0.0005860347300767899
[0] Time of barrier (all to all)(ms): 0.27921097353100777
[0] Time of comm data (all to all)(ms): 17.923868028447032
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030105002224445343
[0] Time of comm_forward(ms): 33.37901015765965
[0] Time of local aggregate(ms): 904.408385977149
[0] Time of async wait(ms): 4.941345890983939
[0] Time of remote aggregate(ms): 38.0514501594007
[0] Time of sum up message(ms): 0.0007718335837125778
[0] Time of 1 dist conv forward(inner)(ms): 980.8110690210015
[0] #########
[0] Time of propagate(inner)(ms) = 980.929743964225
[0] **************
[0] Time of linear(ms): 55.012462893500924
[0] Time of propagate(ms): 980.9469080064446
[0] Time of add_bias(ms): 76.55460410751402
[0] Time of 1 dist conv forward(ms): 1112.5153040047735
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.7894
[0] Time of relu(ms): 52.7807
[0] Time of dropout(ms): 201.1910
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.953351156786084
[0] elapsed time of allocating memory (spmm on forward): 0.000938[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001224
[1] elapsed time of no tile's kernel = 664.973ms
[1] elapsed time of no tile's spmm:665.034
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001513
[1] elapsed time of no tile's kernel = [1] 36.7854ms
[1] elapsed time of no tile's spmm:36.8541
[0] elapsed time of no tile's kernel = 846.046ms
[0] elapsed time of no tile's spmm:846.114
[0] elapsed time of allocating memory (spmm on forward): 0.001242
[0] elapsed time of no tile's kernel = 37.3927ms
[0] elapsed time of no tile's spmm:37.4648
[0] elapsed time of allocating memory (spmm on forward): 0.001232
[1] elapsed time of allocating memory (spmm on forward): 0.001009
[1] elapsed time of no tile's kernel = 128.381ms
[1] elapsed time of no tile's spmm:128.441
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000974
[1] elapsed time of no tile's kernel = [1] 7.17086ms
[1] elapsed time of no tile's spmm:7.23875
[0] elapsed time of no tile's kernel = 161.677ms
[0] elapsed time of no tile's spmm:161.732
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00116
[0] elapsed time of no tile's kernel = [0] 7.06439ms
[0] elapsed time of no tile's spmm:7.13367
[1] elapsed time of allocating memory (spmm on forward): 0.001128
[1] elapsed time of no tile's kernel = 3.83481ms
[1] elapsed time of no tile's spmm:3.88791[1] 
[0] elapsed time of allocating memory (spmm on forward): 0.001554
[1] elapsed time of allocating memory (spmm on forward): 0.001189
[0] elapsed time of no tile's kernel = 3.91148ms
[0] elapsed time of no tile's spmm:3.97116
[0] elapsed time of allocating memory (spmm on forward): 0.00117
[1] elapsed time of no tile's kernel = 138.353ms
[1] elapsed time of no tile's spmm:138.409
[0] elapsed time of no tile's kernel = 161.831ms
[0] elapsed time of no tile's spmm:161.886
[1] elapsed time of allocating memory (spmm on forward): 0.001074
[1] elapsed time of no tile's kernel = 20.1291[1] ms
[1] elapsed time of no tile's spmm:20.1892
[0] elapsed time of allocating memory (spmm on forward): 0.001066
[0] elapsed time of no tile's kernel = 21.4546ms
[0] elapsed time of no tile's spmm:21.5148
[1] elapsed time of allocating memory (spmm on forward): 0.001334
[0] elapsed time of allocating memory (spmm on forward): 0.001208
[1] elapsed time of no tile's kernel = 701.546ms
[1] elapsed time of no tile's spmm:701.616
[0] elapsed time of no tile's kernel = 856.569ms[0] 
[0] elapsed time of no tile's spmm:856.633
[1] elapsed time of allocating memory (spmm on forward): 0.001089
[1] elapsed time of no tile's kernel = 20.4861ms[1] 
[1] elapsed time of no tile's spmm:20.5447
[1] elapsed time of allocating memory (spmm on forward): 0.000951
[0] elapsed time of allocating memory (spmm on forward): 0.001044
[0] elapsed time of no tile's kernel = 21.9097ms[0] 
[0] elapsed time of no tile's spmm:21.9745
[0] elapsed time of allocating memory (spmm on forward): 0.000784[0] 
[1] elapsed time of no tile's kernel = 770.89ms
[1] elapsed time of no tile's spmm:770.969
[0] elapsed time of no tile's kernel = 857.946ms
[0] elapsed time of no tile's spmm:858.011
[1] elapsed time of allocating memory (spmm on forward): 0.001258
[0] elapsed time of allocating memory (spmm on forward): 0.000972
[1] elapsed time of no tile's kernel = 664.721ms
[1] elapsed time of no tile's spmm:664.789
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001387
[1] elapsed time of no tile's kernel = [1] 37.1246ms
[1] elapsed time of no tile's spmm:37.2013
[0] elapsed time of no tile's kernel = 853.112[0] ms
[0] elapsed time of no tile's spmm:853.172
[0] elapsed time of allocating memory [0] (spmm on forward): [0] 0.00152
[0] elapsed time of no tile's kernel = [0] 37.2686ms
[0] elapsed time of no tile's spmm:37.3377
[1] elapsed time of allocating memory (spmm on forward): 0.001156
[0] elapsed time of allocating memory (spmm on forward): 0.001137
[1] elapsed time of no tile's kernel = 678.56ms
[1] elapsed time of no tile's spmm:678.643
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001127
[1] elapsed time of no tile's kernel = [1] 36.6863ms
[1] elapsed time of no tile's spmm:36.7555
[0] elapsed time of no tile's kernel = 848.884ms[0] 
[0] elapsed time of no tile's spmm:848.952
[0] elapsed time of allocating memory (spmm on forward): 0.001415
[0] elapsed time of no tile's kernel = 37.1229[0] ms
[0] elapsed time of no tile's spmm:37.198
[0] elapsed time of allocating memory (spmm on forward): 0.001306
[1] elapsed time of allocating memory (spmm on forward): 0.001069
[1] elapsed time of no tile's kernel = 127.686ms
[1] elapsed time of no tile's spmm:127.75
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001034
[1] elapsed time of no tile's kernel = [1] 7.07403ms
[1] elapsed time of no tile's spmm:7.14421
[0] elapsed time of no tile's kernel = 161.431ms
[0] elapsed time of no tile's spmm:161.495
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00124
[0] elapsed time of no tile's kernel = [0] 7.01528ms[0] 
[0] elapsed time of no tile's spmm:[0] 7.08538
[1] elapsed time of allocating memory (spmm on forward): 0.001263
[1] elapsed time of no tile's kernel = 3.76779ms[1] 
[1] elapsed time of no tile's spmm:3.82888
[1] elapsed time of allocating memory (spmm on forward): 0.001607
[0] elapsed time of allocating memory (spmm on forward): 0.001495
[0] elapsed time of no tile's kernel = 3.81573ms
[0] elapsed time of no tile's spmm:3.87988
[0] elapsed time of allocating memory (spmm on forward): 0.000849
[1] elapsed time of no tile's kernel = 138.115ms
[1] elapsed time of no tile's spmm:138.174
[0] elapsed time of no tile's kernel = 161.617ms
[0] elapsed time of no tile's spmm:161.674
[1] elapsed time of allocating memory (spmm on forward): 0.001526
[1] elapsed time of no tile's kernel = 19.9908ms
[1] elapsed time of no tile's spmm:20.0478
[0] elapsed time of allocating memory (spmm on forward): 0.001466
[0] elapsed time of no tile's kernel = 21.4688ms
[0] elapsed time of no tile's spmm:21.5268
[1] elapsed time of allocating memory (spmm on forward): 0.001264
[0] elapsed time of allocating memory (spmm on forward): 0.000948
[1] elapsed time of no tile's kernel = 701.032ms
[1] elapsed time of no tile's spmm:701.094
[0] elapsed time of no tile's kernel = 849.462ms
[0] elapsed time of no tile's spmm:849.525
[1] elapsed time of allocating memory (spmm on forward): 0.00152
[1] elapsed time of no tile's kernel = 20.0179ms[1] 
[1] elapsed time of no tile's spmm:20.0779
[1] elapsed time of allocating memory (spmm on forward): 0.001223
[0] elapsed time of allocating memory (spmm on forward): 0.001201
[0] elapsed time of no tile's kernel = 21.496ms
[0] elapsed time of no tile's spmm:21.562
[0] elapsed time of allocating memory (spmm on forward): 0.001168
[1] elapsed time of no tile's kernel = 768.398ms
[1] elapsed time of no tile's spmm:768.456
[0] elapsed time of no tile's kernel = 849.707ms
[0] elapsed time of no tile's spmm:849.771
[1] elapsed time of allocating memory (spmm on forward): 0.001005
[0] elapsed time of allocating memory (spmm on forward): 0.000958
[1] elapsed time of no tile's kernel = 665.342ms
[1] elapsed time of no tile's spmm:665.406
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000936
[1] elapsed time of no tile's kernel = 36.8488ms
[1] elapsed time of no tile's spmm:36.9153
[0] elapsed time of no tile's kernel = 846.906ms
[0] elapsed time of no tile's spmm:846.97
[0] elapsed time of allocating memory (spmm on forward): 0.001599
[0] elapsed time of no tile's kernel = 37.1745ms
[0] elapsed time of no tile's spmm:37.2484
[1] elapsed time of allocating memory (spmm on forward): 0.001066
[0] elapsed time of allocating memory (spmm on forward): 0.000992
[1] elapsed time of no tile's kernel = 668.174ms
[1] elapsed time of no tile's spmm:668.244
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001188
[1] elapsed time of no tile's kernel = [1] 36.7142ms
[1] elapsed time of no tile's spmm:36.7838
[0] elapsed time of no tile's kernel = 845.607ms
[0] elapsed time of no tile's spmm:845.67
[0] elapsed time of allocating memory (spmm on forward): 0.001326
[0] elapsed time of no tile's kernel = [0] 37.1153ms
[0] elapsed time of no tile's spmm:37.1904
[0] elapsed time of allocating memory (spmm on forward): 0.001189
[1] elapsed time of allocating memory (spmm on forward): 0.00137
[1] elapsed time of no tile's kernel = 127.726ms
[1] elapsed time of no tile's spmm:127.787
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000991
[1] elapsed time of no tile's kernel = [1] 7.1251ms
[1] elapsed time of no tile's spmm:7.19326
[1] Time of prepare recv data(ms): 0.0003869645297527313
[1] Time of barrier (all to all)(ms): 197.75585713796318
[1] Time of comm data (all to all)(ms): 17.4233999568969
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03105192445218563
[1] Time of comm_forward(ms): 228.03093306720257
[1] Time of local aggregate(ms): 724.3883069604635
[1] Time of async wait(ms): 5.813132971525192
[1] Time of remote aggregate(ms): 37.30516508221626
[1] Time of sum up message(ms): 0.0007550697773694992
[1] Time of 1 dist conv forward(inner)(ms): 995.5693450756371
[1] #########
[1] Time of propagate(inner)(ms) = 995.689621893689
[1] **************
[1] Time of linear(ms): 99.0591049194336
[1] Time of propagate(ms): 995.7072420511395
[1] Time of add_bias(ms): 74.14795714430511
[1] Time of 1 dist conv forward(ms): 1168.9158340450376
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1172.0333
[1] Time of relu(ms): 51.9200
[1] Time of dropout(ms): 194.8978
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.102822996675968
[1] Time of prepare recv data(ms): 0.0003129243850708008
[1] Time of barrier (all to all)(ms): 185.70429412648082
[1] Time of comm data (all to all)(ms): 13.96611682139337
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030120136216282845
[1] Time of comm_forward(ms): 202.48946291394532
[1] Time of local aggregate(ms): 136.8358361069113
[1] Time of async wait(ms): 1.2612577993422747
[1] Time of remote aggregate(ms): 7.674979977309704
[1] Time of sum up message(ms): 0.0007881317287683487
[1] Time of 1 dist conv forward(inner)(ms): 348.29244506545365
[1] #########
[1] Time of propagate(inner)(ms) = 348.4159908257425
[1] **************
[1] Time of linear(ms): 24.65387899428606
[1] Time of propagate(ms): 348.4329760540277
[1] Time of add_bias(ms): 16.046645119786263
[1] Time of 1 dist conv forward(ms): 389.13495000451803
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 4, loss: 0.8797376155853271
[1] $$$$
[1] Time of prepare send data(ms): 9.370421059429646
[1] Time of prepare recv data(ms): 0.00023585744202136993
[1] Time of barrier (all to all)(ms): 3.1176491174846888
[1] Time of comm data (all to all)(ms): 17.447511898353696
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.032730866223573685
[1] Time of comm_forward(ms): 33.6052521597594
[1] Time of local aggregate(ms): 719.7471340186894
[1] Time of async wait(ms): 5.792714888229966
[1] Time of remote aggregate(ms): 37.6530101057142
[1] Time of sum up message(ms): 0.0007830094546079636
[1] Time of 1 dist conv forward(inner)(ms): 796.8316250480711
[1] #########
[1] Time of propagate(inner)(ms) = 796.9521370250732
[1] **************
[1] Time of linear(ms): 54.47424203157425
[1] Time of propagate(ms): 796.96852597408
[1] Time of add_bias(ms): 75.20415098406374
[1] Time of 1 dist conv forward(ms): 926.6487269196659
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.8935
[1] Time of relu(ms): 50.2881
[1] Time of dropout(ms): 197.4570
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.333590976893902
[1] Time of prepare recv data(ms): 0.00022794120013713837
[1] Time of barrier (all to all)(ms): 201.09792007133365
[1] Time of comm data (all to all)(ms): 16.80625113658607
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0327560119330883
[1] Time of comm_forward(ms): 230.9019360691309
[1] Time of local aggregate(ms): 732.977382838726
[1] Time of async wait(ms): 5.807638168334961
[1] Time of remote aggregate(ms): 37.22694586031139
[1] Time of sum up message(ms): 0.0009681098163127899
[1] Time of 1 dist conv forward(inner)(ms): 1006.9476270582527
[1] #########
[1] Time of propagate(inner)(ms) = 1007.0613098796457
[1] **************
[1] Time of linear(ms): 100.4882010165602
[1] Time of propagate(ms): 1007.0782599505037
[1] Time of add_bias(ms): 74.65204317122698
[1] Time of 1 dist conv forward(ms): 1182.220034999773
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1185.3210
[1] Time of relu(ms): 50.7432
[1] Time of dropout(ms): 194.5345
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1280781365931034
[1] Time of prepare recv data(ms): 0.0005238689482212067
[1] Time of barrier (all to all)(ms): 180.77441095374525
[1] Time of comm data (all to all)(ms): 13.568722177296877
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030644936487078667
[1] Time of comm_forward(ms): 197.3445729818195
[1] Time of local aggregate(ms): 135.82495716400445
[1] Time of async wait(ms): 1.2339679524302483
[1] Time of remote aggregate(ms): 7.558296900242567
[1] Time of sum up message(ms): 0.0008749775588512421
[1] Time of 1 dist conv forward(inner)(ms): 341.9933149125427
[1] #########
[1] Time of propagate(inner)(ms) = 342.1020631212741
[1] **************
[1] Time of linear(ms): 25.399722857400775
[1] Time of propagate(ms): 342.1186301857233
[1] Time of add_bias(ms): 15.635001938790083
[1] Time of 1 dist conv forward(ms): 383.1549210008234
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 5, loss: 0.6216183304786682
[1] $$$$
[1] Time of prepare send data(ms): 9.350982960313559
[1] Time of prepare recv data(ms): 0.000500120222568512
[1] Time of barrier (all to all)(ms): 3.9437098894268274
[1] Time of comm data (all to all)(ms): 17.517393920570612
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03381585702300072
[1] Time of comm_forward(ms): 34.379584016278386
[1] Time of local aggregate(ms): 720.3415401745588
[1] Time of async wait(ms): 5.836769938468933
[1] Time of remote aggregate(ms): 37.385409930720925
[1] Time of sum up message(ms): 0.0008239876478910446
[1] Time of 1 dist conv forward(inner)(ms): 797.9779439046979
[1] #########
[1] Time of propagate(inner)(ms) = 798.0893030762672
[1] **************
[1] Time of linear(ms): 53.78107400611043
[1] Time of propagate(ms): 798.1068310327828
[1] Time of add_bias(ms): 74.48027399368584
[1] Time of 1 dist conv forward(ms): 926.3695850968361
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.6861
[1] Time of relu(ms): 51.0226
[1] Time of dropout(ms): 196.8033
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.227413916960359
[1] Time of prepare recv data(ms): 0.0008230563253164291
[1] Time of barrier (all to all)(ms): 195.99528005346656
[1] Time of comm data (all to all)(ms): 16.665560891851783
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03381911665201187
[1] Time of comm_forward(ms): 225.48762196674943
[1] Time of local aggregate(ms): 722.4916620180011
[1] Time of async wait(ms): 5.851117894053459
[1] Time of remote aggregate(ms): 37.229156121611595
[1] Time of sum up message(ms): 0.0008270144462585449
[1] Time of 1 dist conv forward(inner)(ms): 991.0942041315138
[1] #########
[1] Time of propagate(inner)(ms) = 991.2091479636729
[1] **************
[1] Time of linear(ms): 99.11724808625877
[1] Time of propagate(ms): 991.2264510057867
[1] Time of add_bias(ms): 74.7972649987787
[1] Time of 1 dist conv forward(ms): 1165.1427091564983
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1168.2437
[1] Time of relu(ms): 51.1332
[1] Time of dropout(ms): 195.1252
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.176642883569002
[1] Time of prepare recv data(ms): 0.00045099295675754547
[1] Time of barrier (all to all)(ms): 186.84180895797908
[1] Time of comm data (all to all)(ms): 13.65276100113988
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03064516931772232
[1] Time of comm_forward(ms): 203.39284278452396
[1] Time of local aggregate(ms): 136.9797100778669
[1] Time of async wait(ms): 1.2321621179580688
[0] elapsed time of no tile's kernel = [0] 161.415ms
[0] elapsed time of no tile's spmm:161.487
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001369
[0] elapsed time of no tile's kernel = [0] 7.04761ms[0] 
[0] elapsed time of no tile's spmm:[0] 7.11538
[0] Time of prepare recv data(ms): 0.0004889443516731262
[0] Time of barrier (all to all)(ms): 0.2701589837670326
[0] Time of comm data (all to all)(ms): 18.26593605801463
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031246105208992958
[0] Time of comm_forward(ms): 33.73711393214762
[0] Time of local aggregate(ms): 901.2463910039514
[0] Time of async wait(ms): 4.973653005436063
[0] Time of remote aggregate(ms): 37.92055696249008
[0] Time of sum up message(ms): 0.0007611233741044998
[0] Time of 1 dist conv forward(inner)(ms): 977.9097221326083
[0] #########
[0] Time of propagate(inner)(ms) = 978.0324879102409
[0] **************
[0] Time of linear(ms): 100.87476298213005
[0] Time of propagate(ms): 978.0489469412714
[0] Time of add_bias(ms): 75.44325198978186
[0] Time of 1 dist conv forward(ms): 1154.3683109339327
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1157.5976
[0] Time of relu(ms): 52.3331
[0] Time of dropout(ms): 199.8151
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4862438440322876
[0] Time of prepare recv data(ms): 0.00030710361897945404
[0] Time of barrier (all to all)(ms): 0.2729229163378477
[0] Time of comm data (all to all)(ms): 13.803684152662754
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032180920243263245
[0] Time of comm_forward(ms): 17.404271056875587
[0] Time of local aggregate(ms): 170.34888896159828
[0] Time of async wait(ms): 0.9328271262347698
[0] Time of remote aggregate(ms): 7.573232054710388
[0] Time of sum up message(ms): 0.0007529743015766144
[0] Time of 1 dist conv forward(inner)(ms): 196.29215309396386
[0] #########
[0] Time of propagate(inner)(ms) = 196.4126299135387
[0] **************
[0] Time of linear(ms): 25.36874101497233
[0] Time of propagate(ms): 196.4291650801897
[0] Time of add_bias(ms): 14.227888081222773
[0] Time of 1 dist conv forward(ms): 236.02733598090708
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 4, loss: 1.99518883228302
[0] $$$$
[0] Time of prepare send data(ms): 10.860281996428967
[0] Time of prepare recv data(ms): 0.0004831235855817795
[0] Time of barrier (all to all)(ms): 0.275597907602787
[0] Time of comm data (all to all)(ms): 18.252423964440823
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.034224940463900566
[0] Time of comm_forward(ms): 33.64235209301114
[0] Time of local aggregate(ms): 909.2818789649755
[0] Time of async wait(ms): 4.909320967271924
[0] Time of remote aggregate(ms): 37.78229211457074
[0] Time of sum up message(ms): 0.0009748619049787521
[0] Time of 1 dist conv forward(inner)(ms): 985.6510439421982
[0] #########
[0] Time of propagate(inner)(ms) = 985.7673340011388
[0] **************
[0] Time of linear(ms): 55.27515592984855
[0] Time of propagate(ms): 985.7844989746809
[0] Time of add_bias(ms): 76.22731011360884
[0] Time of 1 dist conv forward(ms): 1117.2880611848086
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1120.5481
[0] Time of relu(ms): 53.3989
[0] Time of dropout(ms): 199.9493
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.842347983270884
[0] Time of prepare recv data(ms): 0.00045192427933216095
[0] Time of barrier (all to all)(ms): 0.2997519914060831
[0] Time of comm data (all to all)(ms): 17.64157204888761
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02922513522207737
[0] Time of comm_forward(ms): 33.18623686209321
[0] Time of local aggregate(ms): 904.5430889818817
[0] Time of async wait(ms): 4.958156030625105
[0] Time of remote aggregate(ms): 37.65857592225075
[0] Time of sum up message(ms): 0.0007920898497104645
[0] Time of 1 dist conv forward(inner)(ms): 980.3760750219226
[0] #########
[0] Time of propagate(inner)(ms) = 980.4934468120337
[0] **************
[0] Time of linear(ms): 102.79424185864627
[0] Time of propagate(ms): 980.5113971233368
[0] Time of add_bias(ms): 75.97542088478804
[0] Time of 1 dist conv forward(ms): 1159.2822659295052
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1162.5529
[0] Time of relu(ms): 53.0592
[0] Time of dropout(ms): 199.5804
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4890180211514235
[0] Time of prepare recv data(ms): 0.0003210734575986862
[0] Time of barrier (all to all)(ms): 0.2193788532167673
[0] Time of comm data (all to all)(ms): 13.397623086348176
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.034810975193977356
[0] Time of comm_forward(ms): 16.849935986101627
[0] Time of local aggregate(ms): 169.8203480336815
[0] Time of async wait(ms): 0.9908690117299557
[0] Time of remote aggregate(ms): 7.533903932198882
[0] Time of sum up message(ms): 0.0007459893822669983
[0] Time of 1 dist conv forward(inner)(ms): 195.23061392828822
[0] #########
[0] Time of propagate(inner)(ms) = 195.35075104795396
[0] **************
[0] Time of linear(ms): 24.873028974980116
[0] Time of propagate(ms): 195.36814210005105
[0] Time of add_bias(ms): 14.120671898126602
[0] Time of 1 dist conv forward(ms): 234.36324181966484
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 5, loss: 1.7561817169189453
[0] $$$$
[0] Time of prepare send data(ms): 11.085734935477376
[0] Time of prepare recv data(ms): 0.00032619573175907135
[0] Time of barrier (all to all)(ms): 0.27177599258720875
[0] Time of comm data (all to all)(ms): 18.34793481975794
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030277995392680168
[0] Time of comm_forward(ms): 33.93921419046819
[0] Time of local aggregate(ms): 903.0477949418128
[0] Time of async wait(ms): 4.991149064153433
[0] Time of remote aggregate(ms): 37.69151191227138
[0] Time of sum up message(ms): 0.0007660128176212311
[0] Time of 1 dist conv forward(inner)(ms): 979.7007141169161
[0] #########
[0] Time of propagate(inner)(ms) = 979.8134481534362
[0] **************
[0] Time of linear(ms): 55.17398705706
[0] Time of propagate(ms): 979.8324138391763
[0] Time of add_bias(ms): 76.07002416625619
[0] Time of 1 dist conv forward(ms): 1111.077566165477
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1114.3243
[0] Time of relu(ms): 53.6092
[0] Time of dropout(ms): 201.5064
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.857332032173872
[0] Time of prepare recv data(ms): 0.0003229361027479172
[0] Time of barrier (all to all)(ms): 0.26883604004979134
[0] Time of comm data (all to all)(ms): 17.510906094685197
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030235853046178818
[0] Time of comm_forward(ms): 32.8322381246835
[0] Time of local aggregate(ms): 900.8798759896308
[0] Time of async wait(ms): 4.967103945091367
[0] Time of remote aggregate(ms): 37.63679205439985
[0] Time of sum up message(ms): 0.0009869690984487534
[0] Time of 1 dist conv forward(inner)(ms): 976.3472329359502
[0] #########
[0] Time of propagate(inner)(ms) = 976.4636021573097
[0] **************
[0] Time of linear(ms): 100.79575004056096
[0] Time of propagate(ms): 976.4803817961365
[0] Time of add_bias(ms): 76.37647120282054
[0] Time of 1 dist conv forward(ms): 1153.6539001390338
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1156.8843
[0] Time of relu(ms): 53.1902
[0] Time of dropout(ms): 198.5609
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.463296987116337
[0] Time of prepare recv data(ms): 0.00029709190130233765
[0] Time of barrier (all to all)(ms): 0.2714230213314295
[0] Time of comm data (all to all)(ms): 13.486325042322278
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030789058655500412
[0] Time of comm_forward(ms): 16.981687862426043
[0] Time of local aggregate(ms): 170.8757730666548
[0] Time of async wait(ms): 1.0068758856505156
[1] elapsed time of allocating memory (spmm on forward): 0.001039
[1] elapsed time of no tile's kernel = 3.78709ms
[1] elapsed time of no tile's spmm:3.8422
[0] elapsed time of allocating memory (spmm on forward): 0.000903
[0] elapsed time of no tile's kernel = 3.85086ms
[0] elapsed time of no tile's spmm:3.90626[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001539
[0] elapsed time of allocating memory (spmm on forward): 0.001078
[1] elapsed time of no tile's kernel = 136.795ms
[1] elapsed time of no tile's spmm:136.848
[0] elapsed time of no tile's kernel = 167.356ms
[0] elapsed time of no tile's spmm:167.44
[1] elapsed time of allocating memory (spmm on forward): 0.001418
[1] elapsed time of no tile's kernel = [1] 19.9428ms
[1] elapsed time of no tile's spmm:20.0097
[0] elapsed time of allocating memory (spmm on forward): 0.001369
[0] elapsed time of no tile's kernel = 21.4206ms
[0] elapsed time of no tile's spmm:21.4799
[1] elapsed time of allocating memory (spmm on forward): 0.001278
[0] elapsed time of allocating memory (spmm on forward): 0.001145
[1] elapsed time of no tile's kernel = 700.127ms
[1] elapsed time of no tile's spmm:700.195
[0] elapsed time of no tile's kernel = 850.739ms
[0] elapsed time of no tile's spmm:850.797
[1] elapsed time of allocating memory (spmm on forward): 0.001003
[1] elapsed time of no tile's kernel = 19.973ms
[1] elapsed time of no tile's spmm:20.0328
[1] elapsed time of allocating memory (spmm on forward): 0.001325
[0] elapsed time of allocating memory (spmm on forward): 0.001341
[0] elapsed time of no tile's kernel = 21.4932ms
[0] elapsed time of no tile's spmm:21.5523
[0] elapsed time of allocating memory (spmm on forward): 0.000905
[1] elapsed time of no tile's kernel = 774.177ms
[1] elapsed time of no tile's spmm:774.236
[0] elapsed time of no tile's kernel = 849.95ms
[0] elapsed time of no tile's spmm:850.014
[1] elapsed time of allocating memory (spmm on forward): 0.001192
[0] elapsed time of allocating memory (spmm on forward): 0.001038
[1] elapsed time of no tile's kernel = 666.531ms
[1] elapsed time of no tile's spmm:666.599
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001103
[1] elapsed time of no tile's kernel = [1] 36.8216ms
[1] elapsed time of no tile's spmm:36.8933
[0] elapsed time of no tile's kernel = 846.532ms
[0] elapsed time of no tile's spmm:846.599
[0] elapsed time of allocating memory (spmm on forward): 0.001285
[0] elapsed time of no tile's kernel = 37.7603ms
[0] elapsed time of no tile's spmm:37.8359
[1] elapsed time of allocating memory (spmm on forward): 0.001132
[0] elapsed time of allocating memory (spmm on forward): 0.001337
[1] elapsed time of no tile's kernel = 673.667ms
[1] elapsed time of no tile's spmm:673.743
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001095
[1] elapsed time of no tile's kernel = [1] 36.8748ms
[1] elapsed time of no tile's spmm:36.9445
[0] elapsed time of no tile's kernel = 847.352ms
[0] elapsed time of no tile's spmm:847.412
[0] elapsed time of allocating memory (spmm on forward): 0.00113
[0] elapsed time of no tile's kernel = 37.4006ms
[0] elapsed time of no tile's spmm:37.4744
[0] elapsed time of allocating memory (spmm on forward): 0.001156[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001064
[1] elapsed time of no tile's kernel = 127.107ms
[1] elapsed time of no tile's spmm:127.198
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001104
[1] elapsed time of no tile's kernel = [1] 7.03595ms
[1] elapsed time of no tile's spmm:7.10179
[0] elapsed time of no tile's kernel = 163.389ms
[0] elapsed time of no tile's spmm:163.449
[0] elapsed time of allocating memory (spmm on forward): 0.001274[0] 
[0] elapsed time of no tile's kernel = 7.11664ms
[0] elapsed time of no tile's spmm:[0] 7.18672
[1] elapsed time of allocating memory (spmm on forward): 0.001086
[1] elapsed time of no tile's kernel = [1] 3.78832ms
[1] elapsed time of no tile's spmm:3.84892
[1] elapsed time of allocating memory (spmm on forward): 0.001029
[0] elapsed time of allocating memory (spmm on forward): 0.001006
[0] elapsed time of no tile's kernel = 3.87451ms
[0] elapsed time of no tile's spmm:3.93129
[0] elapsed time of allocating memory (spmm on forward): 0.000925
[1] elapsed time of no tile's kernel = 138.492ms
[1] elapsed time of no tile's spmm:138.554
[0] elapsed time of no tile's kernel = 161.217ms
[0] elapsed time of no tile's spmm:161.277
[1] elapsed time of allocating memory (spmm on forward): 0.001185
[1] elapsed time of no tile's kernel = 21.2062ms
[1] elapsed time of no tile's spmm:21.2889
[0] elapsed time of allocating memory (spmm on forward): 0.001496
[0] elapsed time of no tile's kernel = 21.5407ms
[0] elapsed time of no tile's spmm:21.5983
[1] elapsed time of allocating memory (spmm on forward): 0.001312
[0] elapsed time of allocating memory (spmm on forward): 0.001279
[1] elapsed time of no tile's kernel = 700.232ms
[1] elapsed time of no tile's spmm:700.294
[0] elapsed time of no tile's kernel = 854.057ms
[0] elapsed time of no tile's spmm:854.119
[1] elapsed time of allocating memory (spmm on forward): 0.001431
[1] elapsed time of no tile's kernel = 20.0074ms
[1] elapsed time of no tile's spmm:20.065
[1] elapsed time of allocating memory (spmm on forward): 0.001617
[0] elapsed time of allocating memory (spmm on forward): 0.001298
[0] elapsed time of no tile's kernel = 21.4541ms
[0] elapsed time of no tile's spmm:21.5158
[0] elapsed time of allocating memory (spmm on forward): 0.001133
[1] elapsed time of no tile's kernel = 774.319ms
[1] elapsed time of no tile's spmm:774.379
[0] elapsed time of no tile's kernel = 850.924ms
[0] elapsed time of no tile's spmm:850.993
[1] elapsed time of allocating memory (spmm on forward): 0.001112
[0] elapsed time of allocating memory (spmm on forward): 0.001064
[1] elapsed time of no tile's kernel = 666.671ms
[1] elapsed time of no tile's spmm:666.727
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001126
[1] elapsed time of no tile's kernel = 36.9223ms
[1] elapsed time of no tile's spmm:37.015
[0] elapsed time of no tile's kernel = 847.634ms
[0] elapsed time of no tile's spmm:847.698
[0] elapsed time of allocating memory (spmm on forward): 0.001387
[0] elapsed time of no tile's kernel = [0] 37.3765ms
[0] elapsed time of no tile's spmm:37.4484
[0] elapsed time of allocating memory (spmm on forward): 0.001476
[1] elapsed time of allocating memory (spmm on forward): 0.001473
[1] elapsed time of no tile's kernel = 658.543ms
[1] elapsed time of no tile's spmm:658.606
[1] elapsed time of allocating memory (spmm on forward): [1] 0.00148
[1] elapsed time of no tile's kernel = [1] 36.7825ms
[1] elapsed time of no tile's spmm:36.8558
[0] elapsed time of no tile's kernel = 846.418ms
[0] elapsed time of no tile's spmm:846.483
[0] elapsed time of allocating memory (spmm on forward): 0.001508
[0] elapsed time of no tile's kernel = 37.1551ms
[0] elapsed time of no tile's spmm:37.227
[0] elapsed time of allocating memory (spmm on forward): 0.001251
[1] elapsed time of allocating memory (spmm on forward): 0.001601
[1] elapsed time of no tile's kernel = 128.189ms
[1] elapsed time of no tile's spmm:128.246
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000898
[1] elapsed time of no tile's kernel = [1] 7.06836ms
[1] elapsed time of no tile's spmm:7.13353
[0] elapsed time of no tile's kernel = 161.926ms
[0] elapsed time of no tile's spmm:161.991
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001117
[0] elapsed time of no tile's kernel = 6.97518[0] ms
[0] elapsed time of no tile's spmm:7.04854
[1] elapsed time of allocating memory (spmm on forward): 0.00114
[1] elapsed time of no tile's kernel = 3.82366ms[1] 
[1] elapsed time of no tile's spmm:3.8787
[0] elapsed time of allocating memory (spmm on forward): 0.001082
[1] elapsed time of allocating memory (spmm on forward): 0.000935
[0] elapsed time of no tile's kernel = 3.89142ms
[0] elapsed time of no tile's spmm:3.94962
[0] elapsed time of allocating memory (spmm on forward): 0.000976
[1] elapsed time of no tile's kernel = 138.313ms
[1] elapsed time of no tile's spmm:138.368
[0] elapsed time of no tile's kernel = 162.977ms
[0] elapsed time of no tile's spmm:163.031
[1] elapsed time of allocating memory (spmm on forward): 0.001561
[1] elapsed time of no tile's kernel = 20.0317[1] ms
[1] elapsed time of no tile's spmm:20.0928
[0] elapsed time of allocating memory (spmm on forward): 0.001232
[0] elapsed time of no tile's kernel = 21.4393ms
[0] elapsed time of no tile's spmm:21.4993
[1] elapsed time of allocating memory (spmm on forward): 0.001265
[0] elapsed time of allocating memory (spmm on forward): 0.001167
[1] elapsed time of no tile's kernel = 699.129ms
[1] elapsed time of no tile's spmm:699.187
[0] elapsed time of no tile's kernel = 850.326ms
[0] elapsed time of no tile's spmm:850.392
[1] elapsed time of allocating memory (spmm on forward): 0.00094
[1] elapsed time of no tile's kernel = 19.8961ms[1] 
[1] elapsed time of no tile's spmm:19.9545
[1] elapsed time of allocating memory (spmm on forward): 0.001408
[0] elapsed time of allocating memory (spmm on forward): 0.001163
[0] elapsed time of no tile's kernel = 21.4964ms
[0] elapsed time of no tile's spmm:21.5568
[0] elapsed time of allocating memory (spmm on forward): 0.001305
[1] elapsed time of no tile's kernel = 772.69ms
[1] elapsed time of no tile's spmm:772.753
[0] elapsed time of no tile's kernel = 849.422ms
[0] elapsed time of no tile's spmm:849.488
[1] elapsed time of allocating memory (spmm on forward): 0.00117
[0] elapsed time of allocating memory (spmm on forward): 0.001088
[1] elapsed time of no tile's kernel = 666ms
[1] elapsed time of no tile's spmm:666.063
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001015
[1] elapsed time of no tile's kernel = 37.0916ms
[1] elapsed time of no tile's spmm:37.1586
[1] Time of remote aggregate(ms): 7.641071919351816
[1] Time of sum up message(ms): 0.0008109491318464279
[1] Time of 1 dist conv forward(inner)(ms): 349.27724301815033
[1] #########
[1] Time of propagate(inner)(ms) = 349.4408819824457
[1] **************
[1] Time of linear(ms): 24.657882982864976
[1] Time of propagate(ms): 349.457009928301
[1] Time of add_bias(ms): 16.02221210487187
[1] Time of 1 dist conv forward(ms): 390.1385471690446
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 6, loss: 0.5142117738723755
[1] $$$$
[1] Time of prepare send data(ms): 9.288243018090725
[1] Time of prepare recv data(ms): 0.0008121132850646973
[1] Time of barrier (all to all)(ms): 0.28246408328413963
[1] Time of comm data (all to all)(ms): 16.88231178559363
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03218301571905613
[1] Time of comm_forward(ms): 30.171317979693413
[1] Time of local aggregate(ms): 721.4671899564564
[1] Time of async wait(ms): 5.847814958542585
[1] Time of remote aggregate(ms): 37.3485810123384
[1] Time of sum up message(ms): 0.0007899943739175797
[1] Time of 1 dist conv forward(inner)(ms): 794.8678769171238
[1] #########
[1] Time of propagate(inner)(ms) = 794.9804549571127
[1] **************
[1] Time of linear(ms): 71.40555116347969
[1] Time of propagate(ms): 794.997617835179
[1] Time of add_bias(ms): 74.29477898404002
[1] Time of 1 dist conv forward(ms): 940.700595965609
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 944.0046
[1] Time of relu(ms): 50.8251
[1] Time of dropout(ms): 196.1007
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.232962038367987
[1] Time of prepare recv data(ms): 0.0004118774086236954
[1] Time of barrier (all to all)(ms): 194.3726041354239
[1] Time of comm data (all to all)(ms): 17.022821819409728
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03388803452253342
[1] Time of comm_forward(ms): 224.27504393272102
[1] Time of local aggregate(ms): 728.4242589958012
[1] Time of async wait(ms): 5.740199936553836
[1] Time of remote aggregate(ms): 37.39636205136776
[1] Time of sum up message(ms): 0.0009529758244752884
[1] Time of 1 dist conv forward(inner)(ms): 995.8707059267908
[1] #########
[1] Time of propagate(inner)(ms) = 995.9852190222591
[1] **************
[1] Time of linear(ms): 99.33217498473823
[1] Time of propagate(ms): 996.0069330409169
[1] Time of add_bias(ms): 75.19047986716032
[1] Time of 1 dist conv forward(ms): 1170.5311639234424
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1173.7612
[1] Time of relu(ms): 51.4692
[1] Time of dropout(ms): 195.5972
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.491618040949106
[1] Time of prepare recv data(ms): 0.0005729962140321732
[1] Time of barrier (all to all)(ms): 171.93791596218944
[1] Time of comm data (all to all)(ms): 13.835188932716846
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.032815150916576385
[1] Time of comm_forward(ms): 189.07131091691554
[1] Time of local aggregate(ms): 134.734416147694
[1] Time of async wait(ms): 1.2024098541587591
[1] Time of remote aggregate(ms): 7.545192027464509
[1] Time of sum up message(ms): 0.0007420312613248825
[1] Time of 1 dist conv forward(inner)(ms): 332.5868861284107
[1] #########
[1] Time of propagate(inner)(ms) = 332.7056369744241
[1] **************
[1] Time of linear(ms): 32.642303965985775
[1] Time of propagate(ms): 332.72276003845036
[1] Time of add_bias(ms): 15.90148895047605
[1] Time of 1 dist conv forward(ms): 381.2680409755558
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 7, loss: 0.4647951126098633
[1] $$$$
[1] Time of prepare send data(ms): 9.37368394806981
[1] Time of prepare recv data(ms): 0.00038300640881061554
[1] Time of barrier (all to all)(ms): 3.8350929971784353
[1] Time of comm data (all to all)(ms): 17.575219040736556
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0403011217713356
[1] Time of comm_forward(ms): 34.346040803939104
[1] Time of local aggregate(ms): 721.7608431819826
[1] Time of async wait(ms): 5.836345953866839
[1] Time of remote aggregate(ms): 37.4739698600024
[1] Time of sum up message(ms): 0.0007851049304008484
[1] Time of 1 dist conv forward(inner)(ms): 799.4582860264927
[1] #########
[1] Time of propagate(inner)(ms) = 799.5917899534106
[1] **************
[1] Time of linear(ms): 53.79778007045388
[1] Time of propagate(ms): 799.6094988193363
[1] Time of add_bias(ms): 74.2846371140331
[1] Time of 1 dist conv forward(ms): 927.6932899374515
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 931.0210
[1] Time of relu(ms): 50.3057
[1] Time of dropout(ms): 196.4830
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.24431998282671
[1] Time of prepare recv data(ms): 0.0003359746187925339
[1] Time of barrier (all to all)(ms): 195.83835289813578
[1] Time of comm data (all to all)(ms): 17.30218715965748
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03410107456147671
[1] Time of comm_forward(ms): 225.96878092736006
[1] Time of local aggregate(ms): 725.0061500817537
[1] Time of async wait(ms): 5.85596589371562
[1] Time of remote aggregate(ms): 37.30799118056893
[1] Time of sum up message(ms): 0.0008149072527885437
[1] Time of 1 dist conv forward(inner)(ms): 994.1738040652126
[1] #########
[1] Time of propagate(inner)(ms) = 994.2952820565552
[1] **************
[1] Time of linear(ms): 99.3170109577477
[1] Time of propagate(ms): 994.3116449285299
[1] Time of add_bias(ms): 73.88417702168226
[1] Time of 1 dist conv forward(ms): 1167.5144070759416
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1170.6865
[1] Time of relu(ms): 50.8345
[1] Time of dropout(ms): 195.4526
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.210136968642473
[1] Time of prepare recv data(ms): 0.0008761417120695114
[1] Time of barrier (all to all)(ms): 186.3354300148785
[1] Time of comm data (all to all)(ms): 13.291688868775964
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03123609349131584
[1] Time of comm_forward(ms): 202.58706691674888
[1] Time of local aggregate(ms): 136.6157759912312
[1] Time of async wait(ms): 1.203645020723343
[1] Time of remote aggregate(ms): 7.580637000501156
[1] Time of sum up message(ms): 0.0009711366146802902
[1] Time of 1 dist conv forward(inner)(ms): 348.0193321593106
[1] #########
[1] Time of propagate(inner)(ms) = 348.13157585449517
[1] **************
[1] Time of linear(ms): 24.678691988810897
[1] Time of propagate(ms): 348.1478712055832
[1] Time of add_bias(ms): 16.004913952201605
[1] Time of 1 dist conv forward(ms): 388.83291301317513
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 8, loss: 0.4465602934360504
[1] $$$$
[1] Time of prepare send data(ms): 9.435338201001287
[1] Time of prepare recv data(ms): 0.0013490207493305206
[1] Time of barrier (all to all)(ms): 3.591082990169525
[1] Time of comm data (all to all)(ms): 16.633012797683477
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0331290066242218
[1] Time of comm_forward(ms): 33.284094883129
[1] Time of local aggregate(ms): 720.8702629432082
[1] Time of async wait(ms): 5.825944012030959
[1] Time of remote aggregate(ms): 37.61362307704985
[1] Time of sum up message(ms): 0.0011760275810956955
[1] Time of 1 dist conv forward(inner)(ms): 797.6282299496233
[1] #########
[1] Time of propagate(inner)(ms) = 797.7395569905639
[1] **************
[1] Time of linear(ms): 53.78483608365059
[1] Time of propagate(ms): 797.7579231373966
[1] Time of add_bias(ms): 74.37309087254107
[0] elapsed time of no tile's kernel = 846.823ms
[0] elapsed time of no tile's spmm:846.889
[0] elapsed time of allocating memory (spmm on forward): 0.001636
[0] elapsed time of no tile's kernel = 37.3797ms
[0] elapsed time of no tile's spmm:37.4513
[0] Time of remote aggregate(ms): 7.5816381722688675
[0] Time of sum up message(ms): 0.000708969309926033
[0] Time of 1 dist conv forward(inner)(ms): 196.47747301496565
[0] #########
[0] Time of propagate(inner)(ms) = 196.6299689374864
[0] **************
[0] Time of linear(ms): 24.945756187662482
[0] Time of propagate(ms): 196.64608594030142
[0] Time of add_bias(ms): 14.313201885670424
[0] Time of 1 dist conv forward(ms): 235.9061788301915
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 6, loss: 1.5940306186676025
[0] $$$$
[0] Time of prepare send data(ms): 10.97871595993638
[0] Time of prepare recv data(ms): 0.0003241002559661865
[0] Time of barrier (all to all)(ms): 14.789005042985082
[0] Time of comm data (all to all)(ms): 17.591520911082625
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02977810800075531
[0] Time of comm_forward(ms): 47.61117300949991
[0] Time of local aggregate(ms): 902.5968168862164
[0] Time of async wait(ms): 4.927942994982004
[0] Time of remote aggregate(ms): 38.28498814254999
[0] Time of sum up message(ms): 0.000983942300081253
[0] Time of 1 dist conv forward(inner)(ms): 993.4516830835491
[0] #########
[0] Time of propagate(inner)(ms) = 993.5654220171273
[0] **************
[0] Time of linear(ms): 54.86870091408491
[0] Time of propagate(ms): 993.5816351789981
[0] Time of add_bias(ms): 76.25612686388195
[0] Time of 1 dist conv forward(ms): 1124.7075630817562
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1127.9158
[0] Time of relu(ms): 53.3385
[0] Time of dropout(ms): 199.9189
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.891200043261051
[0] Time of prepare recv data(ms): 0.0003059394657611847
[0] Time of barrier (all to all)(ms): 0.29872218146920204
[0] Time of comm data (all to all)(ms): 17.84864580258727
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029457034543156624
[0] Time of comm_forward(ms): 33.249024068936706
[0] Time of local aggregate(ms): 902.944162953645
[0] Time of async wait(ms): 4.934525117278099
[0] Time of remote aggregate(ms): 37.941209971904755
[0] Time of sum up message(ms): 0.000817934051156044
[0] Time of 1 dist conv forward(inner)(ms): 979.0991970803589
[0] #########
[0] Time of propagate(inner)(ms) = 979.2181260418147
[0] **************
[0] Time of linear(ms): 101.0117968544364
[0] Time of propagate(ms): 979.2452740948647
[0] Time of add_bias(ms): 75.92178299091756
[0] Time of 1 dist conv forward(ms): 1156.1800430063158
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1159.4720
[0] Time of relu(ms): 52.7007
[0] Time of dropout(ms): 197.9912
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.523355185985565
[0] Time of prepare recv data(ms): 0.00029383227229118347
[0] Time of barrier (all to all)(ms): 0.3011471126228571
[0] Time of comm data (all to all)(ms): 13.652655994519591
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03083702176809311
[0] Time of comm_forward(ms): 17.242837930098176
[0] Time of local aggregate(ms): 171.22188513167202
[0] Time of async wait(ms): 1.0297740809619427
[0] Time of remote aggregate(ms): 7.627054816111922
[0] Time of sum up message(ms): 0.0010181684046983719
[0] Time of 1 dist conv forward(inner)(ms): 197.15340714901686
[0] #########
[0] Time of propagate(inner)(ms) = 197.2801578231156
[0] **************
[0] Time of linear(ms): 24.801326915621758
[0] Time of propagate(ms): 197.29699403978884
[0] Time of add_bias(ms): 14.502206118777394
[0] Time of 1 dist conv forward(ms): 236.60166910849512
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 7, loss: 1.4645582437515259
[0] $$$$
[0] Time of prepare send data(ms): 10.893853148445487
[0] Time of prepare recv data(ms): 0.0003708992153406143
[0] Time of barrier (all to all)(ms): 0.29885396361351013
[0] Time of comm data (all to all)(ms): 18.406238174065948
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030864961445331573
[0] Time of comm_forward(ms): 33.84279320016503
[0] Time of local aggregate(ms): 903.9087498094887
[0] Time of async wait(ms): 4.948737099766731
[0] Time of remote aggregate(ms): 37.909581093117595
[0] Time of sum up message(ms): 0.0007718335837125778
[0] Time of 1 dist conv forward(inner)(ms): 980.6414979975671
[0] #########
[0] Time of propagate(inner)(ms) = 980.7665790431201
[0] **************
[0] Time of linear(ms): 54.99594006687403
[0] Time of propagate(ms): 980.7830948848277
[0] Time of add_bias(ms): 76.45489205606282
[0] Time of 1 dist conv forward(ms): 1112.2349828947335
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.4635
[0] Time of relu(ms): 53.6315
[0] Time of dropout(ms): 199.4370
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.918839136138558
[0] Time of prepare recv data(ms): 0.00046496279537677765
[0] Time of barrier (all to all)(ms): 0.27878093533217907
[0] Time of comm data (all to all)(ms): 18.124358961358666
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030521070584654808
[0] Time of comm_forward(ms): 33.58302195556462
[0] Time of local aggregate(ms): 902.296741027385
[0] Time of async wait(ms): 4.955993965268135
[0] Time of remote aggregate(ms): 37.67747897654772
[0] Time of sum up message(ms): 0.0007760245352983475
[0] Time of 1 dist conv forward(inner)(ms): 978.5445330198854
[0] #########
[0] Time of propagate(inner)(ms) = 978.67098194547
[0] **************
[0] Time of linear(ms): 101.67835908941925
[0] Time of propagate(ms): 978.6877899896353
[0] Time of add_bias(ms): 77.66693900339305
[0] Time of 1 dist conv forward(ms): 1158.0345530528575
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1161.2594
[0] Time of relu(ms): 52.8169
[0] Time of dropout(ms): 197.5627
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.486306941136718
[0] Time of prepare recv data(ms): 0.0004570465534925461
[0] Time of barrier (all to all)(ms): 0.28893514536321163
[0] Time of comm data (all to all)(ms): 13.126527890563011
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03160000778734684
[0] Time of comm_forward(ms): 16.676129074767232
[0] Time of local aggregate(ms): 170.60952493920922
[0] Time of async wait(ms): 1.0101478546857834
[0] Time of remote aggregate(ms): 7.492787204682827
[0] Time of sum up message(ms): 0.0010719522833824158
[0] Time of 1 dist conv forward(inner)(ms): 195.8212610334158
[0] #########
[0] Time of propagate(inner)(ms) = 195.93882490880787
[0] **************
[0] Time of linear(ms): 24.889420019462705
[0] Time of propagate(ms): 195.95410418696702
[0] Time of add_bias(ms): 14.060783898457885
[0] Time of 1 dist conv forward(ms): 234.90546992979944
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 8, loss: 1.3285739421844482
[0] $$$$
[0] Time of prepare send data(ms): 11.000505182892084
[0] Time of prepare recv data(ms): 0.00032782554626464844
[0] Time of barrier (all to all)(ms): 0.30238600447773933
[0] Time of comm data (all to all)(ms): 17.48453709296882
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032535986974835396
[0] Time of comm_forward(ms): 33.020757138729095
[0] Time of local aggregate(ms): 902.8883709106594
[0] Time of async wait(ms): 4.933177027851343
[0] Time of remote aggregate(ms): 37.9131599329412
[0] Time of sum up message(ms): 0.0008109491318464279
[0] Time of 1 dist conv forward(inner)(ms): 978.7888119462878
[0] #########
[0] Time of propagate(inner)(ms) = 978.9027848746628
[0] **************
[0] Time of linear(ms): 54.88816392607987
[0] Time of propagate(ms): 978.9201631210744
[0] elapsed time of allocating memory (spmm on forward): 0.000816
[1] elapsed time of allocating memory (spmm on forward): 0.001073
[1] elapsed time of no tile's kernel = 666.546ms
[1] elapsed time of no tile's spmm:666.604
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000936
[1] elapsed time of no tile's kernel = [1] 36.7237ms
[1] elapsed time of no tile's spmm:36.7896
[0] elapsed time of no tile's kernel = 846.329ms
[0] elapsed time of no tile's spmm:846.398
[0] elapsed time of allocating memory (spmm on forward): 0.001465
[0] elapsed time of no tile's kernel = 37.0581ms
[0] elapsed time of no tile's spmm:37.1337
[0] elapsed time of allocating memory (spmm on forward): 0.001591
[1] elapsed time of allocating memory (spmm on forward): 0.000987
[1] elapsed time of no tile's kernel = 127.721ms
[1] elapsed time of no tile's spmm:127.791
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001112
[1] elapsed time of no tile's kernel = [1] 7.14551ms
[1] elapsed time of no tile's spmm:7.20972
[0] elapsed time of no tile's kernel = 162.322ms
[0] elapsed time of no tile's spmm:162.379
[0] elapsed time of allocating memory (spmm on forward): 0.001292
[0] elapsed time of no tile's kernel = [0] 6.93956ms[0] 
[0] elapsed time of no tile's spmm:7.006
[1] elapsed time of allocating memory (spmm on forward): 0.001136
[1] elapsed time of no tile's kernel = 3.74484ms[1] 
[1] elapsed time of no tile's spmm:3.80117
[1] elapsed time of allocating memory (spmm on forward): 0.001243
[0] elapsed time of allocating memory (spmm on forward): 0.000968
[0] elapsed time of no tile's kernel = 3.83149ms
[0] elapsed time of no tile's spmm:3.88996
[0] elapsed time of allocating memory (spmm on forward): 0.000967
[1] elapsed time of no tile's kernel = 137.956ms
[1] elapsed time of no tile's spmm:138.014
[0] elapsed time of no tile's kernel = 161.535ms
[0] elapsed time of no tile's spmm:161.594
[1] elapsed time of allocating memory (spmm on forward): 0.001113
[1] elapsed time of no tile's kernel = [1] 19.9776ms
[1] elapsed time of no tile's spmm:20.041
[0] elapsed time of allocating memory (spmm on forward): 0.001231
[0] elapsed time of no tile's kernel = 21.5287ms
[0] elapsed time of no tile's spmm:21.5863
[1] elapsed time of allocating memory (spmm on forward): 0.001333
[0] elapsed time of allocating memory (spmm on forward): 0.001147
[1] elapsed time of no tile's kernel = 699.601ms
[1] elapsed time of no tile's spmm:699.657
[0] elapsed time of no tile's kernel = 850.258ms
[0] elapsed time of no tile's spmm:850.328
[1] elapsed time of allocating memory (spmm on forward): 0.001507
[1] elapsed time of no tile's kernel = 20.1291ms
[1] elapsed time of no tile's spmm:[1] 20.1853
[1] elapsed time of allocating memory (spmm on forward): 0.001247
[0] elapsed time of allocating memory (spmm on forward): 0.001248
[0] elapsed time of no tile's kernel = 21.4667ms
[0] elapsed time of no tile's spmm:21.5262
[0] elapsed time of allocating memory (spmm on forward): 0.00111
[1] elapsed time of no tile's kernel = 770.443ms
[1] elapsed time of no tile's spmm:770.503
[0] elapsed time of no tile's kernel = 850.074ms
[0] elapsed time of no tile's spmm:850.145
[1] elapsed time of allocating memory (spmm on forward): 0.000958
[0] elapsed time of allocating memory (spmm on forward): 0.001391
[1] elapsed time of no tile's kernel = 675.863ms
[1] elapsed time of no tile's spmm:675.925
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000943
[1] elapsed time of no tile's kernel = [1] 36.9737ms
[1] elapsed time of no tile's spmm:37.04
[0] elapsed time of no tile's kernel = 851.756ms
[0] elapsed time of no tile's spmm:851.811
[0] elapsed time of allocating memory (spmm on forward): 0.00159
[0] elapsed time of no tile's kernel = 37.2914ms
[0] elapsed time of no tile's spmm:37.3644
[1] elapsed time of allocating memory (spmm on forward): 0.00141
[0] elapsed time of allocating memory (spmm on forward): 0.001594
[1] elapsed time of no tile's kernel = 670.537ms
[1] elapsed time of no tile's spmm:670.618
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001329
[1] elapsed time of no tile's kernel = [1] 36.8673ms
[1] elapsed time of no tile's spmm:36.9388
[0] elapsed time of no tile's kernel = 847.716ms
[0] elapsed time of no tile's spmm:847.779
[0] elapsed time of allocating memory (spmm on forward): 0.001923
[0] elapsed time of no tile's kernel = 37.297ms
[0] elapsed time of no tile's spmm:37.3767
[0] elapsed time of allocating memory (spmm on forward): 0.001352
[1] elapsed time of allocating memory (spmm on forward): 0.00101
[1] elapsed time of no tile's kernel = 127.383ms
[1] elapsed time of no tile's spmm:127.442
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001067
[1] elapsed time of no tile's kernel = [1] 7.10132ms
[1] elapsed time of no tile's spmm:7.15561
[0] elapsed time of no tile's kernel = 161.307ms
[0] elapsed time of no tile's spmm:161.369
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001221
[0] elapsed time of no tile's kernel = [0] 6.96963ms
[0] elapsed time of no tile's spmm:7.04658
[1] elapsed time of allocating memory (spmm on forward): 0.001298
[1] elapsed time of no tile's kernel = [1] 3.79306ms
[1] elapsed time of no tile's spmm:3.85108
[0] elapsed time of allocating memory (spmm on forward): 0.00119
[1] elapsed time of allocating memory (spmm on forward): 0.001182
[0] elapsed time of no tile's kernel = 3.80564ms
[0] elapsed time of no tile's spmm:3.86149
[0] elapsed time of allocating memory (spmm on forward): 0.001097[0] 
[1] elapsed time of no tile's kernel = 137.92ms
[1] elapsed time of no tile's spmm:137.976
[0] elapsed time of no tile's kernel = 161.842ms
[0] elapsed time of no tile's spmm:161.9
[1] elapsed time of allocating memory (spmm on forward): 0.001431
[1] elapsed time of no tile's kernel = 20.0127ms[1] 
[1] elapsed time of no tile's spmm:20.0737
[0] elapsed time of allocating memory (spmm on forward): 0.001327
[0] elapsed time of no tile's kernel = 21.6259ms
[0] elapsed time of no tile's spmm:21.6844
[1] elapsed time of allocating memory (spmm on forward): 0.001181
[0] elapsed time of allocating memory (spmm on forward): 0.001472
[1] elapsed time of no tile's kernel = 699.093ms
[1] elapsed time of no tile's spmm:699.153
[0] elapsed time of no tile's kernel = 849.289ms
[0] elapsed time of no tile's spmm:849.351
[1] elapsed time of allocating memory (spmm on forward): 0.0011
[1] elapsed time of no tile's kernel = 20.0396ms
[1] elapsed time of no tile's spmm:20.0958
[1] elapsed time of allocating memory (spmm on forward): 0.001128
[0] elapsed time of allocating memory (spmm on forward): 0.0014
[0] elapsed time of no tile's kernel = 21.5725ms
[0] elapsed time of no tile's spmm:21.6299
[0] elapsed time of allocating memory (spmm on forward): 0.001124[0] 
[1] elapsed time of no tile's kernel = 768.343ms
[1] elapsed time of no tile's spmm:768.405
[0] elapsed time of no tile's kernel = 850.806ms
[0] elapsed time of no tile's spmm:850.868
[1] elapsed time of allocating memory (spmm on forward): 0.000961
[0] elapsed time of allocating memory (spmm on forward): 0.001106
[1] elapsed time of no tile's kernel = 664.562ms
[1] elapsed time of no tile's spmm:664.621
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001243
[1] elapsed time of no tile's kernel = 37.0054ms
[1] elapsed time of no tile's spmm:37.0759
[0] elapsed time of no tile's kernel = 847.53ms
[0] elapsed time of no tile's spmm:847.589
[0] elapsed time of allocating memory (spmm on forward): 0.001466
[0] elapsed time of no tile's kernel = 37.3277ms
[0] elapsed time of no tile's spmm:37.3993
[1] elapsed time of allocating memory (spmm on forward): 0.001145
[0] elapsed time of allocating memory (spmm on forward): 0.000925[0] 
[1] elapsed time of no tile's kernel = 669.761ms
[1] elapsed time of no tile's spmm:669.858
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001025
[1] elapsed time of no tile's kernel = 37.0167ms
[1] elapsed time of no tile's spmm:37.0928
[0] elapsed time of no tile's kernel = 846.062ms
[0] elapsed time of no tile's spmm:846.129
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001315
[0] elapsed time of no tile's kernel = [0] 37.2955ms
[0] elapsed time of no tile's spmm:37.3787
[0] Time of add_bias(ms): 76.24761783517897
[0] Time of 1 dist conv forward(ms): 1110.057134879753
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1113.2947
[0] Time of relu(ms): 53.2728
[0] Time of dropout(ms): 200.6127
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.901788948103786
[0] Time of prepare recv data(ms): 0.0003189779818058014
[0] Time of barrier (all to all)(ms): 0.26787910610437393
[0] Time of comm data (all to all)(ms): 18.29908392392099
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03071501851081848
[0] Time of comm_forward(ms): 33.66927104070783
[0] Time of local aggregate(ms): 901.7527119722217
[0] Time of async wait(ms): 4.967937944456935
[0] Time of remote aggregate(ms): 37.59226202964783
[0] Time of sum up message(ms): 0.0008419156074523926
[0] Time of 1 dist conv forward(inner)(ms): 978.0137399211526
[0] #########
[0] Time of propagate(inner)(ms) = 978.1288581434637
[0] **************
[0] Time of linear(ms): 101.01833590306342
[0] Time of propagate(ms): 978.1455609481782
[0] Time of add_bias(ms): 75.88755805045366
[0] Time of 1 dist conv forward(ms): 1155.0527790095657
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1158.3088
[0] Time of relu(ms): 52.8155
[0] Time of dropout(ms): 199.2794
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.513535087928176
[0] Time of prepare recv data(ms): 0.00040302984416484833
[0] Time of barrier (all to all)(ms): 0.2677890006452799
[0] Time of comm data (all to all)(ms): 13.688517967239022
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.0310470350086689
[0] Time of comm_forward(ms): 17.21381605602801
[0] Time of local aggregate(ms): 171.2936998810619
[0] Time of async wait(ms): 0.9906392078846693
[0] Time of remote aggregate(ms): 7.458083797246218
[0] Time of sum up message(ms): 0.0011080410331487656
[0] Time of 1 dist conv forward(inner)(ms): 196.98839401826262
[0] #########
[0] Time of propagate(inner)(ms) = 197.10537511855364
[0] **************
[0] Time of linear(ms): 25.014759972691536
[0] Time of propagate(ms): 197.12658296339214
[0] Time of add_bias(ms): 13.92439310438931
[0] Time of 1 dist conv forward(ms): 236.06692091561854
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 9, loss: 1.2075573205947876
[0] $$$$
[0] Time of prepare send data(ms): 10.993220144882798
[0] Time of prepare recv data(ms): 0.0006279442459344864
[0] Time of barrier (all to all)(ms): 0.2758619375526905
[0] Time of comm data (all to all)(ms): 18.095653038471937
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030834926292300224
[0] Time of comm_forward(ms): 33.611293183639646
[0] Time of local aggregate(ms): 907.6430569402874
[0] Time of async wait(ms): 4.983396967872977
[0] Time of remote aggregate(ms): 37.821504985913634
[0] Time of sum up message(ms): 0.0007639173418283463
[0] Time of 1 dist conv forward(inner)(ms): 984.0908509213477
[0] #########
[0] Time of propagate(inner)(ms) = 984.2052778694779
[0] **************
[0] Time of linear(ms): 55.049048038199544
[0] Time of propagate(ms): 984.2232000082731
[0] Time of add_bias(ms): 77.4247469380498
[0] Time of 1 dist conv forward(ms): 1116.6980490088463
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1119.8718
[0] Time of relu(ms): 52.8461
[0] Time of dropout(ms): 200.0033
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.83887997083366
[0] Time of prepare recv data(ms): 0.0003289896994829178
[0] Time of barrier (all to all)(ms): 0.2683699131011963
[0] Time of comm data (all to all)(ms): 17.731639090925455
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03007403574883938
[0] Time of comm_forward(ms): 33.095863880589604
[0] Time of local aggregate(ms): 903.2603700179607
[0] Time of async wait(ms): 4.971162183210254
[0] Time of remote aggregate(ms): 37.82440791837871
[0] Time of sum up message(ms): 0.0007760245352983475
[0] Time of 1 dist conv forward(inner)(ms): 979.1826540604234
[0] #########
[0] Time of propagate(inner)(ms) = 979.3109081219882
[0] **************
[0] Time of linear(ms): 100.77893594279885
[0] Time of propagate(ms): 979.3288800865412
[0] Time of add_bias(ms): 76.24251302331686
[0] Time of 1 dist conv forward(ms): 1156.3519390765578
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1159.5914
[0] Time of relu(ms): 52.8051
[0] Time of dropout(ms): 200.7444
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.477424219250679
[0] Time of prepare recv data(ms): 0.0006558839231729507
[0] Time of barrier (all to all)(ms): 0.28842012397944927
[0] Time of comm data (all to all)(ms): 13.966877944767475
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03247312270104885
[0] Time of comm_forward(ms): 17.49892602674663
[0] Time of local aggregate(ms): 170.04019487649202
[0] Time of async wait(ms): 0.9597300086170435
[0] Time of remote aggregate(ms): 7.509129121899605
[0] Time of sum up message(ms): 0.0010149087756872177
[0] Time of 1 dist conv forward(inner)(ms): 196.04146806523204
[0] #########
[0] Time of propagate(inner)(ms) = 196.1673500481993
[0] **************
[0] Time of linear(ms): 25.184419006109238
[0] Time of propagate(ms): 196.18602795526385
[0] Time of add_bias(ms): 14.050102094188333
[0] Time of 1 dist conv forward(ms): 235.42163404636085
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 10, loss: 1.1467736959457397
[0] $$$$
[0] Time of prepare send data(ms): 11.020687175914645
[0] Time of prepare recv data(ms): 0.00030081719160079956
[0] Time of barrier (all to all)(ms): 0.2977780532091856
[0] Time of comm data (all to all)(ms): 18.06924305856228
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02908078022301197
[0] Time of comm_forward(ms): 33.6148040369153
[0] Time of local aggregate(ms): 903.7347510457039
[0] Time of async wait(ms): 4.970486043021083
[0] Time of remote aggregate(ms): 37.8364899661392
[0] Time of sum up message(ms): 0.0007660128176212311
[0] Time of 1 dist conv forward(inner)(ms): 980.1863778848201
[0] #########
[0] Time of propagate(inner)(ms) = 980.2987789735198
[0] **************
[0] Time of linear(ms): 54.99147903174162
[0] Time of propagate(ms): 980.3156000562012
[0] Time of add_bias(ms): 76.86967100016773
[0] Time of 1 dist conv forward(ms): 1112.177771050483
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.3751
[0] Time of relu(ms): 52.8558
[0] Time of dropout(ms): 200.2634
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.926416143774986
[0] Time of prepare recv data(ms): 0.0008188653737306595
[0] Time of barrier (all to all)(ms): 0.2695110160857439
[0] Time of comm data (all to all)(ms): 17.770154168829322
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02909405156970024
[0] Time of comm_forward(ms): 33.182768849655986
[0] Time of local aggregate(ms): 901.4682220295072
[0] Time of async wait(ms): 4.963923944160342
[0] Time of remote aggregate(ms): 37.81678806990385
[0] Time of sum up message(ms): 0.0007071066647768021
[0] Time of 1 dist conv forward(inner)(ms): 977.4615040514618
[0] #########
[0] Time of propagate(inner)(ms) = 977.5742890778929
[0] **************
[0] Time of linear(ms): 100.88202310726047
[0] Time of propagate(ms): 977.5902219116688
[0] Time of add_bias(ms): 76.89891988411546
[0] Time of 1 dist conv forward(ms): 1155.3724268451333
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1158.6591
[0] Time of relu(ms): 52.6588
[0] Time of dropout(ms): 198.5802
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.44527799077332
[0] Time of prepare recv data(ms): 0.00030011869966983795
[0] Time of barrier (all to all)(ms): 0.29031699523329735
[0] elapsed time of allocating memory (spmm on forward): 0.001328
[1] Time of 1 dist conv forward(ms): 925.9179919026792
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.3384
[1] Time of relu(ms): 51.5487
[1] Time of dropout(ms): 197.0713
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.236135054379702
[1] Time of prepare recv data(ms): 0.0003080349415540695
[1] Time of barrier (all to all)(ms): 193.39115195907652
[1] Time of comm data (all to all)(ms): 17.465393990278244
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03449898213148117
[1] Time of comm_forward(ms): 223.6877551767975
[1] Time of local aggregate(ms): 724.3515509180725
[1] Time of async wait(ms): 5.840084049850702
[1] Time of remote aggregate(ms): 37.25716797634959
[1] Time of sum up message(ms): 0.0009818468242883682
[1] Time of 1 dist conv forward(inner)(ms): 991.172038950026
[1] #########
[1] Time of propagate(inner)(ms) = 991.2881690543145
[1] **************
[1] Time of linear(ms): 99.31125305593014
[1] Time of propagate(ms): 991.3051538169384
[1] Time of add_bias(ms): 74.98245709575713
[1] Time of 1 dist conv forward(ms): 1165.6003310345113
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1168.8452
[1] Time of relu(ms): 51.0698
[1] Time of dropout(ms): 195.3622
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1333969198167324
[1] Time of prepare recv data(ms): 0.00037904828786849976
[1] Time of barrier (all to all)(ms): 184.57307992503047
[1] Time of comm data (all to all)(ms): 13.833825942128897
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.04119798541069031
[1] Time of comm_forward(ms): 201.39300683513284
[1] Time of local aggregate(ms): 136.50030409917235
[1] Time of async wait(ms): 1.1994140222668648
[1] Time of remote aggregate(ms): 7.679346017539501
[1] Time of sum up message(ms): 0.0009720679372549057
[1] Time of 1 dist conv forward(inner)(ms): 346.8142410274595
[1] #########
[1] Time of propagate(inner)(ms) = 346.9231810886413
[1] **************
[1] Time of linear(ms): 25.314962957054377
[1] Time of propagate(ms): 346.9390559475869
[1] Time of add_bias(ms): 15.87244519032538
[1] Time of 1 dist conv forward(ms): 388.1284832023084
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 9, loss: 0.4254818856716156
[1] $$$$
[1] Time of prepare send data(ms): 9.387692902237177
[1] Time of prepare recv data(ms): 0.00045099295675754547
[1] Time of barrier (all to all)(ms): 3.489605151116848
[1] Time of comm data (all to all)(ms): 17.250725999474525
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03546592779457569
[1] Time of comm_forward(ms): 33.98042405024171
[1] Time of local aggregate(ms): 729.0466309059411
[1] Time of async wait(ms): 5.791761912405491
[1] Time of remote aggregate(ms): 37.51207212917507
[1] Time of sum up message(ms): 0.0008819624781608582
[1] Time of 1 dist conv forward(inner)(ms): 806.3672368880361
[1] #########
[1] Time of propagate(inner)(ms) = 806.484191911295
[1] **************
[1] Time of linear(ms): 53.8564370945096
[1] Time of propagate(ms): 806.5025059040636
[1] Time of add_bias(ms): 74.81323508545756
[1] Time of 1 dist conv forward(ms): 935.1736989337951
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 938.5145
[1] Time of relu(ms): 50.3576
[1] Time of dropout(ms): 196.1385
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.21488692983985
[1] Time of prepare recv data(ms): 0.00022910535335540771
[1] Time of barrier (all to all)(ms): 191.93467497825623
[1] Time of comm data (all to all)(ms): 16.904307063668966
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.034703174605965614
[1] Time of comm_forward(ms): 221.64305089972913
[1] Time of local aggregate(ms): 725.2059921156615
[1] Time of async wait(ms): 5.84952300414443
[1] Time of remote aggregate(ms): 37.40235394798219
[1] Time of sum up message(ms): 0.0011539086699485779
[1] Time of 1 dist conv forward(inner)(ms): 990.1367770507932
[1] #########
[1] Time of propagate(inner)(ms) = 990.2522179763764
[1] **************
[1] Time of linear(ms): 99.12489098496735
[1] Time of propagate(ms): 990.2689408045262
[1] Time of add_bias(ms): 74.09423799254
[1] Time of 1 dist conv forward(ms): 1163.4906048420817
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1166.6694
[1] Time of relu(ms): 51.1931
[1] Time of dropout(ms): 195.6909
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.190252998843789
[1] Time of prepare recv data(ms): 0.0009040813893079758
[1] Time of barrier (all to all)(ms): 188.61723598092794
[1] Time of comm data (all to all)(ms): 13.119927141815424
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029223039746284485
[1] Time of comm_forward(ms): 204.6425340231508
[1] Time of local aggregate(ms): 136.7896730080247
[1] Time of async wait(ms): 1.2155999429523945
[1] Time of remote aggregate(ms): 7.567268097773194
[1] Time of sum up message(ms): 0.0009890645742416382
[1] Time of 1 dist conv forward(inner)(ms): 350.2452871762216
[1] #########
[1] Time of propagate(inner)(ms) = 350.36158794537187
[1] **************
[1] Time of linear(ms): 24.523474043235183
[1] Time of propagate(ms): 350.37640598602593
[1] Time of add_bias(ms): 15.773936873301864
[1] Time of 1 dist conv forward(ms): 390.67531283944845
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 10, loss: 0.3948081135749817
[1] $$$$
[1] Time of prepare send data(ms): 9.3786281067878
[1] Time of prepare recv data(ms): 0.00089290551841259
[1] Time of barrier (all to all)(ms): 3.7169731222093105
[1] Time of comm data (all to all)(ms): 17.244465881958604
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03461819142103195
[1] Time of comm_forward(ms): 33.94616092555225
[1] Time of local aggregate(ms): 719.6064149029553
[1] Time of async wait(ms): 5.867270054295659
[1] Time of remote aggregate(ms): 37.53134491853416
[1] Time of sum up message(ms): 0.000775093212723732
[1] Time of 1 dist conv forward(inner)(ms): 796.9865840859711
[1] #########
[1] Time of propagate(inner)(ms) = 797.12428082712
[1] **************
[1] Time of linear(ms): 53.838469088077545
[1] Time of propagate(ms): 797.1417498774827
[1] Time of add_bias(ms): 74.92298702709377
[1] Time of 1 dist conv forward(ms): 925.904881907627
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.2692
[1] Time of relu(ms): 51.6709
[1] Time of dropout(ms): 196.1015
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.351023007184267
[1] Time of prepare recv data(ms): 0.00025494955480098724
[1] Time of barrier (all to all)(ms): 195.2618460636586
[1] Time of comm data (all to all)(ms): 16.923728864639997
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03163982182741165
[1] Time of comm_forward(ms): 225.21931515075266
[1] Time of local aggregate(ms): 724.6085999067873
[1] Time of async wait(ms): 5.8490249793976545
[1] Time of remote aggregate(ms): 37.55322494544089
[1] Time of sum up message(ms): 0.0009101349860429764
[1] Time of 1 dist conv forward(inner)(ms): 993.2627149391919
[1] #########
[1] Time of propagate(inner)(ms) = 993.3896479196846
[1] **************
[1] Time of linear(ms): 99.49611802585423
[1] Time of propagate(ms): 993.4071570169181
[1] Time of add_bias(ms): 75.3965808544308
[1] Time of 1 dist conv forward(ms): 1168.3013779111207
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1171.4459
[1] Time of relu(ms): 50.5660
[1] Time of dropout(ms): 195.1019
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1802091505378485
[1] Time of prepare recv data(ms): 0.0007369089871644974
[1] Time of barrier (all to all)(ms): 184.49644092470407
[1] Time of comm data (all to all)(ms): 13.93711008131504
[1] $$$$
[1] elapsed time of allocating memory (spmm on forward): 0.000896
[1] elapsed time of no tile's kernel = 127.282ms
[1] elapsed time of no tile's spmm:127.345
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000847
[1] elapsed time of no tile's kernel = [1] 7.2182ms
[1] elapsed time of no tile's spmm:7.28169
[0] elapsed time of no tile's kernel = 162.098ms
[0] elapsed time of no tile's spmm:[0] 162.157
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001311
[0] elapsed time of no tile's kernel = [0] 6.97456ms
[0] elapsed time of no tile's spmm:7.04481
[1] elapsed time of allocating memory (spmm on forward): 0.001304
[1] elapsed time of no tile's kernel = 3.76503[1] ms
[1] elapsed time of no tile's spmm:3.81917
[1] elapsed time of allocating memory (spmm on forward): 0.001284
[0] elapsed time of allocating memory (spmm on forward): 0.000813
[0] elapsed time of no tile's kernel = 3.83734ms
[0] elapsed time of no tile's spmm:3.89254
[0] elapsed time of allocating memory (spmm on forward): 0.000915
[1] elapsed time of no tile's kernel = 137.796ms
[1] elapsed time of no tile's spmm:137.866
[0] elapsed time of no tile's kernel = 161.52ms
[0] elapsed time of no tile's spmm:161.576
[1] elapsed time of allocating memory (spmm on forward): 0.001479
[1] elapsed time of no tile's kernel = 20.072ms[1] 
[1] elapsed time of no tile's spmm:20.1384
[0] elapsed time of allocating memory (spmm on forward): 0.001086
[0] elapsed time of no tile's kernel = 21.6535ms
[0] elapsed time of no tile's spmm:21.7214[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001474
[0] elapsed time of allocating memory (spmm on forward): 0.001307
[1] elapsed time of no tile's kernel = 700.415ms
[1] elapsed time of no tile's spmm:700.473
[0] elapsed time of no tile's kernel = 851.842ms
[0] elapsed time of no tile's spmm:851.906
[1] elapsed time of allocating memory (spmm on forward): 0.001294
[1] elapsed time of no tile's kernel = 20.001ms[1] 
[1] elapsed time of no tile's spmm:20.0617
[1] elapsed time of allocating memory (spmm on forward): 0.001299
[0] elapsed time of allocating memory (spmm on forward): 0.001206
[0] elapsed time of no tile's kernel = 21.3755ms
[0] elapsed time of no tile's spmm:21.4362
[0] elapsed time of allocating memory (spmm on forward): 0.001278
[1] elapsed time of no tile's kernel = 772.862ms
[1] elapsed time of no tile's spmm:772.924
[0] elapsed time of no tile's kernel = 851.083ms
[0] elapsed time of no tile's spmm:851.143
[1] elapsed time of allocating memory (spmm on forward): 0.000996
[0] elapsed time of allocating memory (spmm on forward): 0.001082
[1] elapsed time of no tile's kernel = 664.881ms
[1] elapsed time of no tile's spmm:664.941
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000873
[1] elapsed time of no tile's kernel = [1] 36.9727ms
[1] elapsed time of no tile's spmm:37.0394
[0] elapsed time of no tile's kernel = 848.009ms
[0] elapsed time of no tile's spmm:848.085
[0] elapsed time of allocating memory (spmm on forward): 0.00183
[0] elapsed time of no tile's kernel = [0] 37.4938ms
[0] elapsed time of no tile's spmm:37.567
[1] elapsed time of allocating memory (spmm on forward): 0.001022
[0] elapsed time of allocating memory (spmm on forward): 0.000893
[1] elapsed time of no tile's kernel = 670.31ms
[1] elapsed time of no tile's spmm:670.397
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001351
[1] elapsed time of no tile's kernel = [1] 36.81ms
[1] elapsed time of no tile's spmm:36.8803
[0] elapsed time of no tile's kernel = 845.147ms
[0] elapsed time of no tile's spmm:845.206
[0] elapsed time of allocating memory (spmm on forward): 0.001668
[0] elapsed time of no tile's kernel = 36.9675ms
[0] elapsed time of no tile's spmm:37.0416
[0] elapsed time of allocating memory (spmm on forward): 0.001438[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001028
[1] elapsed time of no tile's kernel = 127.398ms
[1] elapsed time of no tile's spmm:127.454
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001031
[1] elapsed time of no tile's kernel = [1] 7.1662ms
[1] elapsed time of no tile's spmm:7.22963
[0] elapsed time of no tile's kernel = 161.152ms
[0] elapsed time of no tile's spmm:161.213
[0] elapsed time of allocating memory (spmm on forward): 0.000952
[0] elapsed time of no tile's kernel = [0] 6.93594ms
[0] elapsed time of no tile's spmm:7.003
[1] elapsed time of allocating memory (spmm on forward): 0.001138
[1] elapsed time of no tile's kernel = [1] 3.75269ms
[1] elapsed time of no tile's spmm:3.81481
[0] elapsed time of allocating memory (spmm on forward): 0.001491
[1] elapsed time of allocating memory (spmm on forward): 0.001291
[0] elapsed time of no tile's kernel = 3.86395ms
[0] elapsed time of no tile's spmm:3.91938[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.001066
[1] elapsed time of no tile's kernel = 139.834ms
[1] elapsed time of no tile's spmm:139.892
[0] elapsed time of no tile's kernel = 162.469ms
[0] elapsed time of no tile's spmm:162.529
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000982
[1] elapsed time of no tile's kernel = [1] 20.0667ms
[1] elapsed time of no tile's spmm:20.1431
[0] elapsed time of allocating memory (spmm on forward): 0.001488
[0] elapsed time of no tile's kernel = 21.517ms
[0] elapsed time of no tile's spmm:21.5762[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.00117
[0] elapsed time of allocating memory (spmm on forward): 0.001076
[1] elapsed time of no tile's kernel = 699.088ms
[1] elapsed time of no tile's spmm:699.149
[0] elapsed time of no tile's kernel = 858.471ms
[0] elapsed time of no tile's spmm:858.534
[1] elapsed time of allocating memory (spmm on forward): 0.001519
[1] elapsed time of no tile's kernel = 19.9853ms
[1] elapsed time of no tile's spmm:20.0435
[1] elapsed time of allocating memory (spmm on forward): 0.001851
[0] elapsed time of allocating memory (spmm on forward): 0.001278
[0] elapsed time of no tile's kernel = 21.4739ms
[0] elapsed time of no tile's spmm:21.5353[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.001021
[1] elapsed time of no tile's kernel = 773.799ms
[1] elapsed time of no tile's spmm:773.858
[0] elapsed time of no tile's kernel = 850.71ms
[0] elapsed time of no tile's spmm:850.77
[1] elapsed time of allocating memory (spmm on forward): 0.001265
[0] elapsed time of allocating memory (spmm on forward): 0.000851
[1] elapsed time of no tile's kernel = 664.228ms
[1] elapsed time of no tile's spmm:664.304
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000984
[1] elapsed time of no tile's kernel = 36.9009ms
[1] elapsed time of no tile's spmm:36.9684
[0] elapsed time of no tile's kernel = 848.001ms
[0] elapsed time of no tile's spmm:848.064
[0] elapsed time of allocating memory (spmm on forward): 0.00192[0] 
[0] elapsed time of no tile's kernel = [0] 37.5126ms
[0] elapsed time of no tile's spmm:37.5876
[0] elapsed time of allocating memory (spmm on forward): 0.001522
[1] elapsed time of allocating memory (spmm on forward): 0.00114
[1] elapsed time of no tile's kernel = 658.377ms
[1] elapsed time of no tile's spmm:658.437
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001057
[1] elapsed time of no tile's kernel = 36.695ms
[1] elapsed time of no tile's spmm:36.7644
[0] elapsed time of no tile's kernel = 846.862ms
[0] elapsed time of no tile's spmm:846.928
[0] elapsed time of allocating memory (spmm on forward): 0.001825
[0] elapsed time of no tile's kernel = 37.0856[0] ms
[0] elapsed time of no tile's spmm:37.1613
[0] elapsed time of allocating memory (spmm on forward): 0.001053[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001176
[1] elapsed time of no tile's kernel = 127.536ms
[1] elapsed time of no tile's spmm:127.591
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001029
[1] elapsed time of no tile's kernel = [1] 7.16597ms
[1] elapsed time of no tile's spmm:7.23124
[0] elapsed time of no tile's kernel = 161.45ms
[0] elapsed time of no tile's spmm:161.509
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001163
[0] elapsed time of no tile's kernel = 6.9339ms
[0] elapsed time of no tile's spmm:7.00051
[1] elapsed time of allocating memory (spmm on forward): 0.001157
[1] elapsed time of no tile's kernel = 3.86696ms
[1] elapsed time of no tile's spmm:3.91831
[1] elapsed time of allocating memory (spmm on forward): 0.001463
[0] elapsed time of allocating memory (spmm on forward): 0.001137
[0] elapsed time of no tile's kernel = 3.85867ms
[0] elapsed time of no tile's spmm:3.91123
[0] elapsed time of allocating memory (spmm on forward): 0.001073
[1] elapsed time of no tile's kernel = 141.769ms
[1] elapsed time of no tile's spmm:141.823
[0] elapsed time of no tile's kernel = 161.159ms
[0] elapsed time of no tile's spmm:161.213
[1] elapsed time of allocating memory (spmm on forward): 0.000968
[1] elapsed time of no tile's kernel = [1] 20.1347ms
[1] elapsed time of no tile's spmm:20.2023
[0] elapsed time of allocating memory (spmm on forward): 0.001134
[0] elapsed time of no tile's kernel = 21.3936ms
[0] elapsed time of no tile's spmm:21.4542
[1] elapsed time of allocating memory (spmm on forward): 0.000974
[0] elapsed time of allocating memory (spmm on forward): 0.001104
[1] elapsed time of no tile's kernel = 697.402ms
[1] elapsed time of no tile's spmm:697.464
[0] elapsed time of no tile's kernel = 849.93ms
[0] elapsed time of no tile's spmm:849.995
[1] elapsed time of allocating memory (spmm on forward): 0.000992
[1] elapsed time of no tile's kernel = [1] 20.327ms
[1] elapsed time of no tile's spmm:20.3942
[1] elapsed time of allocating memory (spmm on forward): 0.001459
[0] elapsed time of allocating memory (spmm on forward): 0.001202
[0] elapsed time of no tile's kernel = 21.4415ms
[0] elapsed time of no tile's spmm:21.4991
[0] elapsed time of allocating memory (spmm on forward): 0.001063
[1] elapsed time of no tile's kernel = 771.611ms
[1] elapsed time of no tile's spmm:771.673
[0] elapsed time of no tile's kernel = 851.564ms
[0] elapsed time of no tile's spmm:851.631
[1] elapsed time of allocating memory (spmm on forward): 0.000921
[0] elapsed time of allocating memory (spmm on forward): 0.001218
[1] elapsed time of no tile's kernel = 664.568ms
[1] elapsed time of no tile's spmm:664.63
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001258
[1] elapsed time of no tile's kernel = 36.8137ms
[1] elapsed time of no tile's spmm:36.8828
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03212597221136093
[1] Time of comm_forward(ms): 201.44582190550864
[1] Time of local aggregate(ms): 134.81855602003634
[1] Time of async wait(ms): 1.2073330581188202
[1] Time of remote aggregate(ms): 7.746828952804208
[1] Time of sum up message(ms): 0.000850064679980278
[1] Time of 1 dist conv forward(inner)(ms): 345.25151597335935
[1] #########
[1] Time of propagate(inner)(ms) = 345.36104602739215
[1] **************
[1] Time of linear(ms): 25.085901841521263
[1] Time of propagate(ms): 345.37812508642673
[1] Time of add_bias(ms): 15.878261998295784
[1] Time of 1 dist conv forward(ms): 386.3437050022185
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 11, loss: 0.3787159025669098
[1] $$$$
[1] Time of prepare send data(ms): 9.336143964901567
[1] Time of prepare recv data(ms): 0.0009629875421524048
[1] Time of barrier (all to all)(ms): 3.6670041736215353
[1] Time of comm data (all to all)(ms): 16.920222900807858
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03292388282716274
[1] Time of comm_forward(ms): 33.57178205624223
[1] Time of local aggregate(ms): 719.8097580112517
[1] Time of async wait(ms): 5.841901991516352
[1] Time of remote aggregate(ms): 37.49265591613948
[1] Time of sum up message(ms): 0.0009620562195777893
[1] Time of 1 dist conv forward(inner)(ms): 796.7499839141965
[1] #########
[1] Time of propagate(inner)(ms) = 796.86080198735
[1] **************
[1] Time of linear(ms): 53.76064404845238
[1] Time of propagate(ms): 796.8791020102799
[1] Time of add_bias(ms): 75.64390986226499
[1] Time of 1 dist conv forward(ms): 926.2854838743806
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.5501
[1] Time of relu(ms): 50.9547
[1] Time of dropout(ms): 195.3063
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.25964000634849
[1] Time of prepare recv data(ms): 0.00047101639211177826
[1] Time of barrier (all to all)(ms): 197.64485117048025
[1] Time of comm data (all to all)(ms): 16.63366984575987
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03178720362484455
[1] Time of comm_forward(ms): 227.22890181466937
[1] Time of local aggregate(ms): 724.4497870560735
[1] Time of async wait(ms): 5.844047060236335
[1] Time of remote aggregate(ms): 37.349015939980745
[1] Time of sum up message(ms): 0.001142965629696846
[1] Time of 1 dist conv forward(inner)(ms): 994.9046820402145
[1] #########
[1] Time of propagate(inner)(ms) = 995.0200121384114
[1] **************
[1] Time of linear(ms): 99.25381490029395
[1] Time of propagate(ms): 995.0373528990895
[1] Time of add_bias(ms): 74.07908421009779
[1] Time of 1 dist conv forward(ms): 1168.3717421256006
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1171.5622
[1] Time of relu(ms): 51.4238
[1] Time of dropout(ms): 195.8000
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.2491291165351868
[1] Time of prepare recv data(ms): 0.0006100162863731384
[1] Time of barrier (all to all)(ms): 185.07400201633573
[1] Time of comm data (all to all)(ms): 14.040113892406225
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03121304325759411
[1] Time of comm_forward(ms): 202.08827988244593
[1] Time of local aggregate(ms): 134.67732607387006
[1] Time of async wait(ms): 1.2107461225241423
[1] Time of remote aggregate(ms): 7.674936903640628
[1] Time of sum up message(ms): 0.0007990747690200806
[1] Time of 1 dist conv forward(inner)(ms): 345.6833011005074
[1] #########
[1] Time of propagate(inner)(ms) = 345.8051299676299
[1] **************
[1] Time of linear(ms): 24.54355708323419
[1] Time of propagate(ms): 345.82458110526204
[1] Time of add_bias(ms): 16.046784818172455
[1] Time of 1 dist conv forward(ms): 386.41656399704516
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 12, loss: 0.36317285895347595
[1] $$$$
[1] Time of prepare send data(ms): 9.35204210691154
[1] Time of prepare recv data(ms): 0.0006188638508319855
[1] Time of barrier (all to all)(ms): 3.811523085460067
[1] Time of comm data (all to all)(ms): 17.340386984869838
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.032739946618676186
[1] Time of comm_forward(ms): 34.10920198075473
[1] Time of local aggregate(ms): 719.1123019438237
[1] Time of async wait(ms): 5.813264986500144
[1] Time of remote aggregate(ms): 37.42899117060006
[1] Time of sum up message(ms): 0.0007778871804475784
[1] Time of 1 dist conv forward(inner)(ms): 796.4972779154778
[1] #########
[1] Time of propagate(inner)(ms) = 796.6203461401165
[1] **************
[1] Time of linear(ms): 53.829604061320424
[1] Time of propagate(ms): 796.6394620016217
[1] Time of add_bias(ms): 74.00550087913871
[1] Time of 1 dist conv forward(ms): 924.4826559443027
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 927.8007
[1] Time of relu(ms): 51.2185
[1] Time of dropout(ms): 195.1977
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.285612031817436
[1] Time of prepare recv data(ms): 0.00030105002224445343
[1] Time of barrier (all to all)(ms): 199.3618388660252
[1] Time of comm data (all to all)(ms): 17.279948107898235
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.050588976591825485
[1] Time of comm_forward(ms): 229.63720094412565
[1] Time of local aggregate(ms): 724.8535919934511
[1] Time of async wait(ms): 5.835026036947966
[1] Time of remote aggregate(ms): 37.222318118438125
[1] Time of sum up message(ms): 0.0009420327842235565
[1] Time of 1 dist conv forward(inner)(ms): 997.5996681023389
[1] #########
[1] Time of propagate(inner)(ms) = 997.72172793746
[1] **************
[1] Time of linear(ms): 99.04054994694889
[1] Time of propagate(ms): 997.7392149157822
[1] Time of add_bias(ms): 74.22769605182111
[1] Time of 1 dist conv forward(ms): 1171.0088970139623
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1174.2032
[1] Time of relu(ms): 51.0126
[1] Time of dropout(ms): 195.4998
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1288548596203327
[1] Time of prepare recv data(ms): 0.0004440080374479294
[1] Time of barrier (all to all)(ms): 186.36842514388263
[1] Time of comm data (all to all)(ms): 13.238891959190369
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.031566014513373375
[1] Time of comm_forward(ms): 202.59577594697475
[1] Time of local aggregate(ms): 136.5210961084813
[1] Time of async wait(ms): 1.1852269526571035
[1] Time of remote aggregate(ms): 7.6834040228277445
[1] Time of sum up message(ms): 0.0008260831236839294
[1] Time of 1 dist conv forward(inner)(ms): 348.01789512857795
[1] #########
[1] Time of propagate(inner)(ms) = 348.12740981578827
[1] **************
[1] Time of linear(ms): 25.323074078187346
[1] Time of propagate(ms): 348.1434548739344
[1] Time of add_bias(ms): 15.946752158924937
[1] Time of 1 dist conv forward(ms): 389.41493816673756
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 13, loss: 0.35201355814933777
[1] $$$$
[1] Time of prepare send data(ms): 9.376386879011989
[1] Time of prepare recv data(ms): 0.0005010515451431274
[1] Time of barrier (all to all)(ms): 3.5980381071567535
[1] Time of comm data (all to all)(ms): 16.73932303674519
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03373716026544571
[1] Time of comm_forward(ms): 33.33238698542118
[1] Time of local aggregate(ms): 719.615604961291
[1] Time of async wait(ms): 5.8307580184191465
[1] Time of remote aggregate(ms): 37.323413882404566
[0] elapsed time of no tile's kernel = [0] 852.519ms
[0] elapsed time of no tile's spmm:852.585
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001428
[0] elapsed time of no tile's kernel = [0] 37.455ms
[0] elapsed time of no tile's spmm:37.5172
[0] Time of comm data (all to all)(ms): 13.785040937364101
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030786963179707527
[0] Time of comm_forward(ms): 17.326631117612123
[0] Time of local aggregate(ms): 169.69416802749038
[0] Time of async wait(ms): 1.0089629795402288
[0] Time of remote aggregate(ms): 7.511802949011326
[0] Time of sum up message(ms): 0.0007359776645898819
[0] Time of 1 dist conv forward(inner)(ms): 195.57308801449835
[0] #########
[0] Time of propagate(inner)(ms) = 195.68980112671852
[0] **************
[0] Time of linear(ms): 24.820373859256506
[0] Time of propagate(ms): 195.70591812953353
[0] Time of add_bias(ms): 13.904732884839177
[0] Time of 1 dist conv forward(ms): 234.43223303183913
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 11, loss: 1.10382080078125
[0] $$$$
[0] Time of prepare send data(ms): 10.96633286215365
[0] Time of prepare recv data(ms): 0.0003320164978504181
[0] Time of barrier (all to all)(ms): 0.2748060505837202
[0] Time of comm data (all to all)(ms): 17.759796930477023
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029272865504026413
[0] Time of comm_forward(ms): 33.26088096946478
[0] Time of local aggregate(ms): 904.1602341458201
[0] Time of async wait(ms): 4.922994878143072
[0] Time of remote aggregate(ms): 38.00916811451316
[0] Time of sum up message(ms): 0.0008498318493366241
[0] Time of 1 dist conv forward(inner)(ms): 980.3834008052945
[0] #########
[0] Time of propagate(inner)(ms) = 980.4999609477818
[0] **************
[0] Time of linear(ms): 55.03156501799822
[0] Time of propagate(ms): 980.5168439634144
[0] Time of add_bias(ms): 76.28305302932858
[0] Time of 1 dist conv forward(ms): 1111.8325900752097
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.0439
[0] Time of relu(ms): 52.8594
[0] Time of dropout(ms): 200.8645
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.806632926687598
[0] Time of prepare recv data(ms): 0.000367872416973114
[0] Time of barrier (all to all)(ms): 0.27285818941891193
[0] Time of comm data (all to all)(ms): 17.47225085273385
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02931593917310238
[0] Time of comm_forward(ms): 32.80770406126976
[0] Time of local aggregate(ms): 900.4852629732341
[0] Time of async wait(ms): 4.966761916875839
[0] Time of remote aggregate(ms): 37.48821606859565
[0] Time of sum up message(ms): 0.0010600779205560684
[0] Time of 1 dist conv forward(inner)(ms): 975.778321037069
[0] #########
[0] Time of propagate(inner)(ms) = 975.9001331403852
[0] **************
[0] Time of linear(ms): 101.66539601050317
[0] Time of propagate(ms): 975.917057832703
[0] Time of add_bias(ms): 76.71098201535642
[0] Time of 1 dist conv forward(ms): 1154.2947699781507
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1157.5580
[0] Time of relu(ms): 52.9453
[0] Time of dropout(ms): 199.5709
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4601060431450605
[0] Time of prepare recv data(ms): 0.00024889595806598663
[0] Time of barrier (all to all)(ms): 0.28518494218587875
[0] Time of comm data (all to all)(ms): 13.870791997760534
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03348616883158684
[0] Time of comm_forward(ms): 17.37619796767831
[0] Time of local aggregate(ms): 168.69110986590385
[0] Time of async wait(ms): 0.9343260899186134
[0] Time of remote aggregate(ms): 7.442655973136425
[0] Time of sum up message(ms): 0.0007390044629573822
[0] Time of 1 dist conv forward(inner)(ms): 194.47851506993175
[0] #########
[0] Time of propagate(inner)(ms) = 194.59705706685781
[0] **************
[0] Time of linear(ms): 24.963286938145757
[0] Time of propagate(ms): 194.61344298906624
[0] Time of add_bias(ms): 13.9637750107795
[0] Time of 1 dist conv forward(ms): 233.5417738649994
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 12, loss: 1.044744610786438
[0] $$$$
[0] Time of prepare send data(ms): 11.003456078469753
[0] Time of prepare recv data(ms): 0.0004628673195838928
[0] Time of barrier (all to all)(ms): 0.2976020332425833
[0] Time of comm data (all to all)(ms): 18.161939922720194
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029197894036769867
[0] Time of comm_forward(ms): 33.6986780166626
[0] Time of local aggregate(ms): 904.1522180195898
[0] Time of async wait(ms): 4.989594919607043
[0] Time of remote aggregate(ms): 38.037776947021484
[0] Time of sum up message(ms): 0.0006512273102998734
[0] Time of 1 dist conv forward(inner)(ms): 980.908117024228
[0] #########
[0] Time of propagate(inner)(ms) = 981.0203949455172
[0] **************
[0] Time of linear(ms): 55.1371721085161
[0] Time of propagate(ms): 981.0385429300368
[0] Time of add_bias(ms): 75.90883108787239
[0] Time of 1 dist conv forward(ms): 1112.0857149362564
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.3308
[0] Time of relu(ms): 53.1547
[0] Time of dropout(ms): 200.7686
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.960526065900922
[0] Time of prepare recv data(ms): 0.00035902485251426697
[0] Time of barrier (all to all)(ms): 0.272237928584218
[0] Time of comm data (all to all)(ms): 18.102958099916577
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030224910005927086
[0] Time of comm_forward(ms): 33.548213075846434
[0] Time of local aggregate(ms): 903.0488149728626
[0] Time of async wait(ms): 4.978306125849485
[0] Time of remote aggregate(ms): 37.611156003549695
[0] Time of sum up message(ms): 0.0007799826562404633
[0] Time of 1 dist conv forward(inner)(ms): 979.2174950707704
[0] #########
[0] Time of propagate(inner)(ms) = 979.3345220386982
[0] **************
[0] Time of linear(ms): 100.9841188788414
[0] Time of propagate(ms): 979.3518111109734
[0] Time of add_bias(ms): 76.3422790914774
[0] Time of 1 dist conv forward(ms): 1156.6795390099287
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1160.0061
[0] Time of relu(ms): 52.7792
[0] Time of dropout(ms): 199.1311
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4877351243048906
[0] Time of prepare recv data(ms): 0.0004959292709827423
[0] Time of barrier (all to all)(ms): 0.30207308009266853
[0] Time of comm data (all to all)(ms): 14.066588832065463
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032463110983371735
[0] Time of comm_forward(ms): 17.615001881495118
[0] Time of local aggregate(ms): 169.68746716156602
[0] Time of async wait(ms): 0.9462868329137564
[0] Time of remote aggregate(ms): 7.447407115250826
[0] Time of sum up message(ms): 0.0011189840734004974
[0] Time of 1 dist conv forward(inner)(ms): 195.7297450862825
[0] #########
[0] Time of propagate(inner)(ms) = 195.84636809304357
[0] **************
[0] Time of linear(ms): 24.94361298158765
[0] Time of propagate(ms): 195.86394308134913
[0] Time of add_bias(ms): 13.963881880044937
[0] Time of 1 dist conv forward(ms): 234.77253690361977
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 13, loss: 0.9899758100509644
[0] $$$$
[0] Time of prepare send data(ms): 10.96033793874085
[0] Time of prepare recv data(ms): 0.0003110617399215698
[0] Time of barrier (all to all)(ms): 0.26740203611552715
[0] Time of comm data (all to all)(ms): 17.561664106324315
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03240699879825115
[0] Time of comm_forward(ms): 33.03463198244572
[0] Time of local aggregate(ms): 908.8769420050085
[0] Time of async wait(ms): 4.941121907904744
[1] elapsed time of allocating memory (spmm on forward): 0.000952
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000827
[1] elapsed time of no tile's kernel = 658.444ms
[1] elapsed time of no tile's spmm:658.505
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000988
[1] elapsed time of no tile's kernel = [1] 36.9498ms
[1] elapsed time of no tile's spmm:37.0165
[0] elapsed time of no tile's kernel = [0] 849.71ms
[0] elapsed time of no tile's spmm:849.778
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001901
[0] elapsed time of no tile's kernel = [0] 37.3248ms
[0] elapsed time of no tile's spmm:37.3993
[0] elapsed time of allocating memory (spmm on forward): 0.001588[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001172
[1] elapsed time of no tile's kernel = 132.095ms
[1] elapsed time of no tile's spmm:132.176
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000773
[1] elapsed time of no tile's kernel = [1] 7.08143ms
[1] elapsed time of no tile's spmm:7.14916
[0] elapsed time of no tile's kernel = [0] 163.406ms
[0] elapsed time of no tile's spmm:163.473
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001146
[0] elapsed time of no tile's kernel = 7.02294ms
[0] elapsed time of no tile's spmm:[0] 7.08115
[1] elapsed time of allocating memory (spmm on forward): 0.000943
[1] elapsed time of no tile's kernel = 3.80158[1] ms
[1] elapsed time of no tile's spmm:3.85755
[0] elapsed time of allocating memory (spmm on forward): 0.001086
[1] elapsed time of allocating memory (spmm on forward): 0.001591
[0] elapsed time of no tile's kernel = 3.8475ms
[0] elapsed time of no tile's spmm:[0] 3.90422
[0] elapsed time of allocating memory (spmm on forward): 0.001311[0] 
[1] elapsed time of no tile's kernel = 142.186ms
[1] elapsed time of no tile's spmm:142.245
[0] elapsed time of no tile's kernel = 163.842ms
[0] elapsed time of no tile's spmm:163.913
[1] elapsed time of allocating memory (spmm on forward): 0.00106
[1] elapsed time of no tile's kernel = [1] 20.5891ms
[1] elapsed time of no tile's spmm:20.6512
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001504
[0] elapsed time of no tile's kernel = 22.0302ms
[0] elapsed time of no tile's spmm:22.0974
[1] elapsed time of allocating memory (spmm on forward): 0.001105
[0] elapsed time of allocating memory (spmm on forward): 0.001259
[1] elapsed time of no tile's kernel = 694.752ms
[1] elapsed time of no tile's spmm:694.808
[0] elapsed time of no tile's kernel = 859.435ms[0] 
[0] elapsed time of no tile's spmm:859.5
[1] elapsed time of allocating memory (spmm on forward): 0.001235
[1] elapsed time of no tile's kernel = 20.5703ms
[1] elapsed time of no tile's spmm:20.6265[1] 
[1] elapsed time of allocating memory (spmm on forward): 0.001448
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001187
[0] elapsed time of no tile's kernel = [0] 21.4958ms
[0] elapsed time of no tile's spmm:21.5561
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000875
[1] elapsed time of no tile's kernel = 772.434ms
[1] elapsed time of no tile's spmm:772.502
[0] elapsed time of no tile's kernel = 847.338ms
[0] elapsed time of no tile's spmm:847.406
[0] elapsed time of allocating memory (spmm on forward): 0.001032
[1] elapsed time of allocating memory (spmm on forward): 0.001142
[1] elapsed time of no tile's kernel = 665.078ms
[1] elapsed time of no tile's spmm:665.138
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001015
[1] elapsed time of no tile's kernel = 36.9554ms
[1] elapsed time of no tile's spmm:37.0218
[0] elapsed time of no tile's kernel = 848.157ms
[0] elapsed time of no tile's spmm:848.23
[0] elapsed time of allocating memory (spmm on forward): 0.001307
[0] elapsed time of no tile's kernel = 37.2094ms
[0] elapsed time of no tile's spmm:37.2818
[1] elapsed time of allocating memory (spmm on forward): 0.001161
[0] elapsed time of allocating memory (spmm on forward): 0.000858[0] 
[1] elapsed time of no tile's kernel = [1] 670.604ms
[1] elapsed time of no tile's spmm:670.683
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001086
[1] elapsed time of no tile's kernel = [1] 37.0054ms
[1] elapsed time of no tile's spmm:37.0744
[0] elapsed time of no tile's kernel = 846.418ms
[0] elapsed time of no tile's spmm:846.482
[0] elapsed time of allocating memory (spmm on forward): 0.001366
[0] elapsed time of no tile's kernel = [0] 37.3818ms
[0] elapsed time of no tile's spmm:37.4548
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000958
[1] elapsed time of allocating memory (spmm on forward): 0.000982
[1] elapsed time of no tile's kernel = 127.594ms
[1] elapsed time of no tile's spmm:127.665
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000939
[1] elapsed time of no tile's kernel = [1] 7.12989ms
[1] elapsed time of no tile's spmm:7.19764
[0] elapsed time of no tile's kernel = 162.117ms
[0] elapsed time of no tile's spmm:162.179
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001339
[0] elapsed time of no tile's kernel = 7.00408ms
[0] elapsed time of no tile's spmm:7.07073
[1] elapsed time of allocating memory (spmm on forward): 0.001162
[1] elapsed time of no tile's kernel = 3.85012ms[1] 
[1] elapsed time of no tile's spmm:3.90366
[1] elapsed time of allocating memory (spmm on forward): 0.001457
[0] elapsed time of allocating memory (spmm on forward): 0.00109
[0] elapsed time of no tile's kernel = 3.82992ms
[0] elapsed time of no tile's spmm:3.8867
[0] elapsed time of allocating memory (spmm on forward): 0.001229[0] 
[1] elapsed time of no tile's kernel = 143.048ms
[1] elapsed time of no tile's spmm:143.104
[0] elapsed time of no tile's kernel = 161.808[0] ms
[0] elapsed time of no tile's spmm:161.876
[1] elapsed time of allocating memory (spmm on forward): 0.001398
[1] elapsed time of no tile's kernel = [1] 20.1219ms
[1] elapsed time of no tile's spmm:20.1958
[0] elapsed time of allocating memory (spmm on forward): 0.001254
[0] elapsed time of no tile's kernel = 21.4931ms
[0] elapsed time of no tile's spmm:21.5519
[1] elapsed time of allocating memory (spmm on forward): 0.001331
[0] elapsed time of allocating memory (spmm on forward): 0.00114
[1] elapsed time of no tile's kernel = 687.304ms
[1] elapsed time of no tile's spmm:687.374
[0] elapsed time of no tile's kernel = 847.771ms
[0] elapsed time of no tile's spmm:847.839
[1] elapsed time of allocating memory (spmm on forward): 0.001428
[1] elapsed time of no tile's kernel = 19.9005ms
[1] elapsed time of no tile's spmm:[1] 19.9703
[1] elapsed time of allocating memory (spmm on forward): 0.001496
[0] elapsed time of allocating memory (spmm on forward): 0.001141
[0] elapsed time of no tile's kernel = 21.4424ms
[0] elapsed time of no tile's spmm:21.5041
[0] elapsed time of allocating memory (spmm on forward): 0.001304
[1] elapsed time of no tile's kernel = 770.507ms
[1] elapsed time of no tile's spmm:770.568
[0] elapsed time of no tile's kernel = 851.347ms
[0] elapsed time of no tile's spmm:851.414
[1] elapsed time of allocating memory (spmm on forward): 0.001374
[0] elapsed time of allocating memory (spmm on forward): 0.000907
[1] elapsed time of no tile's kernel = 665.368ms
[1] elapsed time of no tile's spmm:665.445
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001166
[1] elapsed time of no tile's kernel = 37.0995ms
[1] elapsed time of no tile's spmm:37.1717
[0] elapsed time of no tile's kernel = 849.388ms
[0] elapsed time of no tile's spmm:849.457
[0] elapsed time of allocating memory (spmm on forward): 0.002078
[0] elapsed time of no tile's kernel = 37.3205ms
[0] elapsed time of no tile's spmm:37.3966
[1] elapsed time of allocating memory (spmm on forward): 0.001371
[0] elapsed time of allocating memory (spmm on forward): 0.001063
[1] elapsed time of no tile's kernel = 669.562ms
[1] elapsed time of no tile's spmm:669.646
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001012
[1] elapsed time of no tile's kernel = [1] 36.7595ms
[1] elapsed time of no tile's spmm:36.8285
[0] elapsed time of no tile's kernel = 847.956ms
[0] elapsed time of no tile's spmm:848.026
[0] elapsed time of allocating memory (spmm on forward): 0.001411
[0] elapsed time of no tile's kernel = [0] 37.265ms
[0] elapsed time of no tile's spmm:37.3394
[1] Time of sum up message(ms): 0.0009560026228427887
[1] Time of 1 dist conv forward(inner)(ms): 796.1368570104241
[1] #########
[1] Time of propagate(inner)(ms) = 796.2846111040562
[1] **************
[1] Time of linear(ms): 53.806917974725366
[1] Time of propagate(ms): 796.301188878715
[1] Time of add_bias(ms): 74.78716713376343
[1] Time of 1 dist conv forward(ms): 924.8968190513551
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 928.1518
[1] Time of relu(ms): 50.5227
[1] Time of dropout(ms): 197.3800
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.222301887348294
[1] Time of prepare recv data(ms): 0.0007080379873514175
[1] Time of barrier (all to all)(ms): 201.83348888531327
[1] Time of comm data (all to all)(ms): 16.847063088789582
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.031229108572006226
[1] Time of comm_forward(ms): 231.57100100070238
[1] Time of local aggregate(ms): 724.9075840227306
[1] Time of async wait(ms): 5.830243928357959
[1] Time of remote aggregate(ms): 37.473167991265655
[1] Time of sum up message(ms): 0.0009438954293727875
[1] Time of 1 dist conv forward(inner)(ms): 999.814169947058
[1] #########
[1] Time of propagate(inner)(ms) = 999.9258581083268
[1] **************
[1] Time of linear(ms): 100.47216201201081
[1] Time of propagate(ms): 999.9424458947033
[1] Time of add_bias(ms): 75.98680700175464
[1] Time of 1 dist conv forward(ms): 1176.403400953859
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1179.5537
[1] Time of relu(ms): 51.3136
[1] Time of dropout(ms): 195.1049
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1771141327917576
[1] Time of prepare recv data(ms): 0.00024889595806598663
[1] Time of barrier (all to all)(ms): 197.8505861479789
[1] Time of comm data (all to all)(ms): 13.603758998215199
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030574854463338852
[1] Time of comm_forward(ms): 214.34909896925092
[1] Time of local aggregate(ms): 139.5464730449021
[1] Time of async wait(ms): 1.2740010861307383
[1] Time of remote aggregate(ms): 7.616156013682485
[1] Time of sum up message(ms): 0.0008458737283945084
[1] Time of 1 dist conv forward(inner)(ms): 362.81714984215796
[1] #########
[1] Time of propagate(inner)(ms) = 362.92685894295573
[1] **************
[1] Time of linear(ms): 24.66959599405527
[1] Time of propagate(ms): 362.9433491732925
[1] Time of add_bias(ms): 16.22272585518658
[1] Time of 1 dist conv forward(ms): 403.8373529911041
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 14, loss: 0.3430754542350769
[1] $$$$
[1] Time of prepare send data(ms): 9.359300835058093
[1] Time of prepare recv data(ms): 0.0003220047801733017
[1] Time of barrier (all to all)(ms): 3.754924051463604
[1] Time of comm data (all to all)(ms): 22.800625069066882
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0324128195643425
[1] Time of comm_forward(ms): 39.52137706801295
[1] Time of local aggregate(ms): 720.014639897272
[1] Time of async wait(ms): 5.881252000108361
[1] Time of remote aggregate(ms): 37.476289086043835
[1] Time of sum up message(ms): 0.0007881317287683487
[1] Time of 1 dist conv forward(inner)(ms): 802.9267590027303
[1] #########
[1] Time of propagate(inner)(ms) = 803.0467010103166
[1] **************
[1] Time of linear(ms): 53.81113011389971
[1] Time of propagate(ms): 803.0648250132799
[1] Time of add_bias(ms): 74.24575602635741
[1] Time of 1 dist conv forward(ms): 931.1231500469148
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 934.4542
[1] Time of relu(ms): 50.3855
[1] Time of dropout(ms): 195.2082
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.2235601041466
[1] Time of prepare recv data(ms): 0.0003948807716369629
[1] Time of barrier (all to all)(ms): 195.87101810611784
[1] Time of comm data (all to all)(ms): 17.03389990143478
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03347499296069145
[1] Time of comm_forward(ms): 225.79044802114367
[1] Time of local aggregate(ms): 725.2195470500737
[1] Time of async wait(ms): 5.751131800934672
[1] Time of remote aggregate(ms): 37.51776204444468
[1] Time of sum up message(ms): 0.0006831251084804535
[1] Time of 1 dist conv forward(inner)(ms): 994.3130470346659
[1] #########
[1] Time of propagate(inner)(ms) = 994.4287119433284
[1] **************
[1] Time of linear(ms): 99.442298989743
[1] Time of propagate(ms): 994.445119984448
[1] Time of add_bias(ms): 74.88749898038805
[1] Time of 1 dist conv forward(ms): 1168.7764800153673
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1171.8938
[1] Time of relu(ms): 51.5235
[1] Time of dropout(ms): 196.0320
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1478780545294285
[1] Time of prepare recv data(ms): 0.0008409842848777771
[1] Time of barrier (all to all)(ms): 182.89545201696455
[1] Time of comm data (all to all)(ms): 13.595148921012878
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029787886887788773
[1] Time of comm_forward(ms): 199.47714102454484
[1] Time of local aggregate(ms): 136.51913404464722
[1] Time of async wait(ms): 1.192303141579032
[1] Time of remote aggregate(ms): 7.653515785932541
[1] Time of sum up message(ms): 0.0009201467037200928
[1] Time of 1 dist conv forward(inner)(ms): 344.87280203029513
[1] #########
[1] Time of propagate(inner)(ms) = 344.9824040289968
[1] **************
[1] Time of linear(ms): 25.260950904339552
[1] Time of propagate(ms): 344.9989929795265
[1] Time of add_bias(ms): 15.795551938936114
[1] Time of 1 dist conv forward(ms): 386.0569398384541
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 15, loss: 0.3341221809387207
[1] $$$$
[1] Time of prepare send data(ms): 9.357630042359233
[1] Time of prepare recv data(ms): 0.0002568121999502182
[1] Time of barrier (all to all)(ms): 4.102530190721154
[1] Time of comm data (all to all)(ms): 17.152360873296857
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03381283022463322
[1] Time of comm_forward(ms): 34.17899506166577
[1] Time of local aggregate(ms): 720.3277070075274
[1] Time of async wait(ms): 5.7896270882338285
[1] Time of remote aggregate(ms): 37.623584968969226
[1] Time of sum up message(ms): 0.0007469207048416138
[1] Time of 1 dist conv forward(inner)(ms): 797.9544738773257
[1] #########
[1] Time of propagate(inner)(ms) = 798.0712770950049
[1] **************
[1] Time of linear(ms): 53.62193891778588
[1] Time of propagate(ms): 798.088168958202
[1] Time of add_bias(ms): 74.20574803836644
[1] Time of 1 dist conv forward(ms): 925.9176298510283
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 929.2514
[1] Time of relu(ms): 50.7142
[1] Time of dropout(ms): 195.2680
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.244829881936312
[1] Time of prepare recv data(ms): 0.00037206336855888367
[1] Time of barrier (all to all)(ms): 199.51344397850335
[1] Time of comm data (all to all)(ms): 16.817427007481456
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03416603431105614
[1] Time of comm_forward(ms): 229.26902282051742
[1] Time of local aggregate(ms): 724.235903006047
[1] Time of async wait(ms): 5.849258974194527
[1] Time of remote aggregate(ms): 37.303372053429484
[1] Time of sum up message(ms): 0.0013881362974643707
[1] Time of 1 dist conv forward(inner)(ms): 996.693111024797
[1] #########
[1] Time of propagate(inner)(ms) = 996.8117240350693
[1] **************
[1] Time of linear(ms): 99.25500396639109
[1] Time of propagate(ms): 996.8288091477007
[1] Time of add_bias(ms): 74.66543698683381
[1] Time of 1 dist conv forward(ms): 1170.7508799154311
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1173.9455
[1] Time of relu(ms): 51.7642
[0] Time of remote aggregate(ms): 37.97909710556269
[0] Time of sum up message(ms): 0.0006568152457475662
[0] Time of 1 dist conv forward(inner)(ms): 984.8648568149656
[0] #########
[0] Time of propagate(inner)(ms) = 985.0099498871714
[0] **************
[0] Time of linear(ms): 55.042444029822946
[0] Time of propagate(ms): 985.0264359265566
[0] Time of add_bias(ms): 76.63870113901794
[0] Time of 1 dist conv forward(ms): 1116.7087079957128
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1119.9327
[0] Time of relu(ms): 53.4228
[0] Time of dropout(ms): 199.9411
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.803959099575877
[0] Time of prepare recv data(ms): 0.00036298297345638275
[0] Time of barrier (all to all)(ms): 0.2685168292373419
[0] Time of comm data (all to all)(ms): 27.662277221679688
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.04232488572597504
[0] Time of comm_forward(ms): 43.06100308895111
[0] Time of local aggregate(ms): 905.8497389778495
[0] Time of async wait(ms): 4.935479955747724
[0] Time of remote aggregate(ms): 37.87350608035922
[0] Time of sum up message(ms): 0.0007690396159887314
[0] Time of 1 dist conv forward(inner)(ms): 991.7628220282495
[0] #########
[0] Time of propagate(inner)(ms) = 991.8835707940161
[0] **************
[0] Time of linear(ms): 102.66146692447364
[0] Time of propagate(ms): 991.9020789675415
[0] Time of add_bias(ms): 76.89892407506704
[0] Time of 1 dist conv forward(ms): 1171.463640872389
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1174.6191
[0] Time of relu(ms): 52.9286
[0] Time of dropout(ms): 198.1948
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4372448679059744
[0] Time of prepare recv data(ms): 0.00048801302909851074
[0] Time of barrier (all to all)(ms): 0.22054510191082954
[0] Time of comm data (all to all)(ms): 13.430650811642408
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030796043574810028
[0] Time of comm_forward(ms): 16.84603514149785
[0] Time of local aggregate(ms): 171.08114482834935
[0] Time of async wait(ms): 1.040161121636629
[0] Time of remote aggregate(ms): 7.531503913924098
[0] Time of sum up message(ms): 0.0010889489203691483
[0] Time of 1 dist conv forward(inner)(ms): 196.5307299979031
[0] #########
[0] Time of propagate(inner)(ms) = 196.64632412604988
[0] **************
[0] Time of linear(ms): 25.086347945034504
[0] Time of propagate(ms): 196.66256895288825
[0] Time of add_bias(ms): 13.857930898666382
[0] Time of 1 dist conv forward(ms): 235.60822382569313
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 14, loss: 0.9400845766067505
[0] $$$$
[0] Time of prepare send data(ms): 10.934675112366676
[0] Time of prepare recv data(ms): 0.0003119930624961853
[0] Time of barrier (all to all)(ms): 0.2723238430917263
[0] Time of comm data (all to all)(ms): 17.63814897276461
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031170900911092758
[0] Time of comm_forward(ms): 33.069964963942766
[0] Time of local aggregate(ms): 904.2353720869869
[0] Time of async wait(ms): 4.918892867863178
[0] Time of remote aggregate(ms): 37.73339209146798
[0] Time of sum up message(ms): 0.0007869675755500793
[0] Time of 1 dist conv forward(inner)(ms): 979.9895798787475
[0] #########
[0] Time of propagate(inner)(ms) = 980.1130769774318
[0] **************
[0] Time of linear(ms): 55.20344921387732
[0] Time of propagate(ms): 980.1295429933816
[0] Time of add_bias(ms): 75.72448998689651
[0] Time of 1 dist conv forward(ms): 1111.059064976871
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1114.2905
[0] Time of relu(ms): 53.4628
[0] Time of dropout(ms): 199.9066
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 11.137625901028514
[0] Time of prepare recv data(ms): 0.000609084963798523
[0] Time of barrier (all to all)(ms): 0.29233191162347794
[0] Time of comm data (all to all)(ms): 17.852507065981627
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03372505307197571
[0] Time of comm_forward(ms): 33.674601931124926
[0] Time of local aggregate(ms): 901.6480199061334
[0] Time of async wait(ms): 4.951084032654762
[0] Time of remote aggregate(ms): 37.92406199499965
[0] Time of sum up message(ms): 0.0007909256964921951
[0] Time of 1 dist conv forward(inner)(ms): 978.2322838436812
[0] #########
[0] Time of propagate(inner)(ms) = 978.3498879987746
[0] **************
[0] Time of linear(ms): 104.88309385254979
[0] Time of propagate(ms): 978.3668860327452
[0] Time of add_bias(ms): 76.10935298725963
[0] Time of 1 dist conv forward(ms): 1159.3608788680285
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1162.6120
[0] Time of relu(ms): 53.3031
[0] Time of dropout(ms): 198.9263
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4979119189083576
[0] Time of prepare recv data(ms): 0.0003310851752758026
[0] Time of barrier (all to all)(ms): 0.29859901405870914
[0] Time of comm data (all to all)(ms): 13.41535896062851
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03440096043050289
[0] Time of comm_forward(ms): 16.976319020614028
[0] Time of local aggregate(ms): 171.29336716607213
[0] Time of async wait(ms): 1.0132428724318743
[0] Time of remote aggregate(ms): 7.508273934945464
[0] Time of sum up message(ms): 0.0008740462362766266
[0] Time of 1 dist conv forward(inner)(ms): 196.82647800073028
[0] #########
[0] Time of propagate(inner)(ms) = 196.95110199972987
[0] **************
[0] Time of linear(ms): 24.68018583022058
[0] Time of propagate(ms): 196.9690420664847
[0] Time of add_bias(ms): 13.917111093178391
[0] Time of 1 dist conv forward(ms): 235.56748521514237
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 15, loss: 0.9025610089302063
[0] $$$$
[0] Time of prepare send data(ms): 11.040992103517056
[0] Time of prepare recv data(ms): 0.00024097971618175507
[0] Time of barrier (all to all)(ms): 0.31080213375389576
[0] Time of comm data (all to all)(ms): 17.963786842301488
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030606985092163086
[0] Time of comm_forward(ms): 33.56258408166468
[0] Time of local aggregate(ms): 905.561343068257
[0] Time of async wait(ms): 4.944144980981946
[0] Time of remote aggregate(ms): 37.85364190116525
[0] Time of sum up message(ms): 0.0007799826562404633
[0] Time of 1 dist conv forward(inner)(ms): 981.9531009998173
[0] #########
[0] Time of propagate(inner)(ms) = 982.0737577974796
[0] **************
[0] Time of linear(ms): 55.188826052471995
[0] Time of propagate(ms): 982.0899630431086
[0] Time of add_bias(ms): 76.52946701273322
[0] Time of 1 dist conv forward(ms): 1113.8093979097903
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1117.0224
[0] Time of relu(ms): 53.2400
[0] Time of dropout(ms): 200.2855
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.819814866408706
[0] Time of prepare recv data(ms): 0.00024400651454925537
[0] Time of barrier (all to all)(ms): 0.2684451173990965
[0] Time of comm data (all to all)(ms): 17.635077936574817
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030749943107366562
[0] Time of comm_forward(ms): 32.99576509743929
[0] Time of local aggregate(ms): 903.4955129027367
[0] Time of async wait(ms): 4.993842914700508
[0] Time of remote aggregate(ms): 37.79500210657716
[0] Time of sum up message(ms): 0.0007520429790019989
[0] Time of 1 dist conv forward(inner)(ms): 979.31162500754
[0] #########
[0] Time of propagate(inner)(ms) = 979.4314389582723
[0] **************
[0] Time of linear(ms): 101.17179807275534
[0] Time of propagate(ms): 979.4486849568784
[0] Time of add_bias(ms): 76.42489206045866
[0] Time of 1 dist conv forward(ms): 1157.0466149132699
[0] **************
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001114
[1] elapsed time of allocating memory (spmm on forward): 0.001276
[1] elapsed time of no tile's kernel = 127.239ms
[1] elapsed time of no tile's spmm:127.293
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001355
[1] elapsed time of no tile's kernel = [1] 7.13716ms
[1] elapsed time of no tile's spmm:7.20171
[0] elapsed time of no tile's kernel = 162.205[0] ms
[0] elapsed time of no tile's spmm:162.276
[0] elapsed time of allocating memory (spmm on forward): [0] 0.0013
[0] elapsed time of no tile's kernel = [0] 6.99099ms[0] 
[0] elapsed time of no tile's spmm:7.06198[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001295
[1] elapsed time of no tile's kernel = 3.84685ms[1] 
[1] elapsed time of no tile's spmm:3.90222
[1] elapsed time of allocating memory (spmm on forward): 0.000943
[0] elapsed time of allocating memory (spmm on forward): 0.001143
[0] elapsed time of no tile's kernel = 3.91585ms
[0] elapsed time of no tile's spmm:3.97409
[0] elapsed time of allocating memory (spmm on forward): 0.001345
[1] elapsed time of no tile's kernel = 143.497ms
[1] elapsed time of no tile's spmm:143.551
[0] elapsed time of no tile's kernel = 162.622ms
[0] elapsed time of no tile's spmm:[0] 162.689
[1] elapsed time of allocating memory (spmm on forward): 0.001426
[1] elapsed time of no tile's kernel = 20.0706[1] ms
[1] elapsed time of no tile's spmm:20.1345
[0] elapsed time of allocating memory (spmm on forward): 0.001611
[0] elapsed time of no tile's kernel = 21.6584ms
[0] elapsed time of no tile's spmm:21.7182[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.000933
[0] elapsed time of allocating memory (spmm on forward): 0.001316
[1] elapsed time of no tile's kernel = 689.035ms
[1] elapsed time of no tile's spmm:689.113
[0] elapsed time of no tile's kernel = 857.006ms
[0] elapsed time of no tile's spmm:857.071
[1] elapsed time of allocating memory (spmm on forward): 0.001026
[1] elapsed time of no tile's kernel = [1] 20.3312ms
[1] elapsed time of no tile's spmm:20.3971
[1] elapsed time of allocating memory (spmm on forward): 0.001022
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001282
[0] elapsed time of no tile's kernel = 21.5789ms
[0] elapsed time of no tile's spmm:[0] 21.6391
[0] elapsed time of allocating memory (spmm on forward): 0.001099
[1] elapsed time of no tile's kernel = 768.478ms
[1] elapsed time of no tile's spmm:768.539
[0] elapsed time of no tile's kernel = 850.267ms
[0] elapsed time of no tile's spmm:850.335
[1] elapsed time of allocating memory (spmm on forward): 0.001457
[0] elapsed time of allocating memory (spmm on forward): 0.001365
[1] elapsed time of no tile's kernel = 662.734ms
[1] elapsed time of no tile's spmm:662.801
[1] elapsed time of allocating memory (spmm on forward): [1] 0.00095
[1] elapsed time of no tile's kernel = 37.0049ms[1] 
[1] elapsed time of no tile's spmm:37.0751
[0] elapsed time of no tile's kernel = 845.406ms
[0] elapsed time of no tile's spmm:845.476
[0] elapsed time of allocating memory (spmm on forward): 0.001223
[0] elapsed time of no tile's kernel = 37.2524ms
[0] elapsed time of no tile's spmm:37.3246
[1] elapsed time of allocating memory (spmm on forward): 0.001264
[0] elapsed time of allocating memory (spmm on forward): 0.001116
[1] elapsed time of no tile's kernel = 671.495ms
[1] elapsed time of no tile's spmm:671.593
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001241
[1] elapsed time of no tile's kernel = [1] 36.8709ms
[1] elapsed time of no tile's spmm:36.9403
[0] elapsed time of no tile's kernel = 847.154ms
[0] elapsed time of no tile's spmm:847.218
[0] elapsed time of allocating memory (spmm on forward): 0.001599
[0] elapsed time of no tile's kernel = 37.1585ms
[0] elapsed time of no tile's spmm:37.2318
[0] elapsed time of allocating memory (spmm on forward): 0.012229[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001038
[1] elapsed time of no tile's kernel = 127.279ms
[1] elapsed time of no tile's spmm:127.351
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000965
[1] elapsed time of no tile's kernel = [1] 7.15808ms
[1] elapsed time of no tile's spmm:7.22031
[0] elapsed time of no tile's kernel = 161.692ms
[0] elapsed time of no tile's spmm:161.763
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001018
[0] elapsed time of no tile's kernel = [0] 7.0243ms
[0] elapsed time of no tile's spmm:7.09679
[1] elapsed time of allocating memory (spmm on forward): 0.001183
[1] elapsed time of no tile's kernel = 3.82737ms
[1] elapsed time of no tile's spmm:3.88927
[0] elapsed time of allocating memory (spmm on forward): 0.001049
[1] elapsed time of allocating memory (spmm on forward): 0.00124
[0] elapsed time of no tile's kernel = 3.90778ms
[0] elapsed time of no tile's spmm:3.96322
[0] elapsed time of allocating memory (spmm on forward): 0.001227
[1] elapsed time of no tile's kernel = 145.259ms
[1] elapsed time of no tile's spmm:145.32
[0] elapsed time of no tile's kernel = 162.787ms
[0] elapsed time of no tile's spmm:162.844
[1] elapsed time of allocating memory (spmm on forward): 0.001076
[1] elapsed time of no tile's kernel = [1] 20.2193ms
[1] elapsed time of no tile's spmm:20.2856
[0] elapsed time of allocating memory (spmm on forward): 0.001555
[0] elapsed time of no tile's kernel = 21.453ms
[0] elapsed time of no tile's spmm:21.514[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001237
[0] elapsed time of allocating memory (spmm on forward): 0.000915
[1] elapsed time of no tile's kernel = 689.208ms
[1] elapsed time of no tile's spmm:689.277
[0] elapsed time of no tile's kernel = 851.998ms
[0] elapsed time of no tile's spmm:852.066
[1] elapsed time of allocating memory (spmm on forward): 0.000992
[1] elapsed time of no tile's kernel = 20.0455ms[1] 
[1] elapsed time of no tile's spmm:20.1084
[1] elapsed time of allocating memory (spmm on forward): 0.001674
[0] elapsed time of allocating memory (spmm on forward): 0.001157
[0] elapsed time of no tile's kernel = 21.489ms
[0] elapsed time of no tile's spmm:21.55
[0] elapsed time of allocating memory (spmm on forward): 0.001224
[1] elapsed time of no tile's kernel = 768.399ms
[1] elapsed time of no tile's spmm:768.462
[0] elapsed time of no tile's kernel = 851.155ms
[0] elapsed time of no tile's spmm:851.224
[1] elapsed time of allocating memory (spmm on forward): 0.000984
[0] elapsed time of allocating memory (spmm on forward): 0.000938
[1] elapsed time of no tile's kernel = 663.925ms
[1] elapsed time of no tile's spmm:663.984
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001199
[1] elapsed time of no tile's kernel = 37.1246ms
[1] elapsed time of no tile's spmm:37.1991
[0] elapsed time of no tile's kernel = 847.776ms
[0] elapsed time of no tile's spmm:847.843
[0] elapsed time of allocating memory (spmm on forward): 0.001628
[0] elapsed time of no tile's kernel = 37.2418ms
[0] elapsed time of no tile's spmm:37.3152
[1] elapsed time of allocating memory (spmm on forward): 0.001374
[0] elapsed time of allocating memory (spmm on forward): 0.001139
[1] elapsed time of no tile's kernel = 669.511ms
[1] elapsed time of no tile's spmm:669.608
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001193
[1] elapsed time of no tile's kernel = [1] 36.7791ms
[1] elapsed time of no tile's spmm:36.8497
[0] elapsed time of no tile's kernel = 846.927ms
[0] elapsed time of no tile's spmm:846.993
[0] elapsed time of allocating memory (spmm on forward): 0.000931
[0] elapsed time of no tile's kernel = 37.2825ms
[0] elapsed time of no tile's spmm:37.3676
[0] elapsed time of allocating memory (spmm on forward): 0.001246
[1] elapsed time of allocating memory (spmm on forward): 0.000976
[1] elapsed time of no tile's kernel = 127.452ms
[1] elapsed time of no tile's spmm:127.512
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001337
[1] elapsed time of no tile's kernel = [1] 7.11388ms
[1] elapsed time of no tile's spmm:7.18405
[0] elapsed time of no tile's kernel = 161.594ms
[0] elapsed time of no tile's spmm:161.657
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001096
[0] elapsed time of no tile's kernel = 7.12663ms
[0] elapsed time of no tile's spmm:7.19257
[1] elapsed time of allocating memory (spmm on forward): 0.001193
[1] elapsed time of no tile's kernel = 3.85903ms[1] 
[1] elapsed time of no tile's spmm:3.91418
[0] elapsed time of allocating memory (spmm on forward): 0.00111
[1] elapsed time of allocating memory (spmm on forward): 0.001503
[0] elapsed time of no tile's kernel = 3.91789ms
[0] elapsed time of no tile's spmm:3.97542
[0] elapsed time of allocating memory (spmm on forward): 0.001651
[1] elapsed time of no tile's kernel = 145.265ms
[1] elapsed time of no tile's spmm:145.32
[0] elapsed time of no tile's kernel = 163.288ms
[0] elapsed time of no tile's spmm:163.346
[1] elapsed time of allocating memory (spmm on forward): 0.001404
[1] elapsed time of no tile's kernel = 20.1636ms[1] 
[1] elapsed time of no tile's spmm:20.2241
[0] elapsed time of allocating memory (spmm on forward): 0.001345
[0] elapsed time of no tile's kernel = 21.5304ms
[0] elapsed time of no tile's spmm:21.5907[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001092
[0] elapsed time of allocating memory (spmm on forward): 0.000944
[1] elapsed time of no tile's kernel = 691.387ms
[1] elapsed time of no tile's spmm:691.472
[0] elapsed time of no tile's kernel = 850ms
[0] elapsed time of no tile's spmm:850.077
[1] elapsed time of allocating memory (spmm on forward): 0.001274
[1] elapsed time of no tile's kernel = 19.9913ms[1] 
[1] elapsed time of no tile's spmm:20.058
[1] elapsed time of allocating memory (spmm on forward): 0.001248
[0] elapsed time of allocating memory (spmm on forward): 0.001455
[0] elapsed time of no tile's kernel = 21.522ms
[0] elapsed time of no tile's spmm:21.5819
[0] elapsed time of allocating memory (spmm on forward): 0.001162
[1] elapsed time of no tile's kernel = 768.082ms
[1] elapsed time of no tile's spmm:768.145
[0] elapsed time of no tile's kernel = 853.884ms
[0] elapsed time of no tile's spmm:853.953
[0] ----------------------------------------
[0] Time of conv(ms): 1160.2682
[0] Time of relu(ms): 52.9310
[0] Time of dropout(ms): 199.6167
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4673431180417538
[0] Time of prepare recv data(ms): 0.0005988404154777527
[0] Time of barrier (all to all)(ms): 0.2759280614554882
[0] Time of comm data (all to all)(ms): 13.685140991583467
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030614901334047318
[0] Time of comm_forward(ms): 17.200863920152187
[0] Time of local aggregate(ms): 171.07007815502584
[0] Time of async wait(ms): 1.021459000185132
[0] Time of remote aggregate(ms): 7.498818915337324
[0] Time of sum up message(ms): 0.000775093212723732
[0] Time of 1 dist conv forward(inner)(ms): 196.82260998524725
[0] #########
[0] Time of propagate(inner)(ms) = 196.94124907255173
[0] **************
[0] Time of linear(ms): 25.045855902135372
[0] Time of propagate(ms): 196.95735489949584
[0] Time of add_bias(ms): 14.124704990535975
[0] Time of 1 dist conv forward(ms): 236.12904897890985
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 16, loss: 0.8828929662704468
[0] $$$$
[0] Time of prepare send data(ms): 10.96615707501769
[0] Time of prepare recv data(ms): 0.0006689224392175674
[0] Time of barrier (all to all)(ms): 1.8712659366428852
[0] Time of comm data (all to all)(ms): 17.68922107294202
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031171832233667374
[0] Time of comm_forward(ms): 34.73582700826228
[0] Time of local aggregate(ms): 901.491932105273
[0] Time of async wait(ms): 4.9815920647233725
[0] Time of remote aggregate(ms): 37.78193099424243
[0] Time of sum up message(ms): 0.000759027898311615
[0] Time of 1 dist conv forward(inner)(ms): 979.0232130326331
[0] #########
[0] Time of propagate(inner)(ms) = 979.1389140300453
[0] **************
[0] Time of linear(ms): 55.2102429792285
[0] Time of propagate(ms): 979.1557940188795
[0] Time of add_bias(ms): 75.79381600953639
[0] Time of 1 dist conv forward(ms): 1110.1613189093769
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1113.3760
[0] Time of relu(ms): 52.6510
[0] Time of dropout(ms): 199.7712
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.944369016215205
[0] Time of prepare recv data(ms): 0.00036996789276599884
[0] Time of barrier (all to all)(ms): 0.30331313610076904
[0] Time of comm data (all to all)(ms): 17.633303999900818
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030549941584467888
[0] Time of comm_forward(ms): 33.115768106654286
[0] Time of local aggregate(ms): 902.2790400777012
[0] Time of async wait(ms): 4.92487195879221
[0] Time of remote aggregate(ms): 37.68280101940036
[0] Time of sum up message(ms): 0.0008228234946727753
[0] Time of 1 dist conv forward(inner)(ms): 978.0338539276272
[0] #########
[0] Time of propagate(inner)(ms) = 978.1613328959793
[0] **************
[0] Time of linear(ms): 100.9838399477303
[0] Time of propagate(ms): 978.1793539877981
[0] Time of add_bias(ms): 75.85523114539683
[0] Time of 1 dist conv forward(ms): 1155.01967119053
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1158.3270
[0] Time of relu(ms): 52.7523
[0] Time of dropout(ms): 200.0079
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.5230490136891603
[0] Time of prepare recv data(ms): 0.0003310851752758026
[0] Time of barrier (all to all)(ms): 0.279868021607399
[0] Time of comm data (all to all)(ms): 13.443673960864544
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029482180252671242
[0] Time of comm_forward(ms): 16.98875497095287
[0] Time of local aggregate(ms): 170.5988529138267
[0] Time of async wait(ms): 0.9205990936607122
[0] Time of remote aggregate(ms): 7.531317882239819
[0] Time of sum up message(ms): 0.0007529743015766144
[0] Time of 1 dist conv forward(inner)(ms): 196.06976001523435
[0] #########
[0] Time of propagate(inner)(ms) = 196.1914838757366
[0] **************
[0] Time of linear(ms): 24.95513390749693
[0] Time of propagate(ms): 196.20733591727912
[0] Time of add_bias(ms): 14.584369026124477
[0] Time of 1 dist conv forward(ms): 235.7480099890381
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 17, loss: 0.8614006638526917
[0] $$$$
[0] Time of prepare send data(ms): 10.985615896061063
[0] Time of prepare recv data(ms): 0.00030105002224445343
[0] Time of barrier (all to all)(ms): 0.29828399419784546
[0] Time of comm data (all to all)(ms): 17.647851025685668
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02855900675058365
[0] Time of comm_forward(ms): 33.165663946419954
[0] Time of local aggregate(ms): 904.0477650705725
[0] Time of async wait(ms): 5.01077389344573
[0] Time of remote aggregate(ms): 37.76828292757273
[0] Time of sum up message(ms): 0.0007390044629573822
[0] Time of 1 dist conv forward(inner)(ms): 980.0217838492244
[0] #########
[0] Time of propagate(inner)(ms) = 980.1375889219344
[0] **************
[0] Time of linear(ms): 54.96972496621311
[0] Time of propagate(ms): 980.1548928953707
[0] Time of add_bias(ms): 76.88709697686136
[0] Time of 1 dist conv forward(ms): 1112.012828933075
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1115.2304
[0] Time of relu(ms): 53.4194
[0] Time of dropout(ms): 199.5795
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.968873044475913
[0] Time of prepare recv data(ms): 0.0003129243850708008
[0] Time of barrier (all to all)(ms): 0.27097389101982117
[0] Time of comm data (all to all)(ms): 18.292291089892387
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.04324503242969513
[0] Time of comm_forward(ms): 33.73568900860846
[0] Time of local aggregate(ms): 902.5510160718113
[0] Time of async wait(ms): 4.9807128962129354
[0] Time of remote aggregate(ms): 37.82487707212567
[0] Time of sum up message(ms): 0.0009019859135150909
[0] Time of 1 dist conv forward(inner)(ms): 979.1364420671016
[0] #########
[0] Time of propagate(inner)(ms) = 979.2575659230351
[0] **************
[0] Time of linear(ms): 101.10060311853886
[0] Time of propagate(ms): 979.2754610534757
[0] Time of add_bias(ms): 75.97594195976853
[0] Time of 1 dist conv forward(ms): 1156.3535600434989
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1159.5997
[0] Time of relu(ms): 52.5886
[0] Time of dropout(ms): 199.2426
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.481953939422965
[0] Time of prepare recv data(ms): 0.00029709190130233765
[0] Time of barrier (all to all)(ms): 0.2934050280600786
[0] Time of comm data (all to all)(ms): 13.799201929941773
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032744137570261955
[0] Time of comm_forward(ms): 17.34767807647586
[0] Time of local aggregate(ms): 169.19249179773033
[0] Time of async wait(ms): 0.9876731783151627
[0] Time of remote aggregate(ms): 7.626578910276294
[0] Time of sum up message(ms): 0.0009220093488693237
[0] Time of 1 dist conv forward(inner)(ms): 195.18808810971677
[0] #########
[0] Time of propagate(inner)(ms) = 195.30434883199632
[0] **************
[0] Time of linear(ms): 25.025539798662066
[0] Time of propagate(ms): 195.32432802952826
[0] Time of add_bias(ms): 14.03475203551352
[0] Time of 1 dist conv forward(ms): 234.38617587089539
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 18, loss: 0.8344601392745972
[0] $$$$
[0] Time of prepare send data(ms): 11.175507912412286
[0] Time of prepare recv data(ms): 0.0004931353032588959
[0] Time of barrier (all to all)(ms): 0.28027594089508057
[1] elapsed time of allocating memory (spmm on forward): 0.001092
[0] elapsed time of allocating memory (spmm on forward): 0.001211
[1] elapsed time of no tile's kernel = 665.793ms
[1] elapsed time of no tile's spmm:665.86
[1] Time of dropout(ms): 196.0136
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.192114945501089
[1] Time of prepare recv data(ms): 0.0002230517566204071
[1] Time of barrier (all to all)(ms): 187.3312450479716
[1] Time of comm data (all to all)(ms): 13.856491073966026
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0307310838252306
[1] Time of comm_forward(ms): 204.10202583298087
[1] Time of local aggregate(ms): 135.84330002777278
[1] Time of async wait(ms): 1.1959229595959187
[1] Time of remote aggregate(ms): 7.649410981684923
[1] Time of sum up message(ms): 0.0009431969374418259
[1] Time of 1 dist conv forward(inner)(ms): 348.82233408279717
[1] #########
[1] Time of propagate(inner)(ms) = 348.93560293130577
[1] **************
[1] Time of linear(ms): 24.59577890112996
[1] Time of propagate(ms): 348.95296208560467
[1] Time of add_bias(ms): 15.837254002690315
[1] Time of 1 dist conv forward(ms): 389.38747998327017
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 16, loss: 0.32157689332962036
[1] $$$$
[1] Time of prepare send data(ms): 9.856218937784433
[1] Time of prepare recv data(ms): 0.0003059394657611847
[1] Time of barrier (all to all)(ms): 0.3507761284708977
[1] Time of comm data (all to all)(ms): 16.909767873585224
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.032782088965177536
[1] Time of comm_forward(ms): 30.92836495488882
[1] Time of local aggregate(ms): 717.6158388610929
[1] Time of async wait(ms): 5.833889124915004
[1] Time of remote aggregate(ms): 37.51694085076451
[1] Time of sum up message(ms): 0.0008700881153345108
[1] Time of 1 dist conv forward(inner)(ms): 791.9286859687418
[1] #########
[1] Time of propagate(inner)(ms) = 792.0440540183336
[1] **************
[1] Time of linear(ms): 58.08794917538762
[1] Time of propagate(ms): 792.0773059595376
[1] Time of add_bias(ms): 73.7398169003427
[1] Time of 1 dist conv forward(ms): 923.9064399152994
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 927.2243
[1] Time of relu(ms): 51.0165
[1] Time of dropout(ms): 195.4581
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.171959944069386
[1] Time of prepare recv data(ms): 0.0004360917955636978
[1] Time of barrier (all to all)(ms): 196.55726291239262
[1] Time of comm data (all to all)(ms): 16.81557111442089
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.045803142711520195
[1] Time of comm_forward(ms): 226.1144919320941
[1] Time of local aggregate(ms): 726.1259239166975
[1] Time of async wait(ms): 5.77051006257534
[1] Time of remote aggregate(ms): 37.410360062494874
[1] Time of sum up message(ms): 0.0009718351066112518
[1] Time of 1 dist conv forward(inner)(ms): 995.46806095168
[1] #########
[1] Time of propagate(inner)(ms) = 995.5843831412494
[1] **************
[1] Time of linear(ms): 99.15541089139879
[1] Time of propagate(ms): 995.6020661629736
[1] Time of add_bias(ms): 74.83682385645807
[1] Time of 1 dist conv forward(ms): 1169.595770072192
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1172.8086
[1] Time of relu(ms): 51.4516
[1] Time of dropout(ms): 195.7596
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1144559141248465
[1] Time of prepare recv data(ms): 0.0001601874828338623
[1] Time of barrier (all to all)(ms): 183.46083094365895
[1] Time of comm data (all to all)(ms): 13.617557007819414
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03664800897240639
[1] Time of comm_forward(ms): 200.0149111263454
[1] Time of local aggregate(ms): 135.9537618700415
[1] Time of async wait(ms): 1.2726150453090668
[1] Time of remote aggregate(ms): 7.703696144744754
[1] Time of sum up message(ms): 0.0008328352123498917
[1] Time of 1 dist conv forward(inner)(ms): 344.98246503062546
[1] #########
[1] Time of propagate(inner)(ms) = 345.1086750719696
[1] **************
[1] Time of linear(ms): 25.193764828145504
[1] Time of propagate(ms): 345.1247471384704
[1] Time of add_bias(ms): 15.896891942247748
[1] Time of 1 dist conv forward(ms): 386.2171380314976
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 17, loss: 0.3060387670993805
[1] $$$$
[1] Time of prepare send data(ms): 9.36837401241064
[1] Time of prepare recv data(ms): 0.000700121745467186
[1] Time of barrier (all to all)(ms): 3.6055019591003656
[1] Time of comm data (all to all)(ms): 16.813589027151465
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030481955036520958
[1] Time of comm_forward(ms): 33.39580213651061
[1] Time of local aggregate(ms): 718.7039458658546
[1] Time of async wait(ms): 5.83306816406548
[1] Time of remote aggregate(ms): 37.64436789788306
[1] Time of sum up message(ms): 0.0008870847523212433
[1] Time of 1 dist conv forward(inner)(ms): 795.6085531041026
[1] #########
[1] Time of propagate(inner)(ms) = 795.7221078686416
[1] **************
[1] Time of linear(ms): 53.850197000429034
[1] Time of propagate(ms): 795.7392500247806
[1] Time of add_bias(ms): 73.99182696826756
[1] Time of 1 dist conv forward(ms): 923.5829119570553
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 926.8792
[1] Time of relu(ms): 50.9959
[1] Time of dropout(ms): 196.4890
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.192978963255882
[1] Time of prepare recv data(ms): 0.0005010515451431274
[1] Time of barrier (all to all)(ms): 198.29872297123075
[1] Time of comm data (all to all)(ms): 17.46721682138741
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03393390215933323
[1] Time of comm_forward(ms): 228.68286399170756
[1] Time of local aggregate(ms): 724.1770080290735
[1] Time of async wait(ms): 5.8565090876072645
[1] Time of remote aggregate(ms): 37.30432200245559
[1] Time of sum up message(ms): 0.0008079223334789276
[1] Time of 1 dist conv forward(inner)(ms): 996.0554449353367
[1] #########
[1] Time of propagate(inner)(ms) = 996.1700600106269
[1] **************
[1] Time of linear(ms): 99.14093092083931
[1] Time of propagate(ms): 996.1874200962484
[1] Time of add_bias(ms): 74.05598601326346
[1] Time of 1 dist conv forward(ms): 1169.3858220241964
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1172.5668
[1] Time of relu(ms): 51.9387
[1] Time of dropout(ms): 196.2868
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.156422007828951
[1] Time of prepare recv data(ms): 0.0005310866981744766
[1] Time of barrier (all to all)(ms): 185.61991001479328
[1] Time of comm data (all to all)(ms): 13.974882895126939
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03240583464503288
[1] Time of comm_forward(ms): 202.48623518273234
[1] Time of local aggregate(ms): 134.79501195251942
[1] Time of async wait(ms): 1.1795999016612768
[1] Time of remote aggregate(ms): 7.625774014741182
[1] Time of sum up message(ms): 0.0009639188647270203
[1] Time of 1 dist conv forward(inner)(ms): 346.119990805164
[1] #########
[1] Time of propagate(inner)(ms) = 346.23158699832857
[1] **************
[1] Time of linear(ms): 24.49680003337562
[1] Time of propagate(ms): 346.2493608240038
[1] Time of add_bias(ms): 16.175229102373123
[1] Time of 1 dist conv forward(ms): 386.92273013293743
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 18, loss: 0.29130181670188904
[1] $$$$
[1] Time of prepare send data(ms): 9.360337164252996
[1] Time of prepare recv data(ms): 0.00030081719160079956
[1] Time of barrier (all to all)(ms): 4.162738099694252
[1] Time of comm data (all to all)(ms): 17.480820883065462
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] elapsed time of allocating memory (spmm on forward): 0.000883
[1] elapsed time of no tile's kernel = 37.2334ms
[1] elapsed time of no tile's spmm:37.2931
[0] elapsed time of no tile's kernel = 846.631ms
[0] elapsed time of no tile's spmm:846.695
[0] elapsed time of allocating memory (spmm on forward): 0.001947
[0] elapsed time of no tile's kernel = 37.7119ms
[0] elapsed time of no tile's spmm:37.7851
[1] elapsed time of allocating memory (spmm on forward): 0.001304
[0] elapsed time of allocating memory (spmm on forward): 0.000964
[1] elapsed time of no tile's kernel = 667.378ms
[1] elapsed time of no tile's spmm:667.438
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001002
[1] elapsed time of no tile's kernel = [1] 37.0658ms
[1] elapsed time of no tile's spmm:37.1349
[0] elapsed time of no tile's kernel = 848.235ms
[0] elapsed time of no tile's spmm:848.302
[0] elapsed time of allocating memory (spmm on forward): 0.001459
[0] elapsed time of no tile's kernel = 36.957ms
[0] elapsed time of no tile's spmm:37.0311
[0] elapsed time of allocating memory (spmm on forward): 0.001512[1] elapsed time of allocating memory (spmm on forward): 0.00103
[0] 
[1] elapsed time of no tile's kernel = 127.45ms
[1] elapsed time of no tile's spmm:127.52
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000995
[1] elapsed time of no tile's kernel = [1] 7.00921ms
[1] elapsed time of no tile's spmm:7.07334
[0] elapsed time of no tile's kernel = 161.976ms
[0] elapsed time of no tile's spmm:162.036
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001226
[0] elapsed time of no tile's kernel = 6.8614ms
[0] elapsed time of no tile's spmm:6.93308
[1] elapsed time of allocating memory (spmm on forward): 0.001185
[1] elapsed time of no tile's kernel = 3.84254ms
[1] elapsed time of no tile's spmm:3.89374
[1] elapsed time of allocating memory (spmm on forward): 0.001316
[0] elapsed time of allocating memory (spmm on forward): 0.001211
[0] elapsed time of no tile's kernel = 3.85843ms
[0] elapsed time of no tile's spmm:3.9138
[0] elapsed time of allocating memory (spmm on forward): 0.001365
[1] elapsed time of no tile's kernel = 145.064ms
[1] elapsed time of no tile's spmm:145.122
[0] elapsed time of no tile's kernel = 163.235ms
[0] elapsed time of no tile's spmm:163.302
[1] elapsed time of allocating memory (spmm on forward): 0.001093
[1] elapsed time of no tile's kernel = 19.9789[1] ms
[1] elapsed time of no tile's spmm:20.0381
[0] elapsed time of allocating memory (spmm on forward): 0.001118
[0] elapsed time of no tile's kernel = 21.4841ms
[0] elapsed time of no tile's spmm:21.5438[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001216
[0] elapsed time of allocating memory (spmm on forward): 0.001273
[1] elapsed time of no tile's kernel = 688.213ms
[1] elapsed time of no tile's spmm:688.272
[0] elapsed time of no tile's kernel = 851.579ms
[0] elapsed time of no tile's spmm:851.647
[1] elapsed time of allocating memory (spmm on forward): 0.001108
[1] elapsed time of no tile's kernel = 19.962ms
[1] elapsed time of no tile's spmm:20.0212
[1] elapsed time of allocating memory (spmm on forward): 0.001514
[0] elapsed time of allocating memory (spmm on forward): 0.00129
[0] elapsed time of no tile's kernel = 21.4963ms
[0] elapsed time of no tile's spmm:21.5536
[0] elapsed time of allocating memory (spmm on forward): 0.001622
[1] elapsed time of no tile's kernel = 764.232ms
[1] elapsed time of no tile's spmm:764.292
[0] elapsed time of no tile's kernel = 851.055ms
[0] elapsed time of no tile's spmm:851.124
[1] elapsed time of allocating memory (spmm on forward): 0.000949
[0] elapsed time of allocating memory (spmm on forward): 0.001006
[1] elapsed time of no tile's kernel = 666.905ms
[1] elapsed time of no tile's spmm:666.985
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001283
[1] elapsed time of no tile's kernel = [1] 36.8187ms
[1] elapsed time of no tile's spmm:36.8901
[0] elapsed time of no tile's kernel = 847.056ms
[0] elapsed time of no tile's spmm:847.122
[0] elapsed time of allocating memory (spmm on forward): 0.007349
[0] elapsed time of no tile's kernel = 37.5406ms
[0] elapsed time of no tile's spmm:37.618
[1] elapsed time of allocating memory (spmm on forward): 0.000992
[0] elapsed time of allocating memory (spmm on forward): 0.001236
[1] elapsed time of no tile's kernel = 665.553ms
[1] elapsed time of no tile's spmm:665.618
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001093
[1] elapsed time of no tile's kernel = [1] 37.0093ms
[1] elapsed time of no tile's spmm:37.0805
[0] elapsed time of no tile's kernel = 847.518ms
[0] elapsed time of no tile's spmm:847.587
[0] elapsed time of allocating memory (spmm on forward): 0.00144
[0] elapsed time of no tile's kernel = 37.1481ms
[0] elapsed time of no tile's spmm:37.2233
[0] elapsed time of allocating memory (spmm on forward): 0.001029
[1] elapsed time of allocating memory (spmm on forward): 0.000928
[1] elapsed time of no tile's kernel = 128.012ms
[1] elapsed time of no tile's spmm:128.091
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000923
[1] elapsed time of no tile's kernel = [1] 7.00871ms
[1] elapsed time of no tile's spmm:7.07657
[0] elapsed time of no tile's kernel = 161.618ms
[0] elapsed time of no tile's spmm:161.677
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001177
[0] elapsed time of no tile's kernel = [0] 6.94039ms
[0] elapsed time of no tile's spmm:7.01273
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03470410592854023
[1] Time of comm_forward(ms): 34.60102388635278
[1] Time of local aggregate(ms): 720.7099040970206
[1] Time of async wait(ms): 5.85564598441124
[1] Time of remote aggregate(ms): 37.81271702609956
[1] Time of sum up message(ms): 0.0007539056241512299
[1] Time of 1 dist conv forward(inner)(ms): 799.0147490054369
[1] #########
[1] Time of propagate(inner)(ms) = 799.1269801277667
[1] **************
[1] Time of linear(ms): 53.78895881585777
[1] Time of propagate(ms): 799.1463101934642
[1] Time of add_bias(ms): 73.87055503204465
[1] Time of 1 dist conv forward(ms): 926.8076082225889
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 930.1532
[1] Time of relu(ms): 50.4198
[1] Time of dropout(ms): 196.0869
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.181701112538576
[1] Time of prepare recv data(ms): 0.0003948807716369629
[1] Time of barrier (all to all)(ms): 195.88386011309922
[1] Time of comm data (all to all)(ms): 16.61710301414132
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03347592428326607
[1] Time of comm_forward(ms): 225.319606019184
[1] Time of local aggregate(ms): 721.9445030204952
[1] Time of async wait(ms): 5.80430612899363
[1] Time of remote aggregate(ms): 37.59226994588971
[1] Time of sum up message(ms): 0.0008230563253164291
[1] Time of 1 dist conv forward(inner)(ms): 990.6949840951711
[1] #########
[1] Time of propagate(inner)(ms) = 990.8104941714555
[1] **************
[1] Time of linear(ms): 99.38356396742165
[1] Time of propagate(ms): 990.8273611217737
[1] Time of add_bias(ms): 74.9058888759464
[1] Time of 1 dist conv forward(ms): 1165.118447970599
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1168.1879
[1] Time of relu(ms): 51.3963
[1] Time of dropout(ms): 195.9633
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1399809047579765
[1] Time of prepare recv data(ms): 0.0005520414561033249
[1] Time of barrier (all to all)(ms): 188.03567998111248
[1] Time of comm data (all to all)(ms): 13.742943992838264
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.042525120079517365
[1] Time of comm_forward(ms): 204.80167493224144
[1] Time of local aggregate(ms): 134.9007550161332
[1] Time of async wait(ms): 1.2190418783575296
[1] Time of remote aggregate(ms): 7.522009080275893
[1] Time of sum up message(ms): 0.0007699709385633469
[1] Time of 1 dist conv forward(inner)(ms): 348.48677599802613
[1] #########
[1] Time of propagate(inner)(ms) = 348.59975799918175
[1] **************
[1] Time of linear(ms): 25.275720050558448
[1] Time of propagate(ms): 348.6164410132915
[1] Time of add_bias(ms): 16.16360410116613
[1] Time of 1 dist conv forward(ms): 390.0573030114174
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 19, loss: 0.2780223488807678
[1] training end.
[1] sparse_tensor test!
[1] $$$$
[1] Time of prepare send data(ms): 9.347341023385525
[1] Time of prepare recv data(ms): 0.00040302984416484833
[1] Time of barrier (all to all)(ms): 3.9355598855763674
[1] Time of comm data (all to all)(ms): 17.464233096688986
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03461400046944618
[1] Time of comm_forward(ms): 34.34415301308036
[1] Time of local aggregate(ms): 721.4939778205007
[1] Time of async wait(ms): 5.843081045895815
[1] Time of remote aggregate(ms): 37.35769703052938
[1] Time of sum up message(ms): 0.0008291099220514297
[1] Time of 1 dist conv forward(inner)(ms): 799.0743520203978
[1] #########
[1] Time of propagate(inner)(ms) = 799.18995895423
[1] **************
[1] Time of linear(ms): 53.96794783882797
[1] Time of propagate(ms): 799.2071909829974
[1] Time of add_bias(ms): 74.66387911699712
[1] Time of 1 dist conv forward(ms): 927.8405020013452
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 931.1648
[1] Time of relu(ms): 50.8824
[1] Time of dropout(ms): 0.0388
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.204228175804019
[1] Time of prepare recv data(ms): 0.00022887252271175385
[1] Time of barrier (all to all)(ms): 191.67667208239436
[1] Time of comm data (all to all)(ms): 16.877495916560292
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.034359050914645195
[1] Time of comm_forward(ms): 221.3511378504336
[1] Time of local aggregate(ms): 720.7961319945753
[1] Time of async wait(ms): 5.948822014033794
[1] Time of remote aggregate(ms): 37.544726161286235
[1] Time of sum up message(ms): 0.0008468050509691238
[1] Time of 1 dist conv forward(inner)(ms): 985.6760238762945
[1] #########
[1] Time of propagate(inner)(ms) = 985.7904550153762
[1] **************
[1] Time of linear(ms): 98.84317591786385
[1] Time of propagate(ms): 985.811271937564
[1] Time of add_bias(ms): 74.16579220443964
[1] Time of 1 dist conv forward(ms): 1158.8216030504555
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1162.0109
[1] Time of relu(ms): 50.7410
[1] Time of dropout(ms): 0.0412
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.246665069833398
[1] Time of prepare recv data(ms): 0.000308966264128685
[1] Time of barrier (all to all)(ms): 186.5323621314019
[1] Time of comm data (all to all)(ms): 13.2988509722054
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030810944736003876
[1] Time of comm_forward(ms): 202.9111641459167
[1] Time of local aggregate(ms): 137.4676418490708
[1] Time of async wait(ms): 1.2094690464437008
[1] Time of remote aggregate(ms): 7.551637943834066
[1] Time of sum up message(ms): 0.0015981495380401611
[1] Time of 1 dist conv forward(inner)(ms): 349.1723220795393
[1] #########
[1] Time of propagate(inner)(ms) = 349.28614902310073
[1] **************
[1] Time of linear(ms): 25.461427168920636
[1] Time of propagate(ms): 349.3035458959639
[1] Time of add_bias(ms): 15.953723108395934
[1] Time of 1 dist conv forward(ms): 390.7201059628278
[1] **************
[1] local num_correct_data = 87844, local num_entire_dataset = 92940
[1] local num_correct_data = 18095, local num_entire_dataset = 19448
[1] local num_correct_data = 823060, local num_entire_dataset = 1096739
[0] Time of comm data (all to all)(ms): 18.313060980290174
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032739946618676186
[0] Time of comm_forward(ms): 34.0744280256331
[0] Time of local aggregate(ms): 902.9574589803815
[0] Time of async wait(ms): 4.98731411062181
[0] Time of remote aggregate(ms): 38.242059061303735
[0] Time of sum up message(ms): 0.0007438939064741135
[0] Time of 1 dist conv forward(inner)(ms): 980.2947440184653
[0] #########
[0] Time of propagate(inner)(ms) = 980.4079439491034
[0] **************
[0] Time of linear(ms): 55.17225596122444
[0] Time of propagate(ms): 980.4251929745078
[0] Time of add_bias(ms): 76.13694202154875
[0] Time of 1 dist conv forward(ms): 1111.7358810734004
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1114.9535
[0] Time of relu(ms): 53.5136
[0] Time of dropout(ms): 199.9470
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.863402159884572
[0] Time of prepare recv data(ms): 0.000492902472615242
[0] Time of barrier (all to all)(ms): 0.26995898224413395
[0] Time of comm data (all to all)(ms): 17.44330395013094
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030435854569077492
[0] Time of comm_forward(ms): 32.81682403758168
[0] Time of local aggregate(ms): 903.5640249494463
[0] Time of async wait(ms): 4.928765119984746
[0] Time of remote aggregate(ms): 37.48867497779429
[0] Time of sum up message(ms): 0.0007979106158018112
[0] Time of 1 dist conv forward(inner)(ms): 978.8295228499919
[0] #########
[0] Time of propagate(inner)(ms) = 978.9490171242505
[0] **************
[0] Time of linear(ms): 100.91445711441338
[0] Time of propagate(ms): 978.9667669683695
[0] Time of add_bias(ms): 76.81050500832498
[0] Time of 1 dist conv forward(ms): 1156.69305017218
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1159.9660
[0] Time of relu(ms): 52.7304
[0] Time of dropout(ms): 198.9985
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.4641139898449183
[0] Time of prepare recv data(ms): 0.00036600977182388306
[0] Time of barrier (all to all)(ms): 0.2733520232141018
[0] Time of comm data (all to all)(ms): 13.554877135902643
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030996045097708702
[0] Time of comm_forward(ms): 17.05699204467237
[0] Time of local aggregate(ms): 169.67002185992897
[0] Time of async wait(ms): 0.990687170997262
[0] Time of remote aggregate(ms): 7.390947779640555
[0] Time of sum up message(ms): 0.0008610077202320099
[0] Time of 1 dist conv forward(inner)(ms): 195.1405059080571
[0] #########
[0] Time of propagate(inner)(ms) = 195.2567338012159
[0] **************
[0] Time of linear(ms): 24.926916928961873
[0] Time of propagate(ms): 195.27368200942874
[0] Time of add_bias(ms): 14.166435925289989
[0] Time of 1 dist conv forward(ms): 234.36813382431865
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 19, loss: 0.8094055652618408
[0] training end.
[0] forward_time(ms): 72566.609375
[0] backward_time(ms): 82688.203125
[0] share_grad_time(ms): 0.030225958675146103
[0] update_weight_time(ms): 88.67706298828125
[0] total_training_time(ms): 155361.515625
[0] sparse_tensor test!
[0] $$$$
[0] Time of prepare send data(ms): 10.930697899311781
[0] Time of prepare recv data(ms): 0.0007071066647768021
[0] Time of barrier (all to all)(ms): 0.2843830734491348
[0] Time of comm data (all to all)(ms): 18.272001994773746
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.028139911592006683
[0] Time of comm_forward(ms): 33.73706294223666
[0] Time of local aggregate(ms): 902.6436270214617
[0] Time of async wait(ms): 4.918504040688276
[0] Time of remote aggregate(ms): 38.05877291597426
[0] Time of sum up message(ms): 0.0007511116564273834
[0] Time of 1 dist conv forward(inner)(ms): 979.3868579436094
[0] #########
[0] Time of propagate(inner)(ms) = 979.5022930484265
[0] **************
[0] Time of linear(ms): 55.26567297056317
[0] Time of propagate(ms): 979.5199101790786
[0] Time of add_bias(ms): 76.69289177283645
[0] Time of 1 dist conv forward(ms): 1111.480097984895
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1114.6907
[0] Time of relu(ms): 53.5264
[0] Time of dropout(ms): 0.0433
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.868846904486418
[0] Time of prepare recv data(ms): 0.00026798807084560394
[0] Time of barrier (all to all)(ms): 0.2813891042023897
[0] Time of comm data (all to all)(ms): 17.699371092021465
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02858787775039673
[0] Time of comm_forward(ms): 33.08759699575603
[0] Time of local aggregate(ms): 903.3097170758992
[0] Time of async wait(ms): 4.947791108861566
[0] Time of remote aggregate(ms): 37.67410386353731
[0] Time of sum up message(ms): 0.0007350463420152664
[0] Time of 1 dist conv forward(inner)(ms): 979.0485319681466
[0] #########
[0] Time of propagate(inner)(ms) = 979.1695619933307
[0] **************
[0] Time of linear(ms): 101.60537110641599
[0] Time of propagate(ms): 979.1870480403304
[0] Time of add_bias(ms): 76.25101902522147
[0] Time of 1 dist conv forward(ms): 1157.044684048742
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1160.4683
[0] Time of relu(ms): 52.7861
[0] Time of dropout(ms): 0.0429
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.459067851305008
[0] Time of prepare recv data(ms): 0.0005520414561033249
[0] Time of barrier (all to all)(ms): 0.2741049975156784
[0] Time of comm data (all to all)(ms): 13.125857105478644
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03276299685239792
[0] Time of comm_forward(ms): 16.644014045596123
[0] Time of local aggregate(ms): 170.427018776536
[0] Time of async wait(ms): 0.9782491251826286
[0] Time of remote aggregate(ms): 7.451633922755718
[0] Time of sum up message(ms): 0.0008761417120695114
[0] Time of 1 dist conv forward(inner)(ms): 195.53455500863492
[0] #########
[0] Time of propagate(inner)(ms) = 195.65181201323867
[0] **************
[0] Time of linear(ms): 24.703417206183076
[0] Time of propagate(ms): 195.67077583633363
[0] Time of add_bias(ms): 14.274082146584988
[0] Time of 1 dist conv forward(ms): 234.64931803755462
[0] **************
[0] local num_correct_data = 83277, local num_entire_dataset = 103675
[0] local num_correct_data = 15841, local num_entire_dataset = 19875
[0] local num_correct_data = 716470, local num_entire_dataset = 1116352
[0] size of correct training sample = 171121, size of correct valid sample = 33936, size of correct test sample = 1539530
[0] size of all training sample = 196615, size of all valid sample = 39323, size of all test sample = 2213091
[0] Train: 0.8703, Val: 0.8630, Test: 0.6956
End Time:    Fri Jun  9 11:22:43 JST 2023
