NUM_THREADS: 20
CONDA_PREFIX: /home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10
Running 2 tasks on 1 nodes
CCL count: ,2
Affinity: , 0 1 20 21
/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/bin/python
/bin/gcc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpicc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpiexec.hydra
#### INITIAL ENV ####
Using CCL_ROOT=/groups/4/gac50544/gaa10008ku.ori/gaa10008ku.group2/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/python3.9/site-packages/oneccl_bind_pt-1.10.0-py3.9-linux-x86_64.egg/torch_ccl
Using CCL_WORKER_AFFINITY=0,1,20,21
Using CCL_WORKER_COUNT=2
Using I_MPI_HYDRA_BOOTSTRAP=sge
Using I_MPI_JOB_RESPECT_PROCESS_PLACEMENT=0
Using I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000]
Using I_MPI_ROOT=/apps/intel/2023.0/mpi/2021.8.0
Using KMP_AFFINITY=compact,1,granularity=fine,verbose
Using KMP_BLOCKTIME=1
Using OMP_NUM_THREADS=18
Using LD_PRELOAD=/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/libiomp5.so
Using ARGS_NTASKS=2
Using ARGS_PPN=1
#### INITIAL ENV ####
PyTorch version: 1.10.0
MASTER_ADDR=g0021.abci.local
Running mpiexec.hydra -np 2 -ppn 1  -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18  python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=false --num_epochs=10
[0] g0021.abci.local
[1] g0022.abci.local
Running mpiexec.hydra -np 2 -ppn 1 -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18 python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=false --num_epochs=10
Start Time:  Fri Jun  9 01:23:08 JST 2023
[1] elapsed time of allocating memory (spmm on forward): 0.000694
[0] elapsed time of allocating memory (spmm on forward): 0.000731
[1] elapsed time of no tile's kernel = 646.447ms
[1] elapsed time of no tile's spmm:646.537
[0] elapsed time of no tile's kernel = 797.536ms
[0] elapsed time of no tile's spmm:797.617
[1] elapsed time of allocating memory (spmm on forward): 0.00088
[1] elapsed time of no tile's kernel = [1] 37.1044ms
[1] elapsed time of no tile's spmm:37.172
[0] elapsed time of allocating memory (spmm on forward): 0.000977
[0] elapsed time of no tile's kernel = [0] 37.4007ms
[0] elapsed time of no tile's spmm:37.4719
[1] elapsed time of allocating memory (spmm on forward): 0.001516
[0] elapsed time of allocating memory (spmm on forward): 0.000866
[1] elapsed time of no tile's kernel = 733.536ms
[1] elapsed time of no tile's spmm:733.601
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001175
[1] elapsed time of no tile's kernel = 37.0022[1] ms
[1] elapsed time of no tile's spmm:37.0575
[0] elapsed time of no tile's kernel = 881.152ms
[0] elapsed time of no tile's spmm:881.223
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001493
[0] elapsed time of no tile's kernel = [0] 37.4216ms
[0] elapsed time of no tile's spmm:37.4792
[1] elapsed time of allocating memory (spmm on forward): 0.001104
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000927
[1] elapsed time of no tile's kernel = 127.722ms
[1] elapsed time of no tile's spmm:127.783
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000884
[1] elapsed time of no tile's kernel = [1] 7.3417ms
[1] elapsed time of no tile's spmm:7.39632
[0] elapsed time of no tile's kernel = 162.173ms
[0] elapsed time of no tile's spmm:162.238
[0] elapsed time of allocating memory (spmm on forward): 0.000624
[0] elapsed time of no tile's kernel = 7.24443ms
[0] elapsed time of no tile's spmm:7.29528
[0] elapsed time of allocating memory (spmm on forward): 0.000941
[0] elapsed time of no tile's kernel = 4.09548ms
[0] elapsed time of no tile's spmm:4.15309
[1] elapsed time of allocating memory (spmm on forward): 0.001251
[1] elapsed time of no tile's kernel = 4.08501ms
[1] elapsed time of no tile's spmm:4.14412
[1] elapsed time of allocating memory (spmm on forward): 0.000937
[1] elapsed time of no tile's kernel = 127.597ms
[1] elapsed time of no tile's spmm:127.656
[1] elapsed time of allocating memory (spmm on forward): 0.001102
[1] elapsed time of no tile's kernel = 19.9932ms
[1] elapsed time of no tile's spmm:20.0619
[1] elapsed time of allocating memory (spmm on forward): 0.001169
[0] elapsed time of allocating memory (spmm on forward): 0.00084
[0] elapsed time of no tile's kernel = 160.608ms
[0] elapsed time of no tile's spmm:160.702
[1] elapsed time of no tile's kernel = 1176.98ms
[1] elapsed time of no tile's spmm:1177.06
[0] elapsed time of allocating memory (spmm on forward): 0.001241
[0] elapsed time of no tile's kernel = 20.0295ms
[0] elapsed time of no tile's spmm:20.0955
[0] elapsed time of allocating memory (spmm on forward): 0.000775
[1] elapsed time of allocating memory (spmm on forward): 0.001079
[1] elapsed time of no tile's kernel = 19.9897ms
[1] elapsed time of no tile's spmm:20.0549
[1] elapsed time of allocating memory (spmm on forward): 0.001469
[0] elapsed time of no tile's kernel = 877.793ms
[0] elapsed time of no tile's spmm:877.86
[0] elapsed time of allocating memory (spmm on forward): 0.001086
[0] elapsed time of no tile's kernel = 20.1476ms
[0] elapsed time of no tile's spmm:20.2116
[0] elapsed time of allocating memory (spmm on forward): 0.001115
[1] elapsed time of no tile's kernel = 1056.18ms
[1] elapsed time of no tile's spmm:1056.24
[0] elapsed time of no tile's kernel = 883.573ms
[0] elapsed time of no tile's spmm:883.642
[1] elapsed time of allocating memory (spmm on forward): 0.001381
[0] elapsed time of allocating memory (spmm on forward): 0.001102
[1] elapsed time of no tile's kernel = 739.923ms
[1] elapsed time of no tile's spmm:739.992
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000824
[1] elapsed time of no tile's kernel = [1] 36.8347ms
[1] elapsed time of no tile's spmm:36.8914
[0] elapsed time of no tile's kernel = 895.432ms
[0] elapsed time of no tile's spmm:895.501
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001046
[0] elapsed time of no tile's kernel = [0] 37.7206ms
[0] elapsed time of no tile's spmm:37.7778
[0] elapsed time of allocating memory (spmm on forward): 0.001137
[1] elapsed time of allocating memory (spmm on forward): 0.001068
[1] elapsed time of no tile's kernel = 731.983ms
[1] elapsed time of no tile's spmm:732.051
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000715
[1] elapsed time of no tile's kernel = [1] 36.8003ms
[1] elapsed time of no tile's spmm:36.8567
[0] elapsed time of no tile's kernel = 882.85ms
[0] elapsed time of no tile's spmm:882.939
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000597
[0] elapsed time of no tile's kernel = [0] 37.5326ms
[0] elapsed time of no tile's spmm:37.5872
[0] elapsed time of allocating memory (spmm on forward): 0.001127
[1] elapsed time of allocating memory (spmm on forward): 0.000878
[1] elapsed time of no tile's kernel = 128.778ms
[1] elapsed time of no tile's spmm:128.843
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000715
[1] elapsed time of no tile's kernel = 7.22418ms
[1] elapsed time of no tile's spmm:7.27764
[1] graph_name = products, model_name = sage, is_async = False, is_fp16 = False
[1] num_epochs = 10, in_channels = 100, hidden_channels = 256, out_channels = 47
[1] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[1] PMI_SIZE = 2
[1] PMI_RANK = 1
[1] use ccl backend for torch.distributed package on x86 cpu.
[1] dist_info RANK: 1, SIZE: 2
[1] Rank = 1, Number of threads = 18
[1] int64
[1] nodes_id_range: 1239902 - 2449028
[1] nodes_feat_list.shape:
[1] (1209127, 100)
[1] float32
[1] int64
[1] [[    567    1560    3949 ... 1127231 1158662 1174515]
[1]  [      0       0       0 ... 1209126 1209126 1209126]]
[1] local remote_nodes_num_from_each_subgraph:
[1] tensor([289377,      0])
[1] int64
[1] elapsed time of loading dataset mask(ms) = 89.94651096872985
[1] elapsed time of obtaining number of remote nodes(ms) = 704.1135199833661
[1] elapsed time of obtaining list of remote nodes(ms) = 9.028295055031776
[1] convs.0.bias torch.Size([256])
[1] convs.0.lin.weight torch.Size([256, 100])
[1] convs.1.bias torch.Size([256])
[1] convs.1.lin.weight torch.Size([256, 256])
[1] convs.2.bias torch.Size([47])
[1] convs.2.lin.weight torch.Size([47, 256])
[1] $$$$
[1] Time of prepare send data(ms): 9.518672013655305
[1] Time of prepare recv data(ms): 0.000341096892952919
[1] Time of barrier (all to all)(ms): 0.31685386784374714
[1] Time of comm data (all to all)(ms): 13.052727095782757
[1] $$$$
[1] tensor([      0,   18811,   37912,   80820,  168637,  255166,  342785,  430229,
[1]          517378,  604507,  623852,  642929,  687592,  774203,  861392,  948028,
[1]         1035403, 1122003, 1209127], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([      0,   15916,   31391,   48270,  132969,  228000,  321734,  415264,
[1]          507817,  603262,  620173,  636779,  656423,  742172,  835993,  929044,
[1]         1020174, 1113710, 1209127], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.06788992322981358
[1] Time of comm_forward(ms): 27.44974591769278
[1] Time of local aggregate(ms): 6276.573070092127
[1] Time of async wait(ms): 0.01255003735423088
[1] Time of remote aggregate(ms): 5362.397478893399
[1] Time of sum up message(ms): 0.0010549556463956833
[1] Time of 1 dist conv forward(inner)(ms): 11666.50178981945
[1] #########
[1] Time of propagate(inner)(ms) = 11666.670695180073
[1] **************
[1] Time of linear(ms): 151.38784307055175
[1] Time of propagate(ms): 11666.691744932905
[1] Time of add_bias(ms): 74.39717510715127
[1] Time of 1 dist conv forward(ms): 12073.497961042449
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 12076.7885
[1] Time of relu(ms): 50.9938
[1] Time of dropout(ms): 382.4667
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.284419007599354
[1] Time of prepare recv data(ms): 0.0007499475032091141
[1] Time of barrier (all to all)(ms): 131.72697694972157
[1] Time of comm data (all to all)(ms): 12.542471988126636
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.027103116735816002
[1] Time of comm_forward(ms): 157.08286594599485
[1] Time of local aggregate(ms): 788.446188904345
[1] Time of async wait(ms): 0.012550968676805496
[1] Time of remote aggregate(ms): 37.47795312665403
[1] Time of sum up message(ms): 0.0009939540177583694
[1] Time of 1 dist conv forward(inner)(ms): 983.0476560164243
[1] #########
[1] Time of propagate(inner)(ms) = 983.1821951083839
[1] **************
[1] Time of linear(ms): 99.6897800359875
[1] Time of propagate(ms): 983.1986639183015
[1] Time of add_bias(ms): 74.71744902431965
[1] Time of 1 dist conv forward(ms): 1333.4611258469522
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1336.7570
[1] Time of relu(ms): 50.6255
[1] Time of dropout(ms): 195.6449
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.165543846786022
[1] Time of prepare recv data(ms): 0.0002591405063867569
[1] Time of barrier (all to all)(ms): 187.66012601554394
[1] Time of comm data (all to all)(ms): 15.868152026087046
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030193012207746506
[1] Time of comm_forward(ms): 206.30453806370497
[1] Time of local aggregate(ms): 147.19604002311826
[1] Time of async wait(ms): 0.011519994586706161
[1] Time of remote aggregate(ms): 7.814066018909216
[1] Time of sum up message(ms): 0.0010309740900993347
[1] Time of 1 dist conv forward(inner)(ms): 361.357388086617
[1] #########
[1] Time of propagate(inner)(ms) = 361.4834800828248
[1] **************
[1] Time of linear(ms): 24.506931891664863
[1] Time of propagate(ms): 361.49982805363834
[1] Time of add_bias(ms): 15.67867211997509
[1] Time of 1 dist conv forward(ms): 580.4143431596458
[1] **************
[1] tensor([     0,   9829,  19500,  30552,  49736,  68963,  88285, 107570, 126177,
[1]         145115, 154987, 164728, 175614, 194539, 213368, 232381, 251589, 270601,
[1]         289377], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([      0,   18811,   37912,   80820,  168637,  255166,  342785,  430229,
[1]          517378,  604507,  623852,  642929,  687592,  774203,  861392,  948028,
[1]         1035403, 1122003, 1209127], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 0, loss: 3.7785940170288086
[1] $$$$
[1] Time of prepare send data(ms): 9.435883956030011
[1] Time of prepare recv data(ms): 0.0007068738341331482
[1] Time of barrier (all to all)(ms): 3.4718760289251804
[1] Time of comm data (all to all)(ms): 12.163743143901229
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029403017833828926
[1] Time of comm_forward(ms): 28.568346984684467
[1] Time of local aggregate(ms): 794.1302440594882
[1] Time of async wait(ms): 0.013001961633563042
[1] Time of remote aggregate(ms): 37.32896992005408
[1] Time of sum up message(ms): 0.0007201451808214188
[1] Time of 1 dist conv forward(inner)(ms): 860.0706860888749
[1] #########
[1] Time of propagate(inner)(ms) = 860.2292200084776
[1] **************
[1] Time of linear(ms): 53.94413601607084
[1] Time of propagate(ms): 860.2477579843253
[1] Time of add_bias(ms): 75.7240189705044
[1] Time of 1 dist conv forward(ms): 989.9175039026886
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 993.1623
[1] Time of relu(ms): 50.6619
[1] Time of dropout(ms): 195.7836
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.308149106800556
[1] Time of prepare recv data(ms): 0.0009809155017137527
[1] Time of barrier (all to all)(ms): 169.52608013525605
[1] Time of comm data (all to all)(ms): 13.024813029915094
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02907402813434601
[1] Time of comm_forward(ms): 195.42049802839756
[1] Time of local aggregate(ms): 794.1489000804722
[1] Time of async wait(ms): 0.012135831639170647
[1] Time of remote aggregate(ms): 37.300607189536095
[1] Time of sum up message(ms): 0.0008309725672006607
[1] Time of 1 dist conv forward(inner)(ms): 1026.9120461307466
[1] #########
[1] Time of propagate(inner)(ms) = 1027.0392110105604
[1] **************
[1] Time of linear(ms): 99.43758905865252
[1] Time of propagate(ms): 1027.0569210406393
[1] Time of add_bias(ms): 75.79253800213337
[1] Time of 1 dist conv forward(ms): 1202.289419947192
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1205.6183
[1] Time of relu(ms): 50.1399
[1] Time of dropout(ms): 195.3896
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.11734208278358
[1] Time of prepare recv data(ms): 0.00025704503059387207
[1] Time of barrier (all to all)(ms): 152.03945501707494
[1] Time of comm data (all to all)(ms): 12.22443487495184
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030036084353923798
[1] Time of comm_forward(ms): 167.07893111743033
[1] Time of local aggregate(ms): 148.2473388314247
[1] Time of async wait(ms): 0.01203198917210102
[1] Time of remote aggregate(ms): 7.6952429953962564
[1] Time of sum up message(ms): 0.001027015969157219
[1] Time of 1 dist conv forward(inner)(ms): 323.0646080337465
[1] #########
[1] Time of propagate(inner)(ms) = 323.19111190736294
[1] **************
[1] Time of linear(ms): 25.56814788840711
[0] elapsed time of no tile's kernel = 160.988ms
[0] elapsed time of no tile's spmm:161.053
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000889
[0] elapsed time of no tile's kernel = 7.31169ms
[0] elapsed time of no tile's spmm:7.36396
[0] graph_name = products, model_name = sage, is_async = False, is_fp16 = False
[0] num_epochs = 10, in_channels = 100, hidden_channels = 256, out_channels = 47
[0] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[0] PMI_SIZE = 2
[0] PMI_RANK = 0
[0] use ccl backend for torch.distributed package on x86 cpu.
[0] dist_info RANK: 0, SIZE: 2
[0] Rank = 0, Number of threads = 18
[0] int64
[0] nodes_id_range: 0 - 1239901
[0] nodes_feat_list.shape:
[0] (1239902, 100)
[0] float32
[0] int64
[0] [[    100     642    1983 ...  499311  808625  964678]
[0]  [      0       0       0 ... 1239901 1239901 1239901]]
[0] local remote_nodes_num_from_each_subgraph:
[0] tensor([     0, 244144])
[0] int64
[0] elapsed time of loading dataset mask(ms) = 99.976192926988
[0] elapsed time of obtaining number of remote nodes(ms) = 946.3726179674268
[0] elapsed time of obtaining list of remote nodes(ms) = 9.19294310733676
[0] convs.0.bias torch.Size([256])
[0] convs.0.lin.weight torch.Size([256, 100])
[0] convs.1.bias torch.Size([256])
[0] convs.1.lin.weight torch.Size([256, 256])
[0] convs.2.bias torch.Size([47])
[0] convs.2.lin.weight torch.Size([47, 256])
[0] $$$$
[0] Time of prepare send data(ms): 11.33266999386251
[0] Time of prepare recv data(ms): 0.0005669426172971725
[0] Time of barrier (all to all)(ms): 9.447338059544563
[0] Time of comm data (all to all)(ms): 12.167793000116944
[0] $$$$
[0] tensor([      0,   21333,   42311,   88203,  177342,  265521,  354027,  443478,
[0]          531520,  620004,  641089,  662380,  708070,  796881,  885306,  974404,
[0]         1063502, 1150841, 1239902], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([      0,   18381,   36432,   59127,  151566,  245519,  340904,  436183,
[0]          527671,  620203,  638579,  656712,  679207,  770768,  863870,  958966,
[0]         1053315, 1146733, 1239902], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.07789791561663151
[0] Time of comm_forward(ms): 38.44383521936834
[0] Time of local aggregate(ms): 6438.471644883975
[0] Time of async wait(ms): 0.013634096831083298
[0] Time of remote aggregate(ms): 5464.617237914354
[0] Time of sum up message(ms): 0.0007050111889839172
[0] Time of 1 dist conv forward(inner)(ms): 11941.624955041334
[0] #########
[0] Time of propagate(inner)(ms) = 11941.78188405931
[0] **************
[0] Time of linear(ms): 157.25352079607546
[0] Time of propagate(ms): 11941.800847183913
[0] Time of add_bias(ms): 76.52436499483883
[0] Time of 1 dist conv forward(ms): 12386.8833060842
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 12390.2162
[0] Time of relu(ms): 53.6585
[0] Time of dropout(ms): 212.1698
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 11.104752076789737
[0] Time of prepare recv data(ms): 0.0005490146577358246
[0] Time of barrier (all to all)(ms): 0.2888359595090151
[0] Time of comm data (all to all)(ms): 12.783882906660438
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.027135014533996582
[0] Time of comm_forward(ms): 28.37599883787334
[0] Time of local aggregate(ms): 937.2942200861871
[0] Time of async wait(ms): 0.011689960956573486
[0] Time of remote aggregate(ms): 37.90305997245014
[0] Time of sum up message(ms): 0.0006870832294225693
[0] Time of 1 dist conv forward(inner)(ms): 1003.6127909552306
[0] #########
[0] Time of propagate(inner)(ms) = 1003.7293341010809
[0] **************
[0] Time of linear(ms): 101.28750209696591
[0] Time of propagate(ms): 1003.7441658787429
[0] Time of add_bias(ms): 76.39179122634232
[0] Time of 1 dist conv forward(ms): 1386.726985219866
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1389.8970
[0] Time of relu(ms): 53.3477
[0] Time of dropout(ms): 200.2533
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.500097965821624
[0] Time of prepare recv data(ms): 0.0004109460860490799
[0] Time of barrier (all to all)(ms): 0.2916129305958748
[0] Time of comm data (all to all)(ms): 17.13992701843381
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031332019716501236
[0] Time of comm_forward(ms): 20.71309508755803
[0] Time of local aggregate(ms): 181.62156688049436
[0] Time of async wait(ms): 0.012125121429562569
[0] Time of remote aggregate(ms): 7.7095478773117065
[0] Time of sum up message(ms): 0.0007890630513429642
[0] Time of 1 dist conv forward(inner)(ms): 210.0884560495615
[0] #########
[0] Time of propagate(inner)(ms) = 210.2003728505224
[0] **************
[0] Time of linear(ms): 24.33606213890016
[0] Time of propagate(ms): 210.21720091812313
[0] Time of add_bias(ms): 13.96898808889091
[0] Time of 1 dist conv forward(ms): 455.877150176093
[0] **************
[0] tensor([     0,   7539,  14851,  22574,  38655,  55428,  71988,  88566, 105040,
[0]         121970, 129669, 137539, 145923, 161808, 178295, 194544, 210692, 227341,
[0]         244144], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([      0,   21333,   42311,   88203,  177342,  265521,  354027,  443478,
[0]          531520,  620004,  641089,  662380,  708070,  796881,  885306,  974404,
[0]         1063502, 1150841, 1239902], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 0, loss: 3.8650994300842285
[0] $$$$
[0] Time of prepare send data(ms): 11.015064781531692
[0] Time of prepare recv data(ms): 0.0005092006176710129
[0] Time of barrier (all to all)(ms): 0.4220469854772091
[0] Time of comm data (all to all)(ms): 12.404392007738352
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03050197847187519
[0] Time of comm_forward(ms): 28.101421194151044
[0] Time of local aggregate(ms): 951.0785939637572
[0] Time of async wait(ms): 0.011743977665901184
[0] Time of remote aggregate(ms): 38.19949203170836
[0] Time of sum up message(ms): 0.0008319038897752762
[0] Time of 1 dist conv forward(inner)(ms): 1017.4225850496441
[0] #########
[0] Time of propagate(inner)(ms) = 1017.5445650238544
[0] **************
[0] Time of linear(ms): 54.62339008226991
[0] Time of propagate(ms): 1017.5609129946679
[0] Time of add_bias(ms): 77.88118999451399
[0] Time of 1 dist conv forward(ms): 1150.0669920351356
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1153.4305
[0] Time of relu(ms): 52.8402
[0] Time of dropout(ms): 198.2673
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.990113019943237
[0] Time of prepare recv data(ms): 0.0007299240678548813
[0] Time of barrier (all to all)(ms): 0.2931910566985607
[0] Time of comm data (all to all)(ms): 12.30057212524116
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029967166483402252
[0] Time of comm_forward(ms): 27.85720187239349
[0] Time of local aggregate(ms): 938.676793128252
[0] Time of async wait(ms): 0.012599863111972809
[0] Time of remote aggregate(ms): 37.9928071051836
[0] Time of sum up message(ms): 0.000726897269487381
[0] Time of 1 dist conv forward(inner)(ms): 1004.570096032694
[0] #########
[0] Time of propagate(inner)(ms) = 1004.6850270591676
[0] **************
[0] Time of linear(ms): 101.3002060353756
[0] Time of propagate(ms): 1004.6996749006212
[0] Time of add_bias(ms): 76.81872393004596
[0] Time of 1 dist conv forward(ms): 1182.8202428296208
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1186.0105
[0] Time of relu(ms): 52.5408
[0] Time of dropout(ms): 199.4375
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.6152068749070168
[0] Time of prepare recv data(ms): 0.0005280598998069763
[0] Time of barrier (all to all)(ms): 0.296375947073102
[0] Time of comm data (all to all)(ms): 12.498807162046432
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031046103686094284
[0] Time of comm_forward(ms): 16.20600395835936
[0] Time of local aggregate(ms): 179.4518220704049
[0] Time of async wait(ms): 0.01264084130525589
[0] Time of remote aggregate(ms): 7.773217977955937
[0] Time of sum up message(ms): 0.0006831251084804535
[0] Time of 1 dist conv forward(inner)(ms): 203.47541407682002
[0] #########
[0] Time of propagate(inner)(ms) = 203.5966799594462
[0] **************
[0] Time of linear(ms): 24.90550186485052
[0] Time of propagate(ms): 203.61433015204966
[1] elapsed time of allocating memory (spmm on forward): 0.001127
[1] elapsed time of no tile's kernel = 3.84142ms
[1] elapsed time of no tile's spmm:3.89996[1] 
[0] elapsed time of allocating memory (spmm on forward): 0.001049
[1] elapsed time of allocating memory (spmm on forward): 0.001232[1] 
[0] elapsed time of no tile's kernel = 3.83668ms
[0] elapsed time of no tile's spmm:3.90349
[0] elapsed time of allocating memory (spmm on forward): 0.001094
[1] elapsed time of no tile's kernel = 150.696ms
[1] elapsed time of no tile's spmm:150.759
[0] elapsed time of no tile's kernel = 164.553ms
[0] elapsed time of no tile's spmm:164.63
[1] elapsed time of allocating memory (spmm on forward): 0.001253
[1] elapsed time of no tile's kernel = 20.0002ms
[1] elapsed time of no tile's spmm:20.0625
[0] elapsed time of allocating memory (spmm on forward): 0.001129
[0] elapsed time of no tile's kernel = 20.2031ms
[0] elapsed time of no tile's spmm:20.268
[1] elapsed time of allocating memory (spmm on forward): 0.001109
[0] elapsed time of allocating memory (spmm on forward): 0.001144
[1] elapsed time of no tile's kernel = 767.273ms
[1] elapsed time of no tile's spmm:767.342
[0] elapsed time of no tile's kernel = 880.462ms
[0] elapsed time of no tile's spmm:880.537
[1] elapsed time of allocating memory (spmm on forward): 0.001221
[1] elapsed time of no tile's kernel = 19.8542ms
[1] elapsed time of no tile's spmm:19.9205
[1] elapsed time of allocating memory (spmm on forward): 0.000928
[0] elapsed time of allocating memory (spmm on forward): 0.001523
[0] elapsed time of no tile's kernel = 20.0687ms
[0] elapsed time of no tile's spmm:20.1338
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001241
[1] elapsed time of no tile's kernel = 821.829ms
[1] elapsed time of no tile's spmm:821.892
[0] elapsed time of no tile's kernel = 885.44ms
[0] elapsed time of no tile's spmm:885.512
[1] elapsed time of allocating memory (spmm on forward): 0.000905
[0] elapsed time of allocating memory (spmm on forward): 0.001057
[1] elapsed time of no tile's kernel = 737.592ms
[1] elapsed time of no tile's spmm:737.66
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001022
[1] elapsed time of no tile's kernel = [1] 36.7786ms
[1] elapsed time of no tile's spmm:36.8331
[0] elapsed time of no tile's kernel = 886.553ms[0] 
[0] elapsed time of no tile's spmm:886.623
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000942
[0] elapsed time of no tile's kernel = [0] 37.3178ms
[0] elapsed time of no tile's spmm:37.3704
[1] elapsed time of allocating memory (spmm on forward): 0.00141
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001536
[1] elapsed time of no tile's kernel = 740.165ms
[1] elapsed time of no tile's spmm:740.248
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000681
[1] elapsed time of no tile's kernel = [1] 36.9074ms
[1] elapsed time of no tile's spmm:36.9626
[0] elapsed time of no tile's kernel = 884.98ms
[0] elapsed time of no tile's spmm:885.056
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000938
[0] elapsed time of no tile's kernel = [0] 37.4483ms
[0] elapsed time of no tile's spmm:37.5062
[0] elapsed time of allocating memory (spmm on forward): 0.001062
[1] elapsed time of allocating memory (spmm on forward): 0.000875
[1] elapsed time of no tile's kernel = 127.791ms
[1] elapsed time of no tile's spmm:127.848
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001039
[1] elapsed time of no tile's kernel = [1] 7.26689ms
[1] elapsed time of no tile's spmm:7.32749
[0] elapsed time of no tile's kernel = 160.345ms
[0] elapsed time of no tile's spmm:[0] 160.408
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000672
[0] elapsed time of no tile's kernel = [0] 7.26352ms
[0] elapsed time of no tile's spmm:7.32547
[1] elapsed time of allocating memory (spmm on forward): 0.000959
[1] elapsed time of no tile's kernel = 3.81598ms
[1] elapsed time of no tile's spmm:3.87258
[1] elapsed time of allocating memory (spmm on forward): 0.000986
[0] elapsed time of allocating memory (spmm on forward): 0.001054
[0] elapsed time of no tile's kernel = 3.85443ms
[0] elapsed time of no tile's spmm:[0] 3.91284
[0] elapsed time of allocating memory (spmm on forward): 0.000765[0] 
[1] elapsed time of no tile's kernel = 150.249ms
[1] elapsed time of no tile's spmm:150.307
[0] elapsed time of no tile's kernel = 165.06ms
[0] elapsed time of no tile's spmm:165.129
[1] elapsed time of allocating memory (spmm on forward): 0.001211
[1] elapsed time of no tile's kernel = 20.1552ms
[1] elapsed time of no tile's spmm:20.2203
[0] elapsed time of allocating memory (spmm on forward): 0.00105[0] 
[0] elapsed time of no tile's kernel = 19.9628ms
[0] elapsed time of no tile's spmm:20.0324
[1] elapsed time of allocating memory (spmm on forward): 0.000878
[0] elapsed time of allocating memory (spmm on forward): 0.000845
[1] elapsed time of no tile's kernel = 762.016ms
[1] elapsed time of no tile's spmm:762.086
[0] elapsed time of no tile's kernel = [0] 886.064ms
[0] elapsed time of no tile's spmm:886.131
[1] elapsed time of allocating memory (spmm on forward): 0.001326
[1] elapsed time of no tile's kernel = 20.0669ms
[1] elapsed time of no tile's spmm:20.1309
[1] elapsed time of allocating memory (spmm on forward): 0.001261
[0] elapsed time of allocating memory (spmm on forward): 0.000984
[0] elapsed time of no tile's kernel = 20.5925ms
[0] elapsed time of no tile's spmm:20.6527
[0] elapsed time of allocating memory (spmm on forward): 0.00113
[1] elapsed time of no tile's kernel = 815.52ms
[1] elapsed time of no tile's spmm:815.586
[0] elapsed time of no tile's kernel = 889.606ms
[0] elapsed time of no tile's spmm:889.688
[1] elapsed time of allocating memory (spmm on forward): 0.000892
[0] elapsed time of allocating memory (spmm on forward): 0.000866
[1] elapsed time of no tile's kernel = 726.43ms
[1] elapsed time of no tile's spmm:726.494
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000993
[1] elapsed time of no tile's kernel = 36.9581[1] ms
[1] elapsed time of no tile's spmm:37.0148
[0] elapsed time of no tile's kernel = [0] 882.783ms
[0] elapsed time of no tile's spmm:882.85
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000863
[0] elapsed time of no tile's kernel = [0] 36.9927ms
[0] elapsed time of no tile's spmm:37.0495
[1] elapsed time of allocating memory (spmm on forward): 0.001285
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000952
[1] elapsed time of no tile's kernel = 727.273ms
[1] elapsed time of no tile's spmm:727.34
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000783
[1] elapsed time of no tile's kernel = [1] 36.7546ms
[1] elapsed time of no tile's spmm:36.8103
[0] elapsed time of no tile's kernel = [0] 880.268ms
[0] elapsed time of no tile's spmm:880.339
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000698
[0] elapsed time of no tile's kernel = [0] 37.2496ms
[0] elapsed time of no tile's spmm:37.3056
[0] elapsed time of allocating memory (spmm on forward): 0.000892
[1] elapsed time of allocating memory (spmm on forward): 0.001056
[1] elapsed time of no tile's kernel = 127.586ms
[1] elapsed time of no tile's spmm:127.651
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000902
[1] elapsed time of no tile's kernel = [1] 7.21203ms
[1] elapsed time of no tile's spmm:7.26429
[0] elapsed time of no tile's kernel = [0] 164.401ms
[0] elapsed time of no tile's spmm:164.473
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000809
[0] elapsed time of no tile's kernel = 7.2788ms
[0] elapsed time of no tile's spmm:7.33673
[1] elapsed time of allocating memory (spmm on forward): 0.001487
[1] elapsed time of no tile's kernel = 3.77617ms
[1] elapsed time of no tile's spmm:3.83493
[1] elapsed time of allocating memory (spmm on forward): 0.00099
[0] elapsed time of allocating memory (spmm on forward): 0.001138
[0] elapsed time of no tile's kernel = 3.83323ms
[0] elapsed time of no tile's spmm:3.89659
[0] elapsed time of allocating memory (spmm on forward): 0.001281
[1] elapsed time of no tile's kernel = 149.537ms
[1] elapsed time of no tile's spmm:149.595
[0] elapsed time of no tile's kernel = [0] 163.174ms
[0] elapsed time of no tile's spmm:163.243
[1] elapsed time of allocating memory (spmm on forward): 0.001216
[1] elapsed time of no tile's kernel = 20.0679ms
[1] elapsed time of no tile's spmm:[1] 20.1429
[0] elapsed time of allocating memory (spmm on forward): 0.00098
[1] elapsed time of allocating memory (spmm on forward): 0.001067
[0] elapsed time of no tile's kernel = 19.9511ms
[0] elapsed time of no tile's spmm:20.013
[0] elapsed time of allocating memory (spmm on forward): 0.000876
[1] elapsed time of no tile's kernel = 771.731ms
[1] elapsed time of no tile's spmm:771.799
[0] elapsed time of no tile's kernel = 883.261ms
[0] elapsed time of no tile's spmm:883.332
[1] elapsed time of allocating memory (spmm on forward): 0.001227
[1] elapsed time of no tile's kernel = 19.9031ms
[1] elapsed time of no tile's spmm:19.9663
[1] elapsed time of allocating memory (spmm on forward): 0.001275[1] 
[0] elapsed time of allocating memory (spmm on forward): 0.001227
[0] elapsed time of no tile's kernel = 19.9716ms
[0] elapsed time of no tile's spmm:20.0355
[0] elapsed time of allocating memory (spmm on forward): 0.000901
[1] elapsed time of no tile's kernel = 822.225ms
[1] elapsed time of no tile's spmm:822.293
[0] elapsed time of no tile's kernel = [0] 882.808ms
[0] elapsed time of no tile's spmm:882.877
[1] elapsed time of allocating memory (spmm on forward): 0.001022
[0] elapsed time of allocating memory (spmm on forward): 0.000927
[1] elapsed time of no tile's kernel = 731.595ms
[1] elapsed time of no tile's spmm:731.661
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000888
[1] elapsed time of no tile's kernel = 36.8559ms
[1] elapsed time of no tile's spmm:36.9234
[0] elapsed time of no tile's kernel = 881.037ms
[0] elapsed time of no tile's spmm:881.111
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00097
[0] elapsed time of no tile's kernel = 37.419ms
[0] elapsed time of no tile's spmm:37.4765
[1] Time of propagate(ms): 323.2067229691893
[1] Time of add_bias(ms): 16.230632085353136
[1] Time of 1 dist conv forward(ms): 365.00811111181974
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 1, loss: 2.018017053604126
[1] $$$$
[1] Time of prepare send data(ms): 9.467105148360133
[1] Time of prepare recv data(ms): 0.0004370231181383133
[1] Time of barrier (all to all)(ms): 3.209174843505025
[1] Time of comm data (all to all)(ms): 12.579732108861208
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.028556911274790764
[1] Time of comm_forward(ms): 28.76292006112635
[1] Time of local aggregate(ms): 791.4906919468194
[1] Time of async wait(ms): 0.011863885447382927
[1] Time of remote aggregate(ms): 37.25448600016534
[1] Time of sum up message(ms): 0.0006700865924358368
[1] Time of 1 dist conv forward(inner)(ms): 857.5491888914257
[1] #########
[1] Time of propagate(inner)(ms) = 857.6731239445508
[1] **************
[1] Time of linear(ms): 54.020937997847795
[1] Time of propagate(ms): 857.6913438737392
[1] Time of add_bias(ms): 74.44237521849573
[1] Time of 1 dist conv forward(ms): 986.1560009885579
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 989.4628
[1] Time of relu(ms): 50.0951
[1] Time of dropout(ms): 195.2703
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.328811895102262
[1] Time of prepare recv data(ms): 0.0003681052476167679
[1] Time of barrier (all to all)(ms): 166.08039406128228
[1] Time of comm data (all to all)(ms): 12.195894960314035
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02902187407016754
[1] Time of comm_forward(ms): 191.17244612425566
[1] Time of local aggregate(ms): 794.5337549317628
[1] Time of async wait(ms): 0.012374017387628555
[1] Time of remote aggregate(ms): 37.36866801045835
[1] Time of sum up message(ms): 0.0009420327842235565
[1] Time of 1 dist conv forward(inner)(ms): 1023.1172069907188
[1] #########
[1] Time of propagate(inner)(ms) = 1023.2376591302454
[1] **************
[1] Time of linear(ms): 99.73163809627295
[1] Time of propagate(ms): 1023.2550029177219
[1] Time of add_bias(ms): 74.20843211002648
[1] Time of 1 dist conv forward(ms): 1197.1977080684155
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1200.5629
[1] Time of relu(ms): 51.1279
[1] Time of dropout(ms): 195.5238
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1476258989423513
[1] Time of prepare recv data(ms): 0.00033993273973464966
[1] Time of barrier (all to all)(ms): 157.10705798119307
[1] Time of comm data (all to all)(ms): 12.265087105333805
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03148196265101433
[1] Time of comm_forward(ms): 172.127075958997
[1] Time of local aggregate(ms): 147.25738298147917
[1] Time of async wait(ms): 0.012974021956324577
[1] Time of remote aggregate(ms): 7.775486912578344
[1] Time of sum up message(ms): 0.0008370261639356613
[1] Time of 1 dist conv forward(inner)(ms): 327.2052388638258
[1] #########
[1] Time of propagate(inner)(ms) = 327.3300000000745
[1] **************
[1] Time of linear(ms): 24.511430878192186
[1] Time of propagate(ms): 327.3494499735534
[1] Time of add_bias(ms): 15.000652987509966
[1] Time of 1 dist conv forward(ms): 366.8637960217893
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 2, loss: 1.3117194175720215
[1] $$$$
[1] Time of prepare send data(ms): 9.432173101231456
[1] Time of prepare recv data(ms): 0.0003420282155275345
[1] Time of barrier (all to all)(ms): 4.8501628916710615
[1] Time of comm data (all to all)(ms): 12.427894165739417
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02840091474354267
[1] Time of comm_forward(ms): 30.219329986721277
[1] Time of local aggregate(ms): 780.5447110440582
[1] Time of async wait(ms): 0.011585885658860207
[1] Time of remote aggregate(ms): 37.463373970240355
[1] Time of sum up message(ms): 0.0008139759302139282
[1] Time of 1 dist conv forward(inner)(ms): 848.2682157773525
[1] #########
[1] Time of propagate(inner)(ms) = 848.4013590496033
[1] **************
[1] Time of linear(ms): 53.79784991964698
[1] Time of propagate(ms): 848.4199920203537
[1] Time of add_bias(ms): 74.1834039799869
[1] Time of 1 dist conv forward(ms): 976.4024859759957
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 979.6346
[1] Time of relu(ms): 50.9399
[1] Time of dropout(ms): 194.6571
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.278146084398031
[1] Time of prepare recv data(ms): 0.0004959292709827423
[1] Time of barrier (all to all)(ms): 173.72277611866593
[1] Time of comm data (all to all)(ms): 12.660692911595106
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.0281650573015213
[1] Time of comm_forward(ms): 199.20289609581232
[1] Time of local aggregate(ms): 781.5438348334283
[1] Time of async wait(ms): 0.01268112100660801
[1] Time of remote aggregate(ms): 37.25269087590277
[1] Time of sum up message(ms): 0.0007969792932271957
[1] Time of 1 dist conv forward(inner)(ms): 1018.0410649627447
[1] #########
[1] Time of propagate(inner)(ms) = 1018.1592989247292
[1] **************
[1] Time of linear(ms): 99.55103904940188
[1] Time of propagate(ms): 1018.1901240721345
[1] Time of add_bias(ms): 74.37134301289916
[1] Time of 1 dist conv forward(ms): 1192.11480114609
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1195.3848
[1] Time of relu(ms): 51.4415
[1] Time of dropout(ms): 195.7770
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.0921078976243734
[1] Time of prepare recv data(ms): 0.0002491287887096405
[1] Time of barrier (all to all)(ms): 161.58433794043958
[1] Time of comm data (all to all)(ms): 12.955337995663285
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029112910851836205
[1] Time of comm_forward(ms): 177.34895506873727
[1] Time of local aggregate(ms): 147.04961492680013
[1] Time of async wait(ms): 0.012483913451433182
[1] Time of remote aggregate(ms): 7.665066048502922
[1] Time of sum up message(ms): 0.0007720664143562317
[1] Time of 1 dist conv forward(inner)(ms): 332.10600493475795
[1] #########
[1] Time of propagate(inner)(ms) = 332.2436979506165
[1] **************
[1] Time of linear(ms): 25.728896958753467
[1] Time of propagate(ms): 332.26061798632145
[1] Time of add_bias(ms): 15.542790060862899
[1] Time of 1 dist conv forward(ms): 373.53512714616954
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 3, loss: 1.1515625715255737
[1] $$$$
[1] Time of prepare send data(ms): 9.45915188640356
[1] Time of prepare recv data(ms): 0.0002470333129167557
[1] Time of barrier (all to all)(ms): 1.965831033885479
[1] Time of comm data (all to all)(ms): 12.289315927773714
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029256101697683334
[1] Time of comm_forward(ms): 27.20105298794806
[1] Time of local aggregate(ms): 785.936706000939
[1] Time of async wait(ms): 0.01146993599832058
[1] Time of remote aggregate(ms): 37.38731611520052
[1] Time of sum up message(ms): 0.0007159542292356491
[1] Time of 1 dist conv forward(inner)(ms): 850.5665170960128
[1] #########
[1] Time of propagate(inner)(ms) = 850.6789118982852
[1] **************
[1] Time of linear(ms): 54.135858081281185
[1] Time of propagate(ms): 850.6966780405492
[1] Time of add_bias(ms): 75.29563992284238
[1] Time of 1 dist conv forward(ms): 980.1295790821314
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 983.4940
[1] Time of relu(ms): 51.0095
[1] Time of dropout(ms): 195.4870
[1] ----------------------------------------
[1] $$$$
[0] Time of add_bias(ms): 14.314485946670175
[0] Time of 1 dist conv forward(ms): 242.83567303791642
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 1, loss: 3.2579734325408936
[0] $$$$
[0] Time of prepare send data(ms): 11.145821074023843
[0] Time of prepare recv data(ms): 0.00026100315153598785
[0] Time of barrier (all to all)(ms): 0.3025839105248451
[0] Time of comm data (all to all)(ms): 12.820476200431585
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030281953513622284
[0] Time of comm_forward(ms): 28.51256402209401
[0] Time of local aggregate(ms): 942.0592680107802
[0] Time of async wait(ms): 0.012907898053526878
[0] Time of remote aggregate(ms): 37.760619074106216
[0] Time of sum up message(ms): 0.0006540212780237198
[0] Time of 1 dist conv forward(inner)(ms): 1008.3762949798256
[0] #########
[0] Time of propagate(inner)(ms) = 1008.4886620752513
[0] **************
[0] Time of linear(ms): 54.38807210884988
[0] Time of propagate(ms): 1008.5046968888491
[0] Time of add_bias(ms): 78.2915661111474
[0] Time of 1 dist conv forward(ms): 1141.1859460640699
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1144.5971
[0] Time of relu(ms): 53.4533
[0] Time of dropout(ms): 198.6077
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 11.101830983534455
[0] Time of prepare recv data(ms): 0.0005450565367937088
[0] Time of barrier (all to all)(ms): 0.2817530184984207
[0] Time of comm data (all to all)(ms): 12.448084075003862
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.028725946322083473
[0] Time of comm_forward(ms): 28.06439413689077
[0] Time of local aggregate(ms): 940.655211918056
[0] Time of async wait(ms): 0.029096147045493126
[0] Time of remote aggregate(ms): 37.924024974927306
[0] Time of sum up message(ms): 0.0008658971637487411
[0] Time of 1 dist conv forward(inner)(ms): 1006.7023190204054
[0] #########
[0] Time of propagate(inner)(ms) = 1006.8200179375708
[0] **************
[0] Time of linear(ms): 101.13419801928103
[0] Time of propagate(ms): 1006.83653797023
[0] Time of add_bias(ms): 77.04908307641745
[0] Time of 1 dist conv forward(ms): 1185.0213010329753
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1188.2108
[0] Time of relu(ms): 53.5991
[0] Time of dropout(ms): 199.8406
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.5140021461993456
[0] Time of prepare recv data(ms): 0.0002759043127298355
[0] Time of barrier (all to all)(ms): 0.3045010380446911
[0] Time of comm data (all to all)(ms): 12.542221928015351
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031360890716314316
[0] Time of comm_forward(ms): 16.138563165441155
[0] Time of local aggregate(ms): 178.82773093879223
[0] Time of async wait(ms): 0.013273907825350761
[0] Time of remote aggregate(ms): 7.72364716976881
[0] Time of sum up message(ms): 0.0008170027285814285
[0] Time of 1 dist conv forward(inner)(ms): 202.73539307527244
[0] #########
[0] Time of propagate(inner)(ms) = 202.84816506318748
[0] **************
[0] Time of linear(ms): 24.33022204786539
[0] Time of propagate(ms): 202.8684939723462
[0] Time of add_bias(ms): 14.319739071652293
[0] Time of 1 dist conv forward(ms): 241.52014800347388
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 2, loss: 2.7994632720947266
[0] $$$$
[0] Time of prepare send data(ms): 11.203961912542582
[0] Time of prepare recv data(ms): 0.00036996789276599884
[0] Time of barrier (all to all)(ms): 0.2764791715890169
[0] Time of comm data (all to all)(ms): 12.661422835662961
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029952963814139366
[0] Time of comm_forward(ms): 28.491018107160926
[0] Time of local aggregate(ms): 938.3799489587545
[0] Time of async wait(ms): 0.012296019122004509
[0] Time of remote aggregate(ms): 37.478235084563494
[0] Time of sum up message(ms): 0.000726897269487381
[0] Time of 1 dist conv forward(inner)(ms): 1004.3921780306846
[0] #########
[0] Time of propagate(inner)(ms) = 1004.505226155743
[0] **************
[0] Time of linear(ms): 55.72087597101927
[0] Time of propagate(ms): 1004.5225359499454
[0] Time of add_bias(ms): 78.03898397833109
[0] Time of 1 dist conv forward(ms): 1138.2836459670216
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1141.6657
[0] Time of relu(ms): 52.0994
[0] Time of dropout(ms): 198.6705
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.85503096692264
[0] Time of prepare recv data(ms): 0.00046403147280216217
[0] Time of barrier (all to all)(ms): 0.27420883998274803
[0] Time of comm data (all to all)(ms): 12.901972979307175
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02922513522207737
[0] Time of comm_forward(ms): 28.37522584013641
[0] Time of local aggregate(ms): 935.9637640882283
[0] Time of async wait(ms): 0.014990102499723434
[0] Time of remote aggregate(ms): 37.70744591020048
[0] Time of sum up message(ms): 0.0007860362529754639
[0] Time of 1 dist conv forward(inner)(ms): 1002.09143711254
[0] #########
[0] Time of propagate(inner)(ms) = 1002.2035948932171
[0] **************
[0] Time of linear(ms): 103.3464870415628
[0] Time of propagate(ms): 1002.2196758072823
[0] Time of add_bias(ms): 76.47625706158578
[0] Time of 1 dist conv forward(ms): 1182.0442138705403
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1185.2560
[0] Time of relu(ms): 52.8926
[0] Time of dropout(ms): 198.8883
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.538858912885189
[0] Time of prepare recv data(ms): 0.0002591405063867569
[0] Time of barrier (all to all)(ms): 0.28817798011004925
[0] Time of comm data (all to all)(ms): 12.2285399120301
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031561125069856644
[0] Time of comm_forward(ms): 15.840854961425066
[0] Time of local aggregate(ms): 182.88173084147274
[0] Time of async wait(ms): 0.01569511368870735
[0] Time of remote aggregate(ms): 7.761976914480329
[0] Time of sum up message(ms): 0.0008530914783477783
[0] Time of 1 dist conv forward(inner)(ms): 206.53267204761505
[0] #########
[0] Time of propagate(inner)(ms) = 206.65917196311057
[0] **************
[0] Time of linear(ms): 24.795431178063154
[0] Time of propagate(ms): 206.67580678127706
[0] Time of add_bias(ms): 14.46460303850472
[0] Time of 1 dist conv forward(ms): 245.93755789101124
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 3, loss: 2.1804583072662354
[0] $$$$
[0] Time of prepare send data(ms): 11.205443879589438
[0] Time of prepare recv data(ms): 0.0005480833351612091
[0] Time of barrier (all to all)(ms): 0.26177498511970043
[0] Time of comm data (all to all)(ms): 12.612874154001474
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02967403270304203
[0] Time of comm_forward(ms): 28.323510894551873
[0] Time of local aggregate(ms): 936.5188181400299
[0] Time of async wait(ms): 0.012341886758804321
[0] Time of remote aggregate(ms): 37.90680505335331
[0] Time of sum up message(ms): 0.0008409842848777771
[0] Time of 1 dist conv forward(inner)(ms): 1002.7919909916818
[0] #########
[0] Time of propagate(inner)(ms) = 1002.9136559460312
[0] **************
[0] Time of linear(ms): 54.50018704868853
[0] Time of propagate(ms): 1002.9290898237377
[0] Time of add_bias(ms): 77.46831816621125
[0] Time of 1 dist conv forward(ms): 1134.8990490660071
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1138.2986
[0] Time of relu(ms): 52.7461
[0] Time of dropout(ms): 199.6947
[0] ----------------------------------------
[0] $$$$
[1] elapsed time of allocating memory (spmm on forward): 0.001255
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001127
[1] elapsed time of no tile's kernel = 733.387ms
[1] elapsed time of no tile's spmm:733.455
[1] elapsed time of allocating memory (spmm on forward): [1] 0.0009
[1] elapsed time of no tile's kernel = [1] 36.6912ms
[1] elapsed time of no tile's spmm:36.7481
[0] elapsed time of no tile's kernel = 877.687ms
[0] elapsed time of no tile's spmm:877.757
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000706
[0] elapsed time of no tile's kernel = [0] 37.4777ms
[0] elapsed time of no tile's spmm:37.5333
[0] elapsed time of allocating memory (spmm on forward): 0.001131
[1] elapsed time of allocating memory (spmm on forward): 0.001125
[1] elapsed time of no tile's kernel = [1] 127.734ms
[1] elapsed time of no tile's spmm:127.802
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001124
[1] elapsed time of no tile's kernel = [1] 7.21364ms
[1] elapsed time of no tile's spmm:7.27014
[0] elapsed time of no tile's kernel = [0] 166.033ms
[0] elapsed time of no tile's spmm:166.116
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000592
[0] elapsed time of no tile's kernel = [0] 7.19073ms
[0] elapsed time of no tile's spmm:7.24138
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000945
[1] elapsed time of no tile's kernel = [1] 3.8304ms
[1] elapsed time of no tile's spmm:3.89304
[1] elapsed time of allocating memory (spmm on forward): 0.00085
[0] elapsed time of allocating memory (spmm on forward): 0.001239
[0] elapsed time of no tile's kernel = 3.85551ms
[0] elapsed time of no tile's spmm:3.91576
[0] elapsed time of allocating memory (spmm on forward): 0.000895
[1] elapsed time of no tile's kernel = 150.833ms[1] 
[1] elapsed time of no tile's spmm:150.897
[0] elapsed time of no tile's kernel = 166.31ms
[0] elapsed time of no tile's spmm:166.384
[1] elapsed time of allocating memory (spmm on forward): 0.001385
[1] elapsed time of no tile's kernel = 20.1079ms
[1] elapsed time of no tile's spmm:20.1699
[0] elapsed time of allocating memory (spmm on forward): 0.001137
[1] elapsed time of allocating memory (spmm on forward): 0.001511
[0] elapsed time of no tile's kernel = 19.9922ms
[0] elapsed time of no tile's spmm:20.0595
[0] elapsed time of allocating memory (spmm on forward): 0.00103
[1] elapsed time of no tile's kernel = 767.246ms[1] 
[1] elapsed time of no tile's spmm:767.313
[0] elapsed time of no tile's kernel = 883.373ms
[0] elapsed time of no tile's spmm:883.447
[1] elapsed time of allocating memory (spmm on forward): 0.00131
[1] elapsed time of no tile's kernel = 20.0206ms
[1] elapsed time of no tile's spmm:20.0869
[1] elapsed time of allocating memory (spmm on forward): 0.001553
[0] elapsed time of allocating memory (spmm on forward): 0.001218
[0] elapsed time of no tile's kernel = 20.0569ms
[0] elapsed time of no tile's spmm:20.1235
[0] elapsed time of allocating memory (spmm on forward): 0.000841
[1] elapsed time of no tile's kernel = 824.308ms
[1] elapsed time of no tile's spmm:824.374
[0] elapsed time of no tile's kernel = 886.598ms
[0] elapsed time of no tile's spmm:886.669
[1] elapsed time of allocating memory (spmm on forward): 0.001023
[0] elapsed time of allocating memory (spmm on forward): 0.000882
[1] elapsed time of no tile's kernel = 730.581ms
[1] elapsed time of no tile's spmm:730.661
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000694
[1] elapsed time of no tile's kernel = [1] 36.9909ms
[1] elapsed time of no tile's spmm:37.0467
[0] elapsed time of no tile's kernel = 887.724ms[0] 
[0] elapsed time of no tile's spmm:887.795
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000987
[0] elapsed time of no tile's kernel = 37.3325ms
[0] elapsed time of no tile's spmm:37.3886
[1] elapsed time of allocating memory (spmm on forward): 0.001324
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001011
[1] elapsed time of no tile's kernel = 732.552ms
[1] elapsed time of no tile's spmm:732.627
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000881
[1] elapsed time of no tile's kernel = [1] 36.934ms
[1] elapsed time of no tile's spmm:36.9898
[0] elapsed time of no tile's kernel = 880.973ms
[0] elapsed time of no tile's spmm:881.042
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000802
[0] elapsed time of no tile's kernel = [0] 37.2092ms
[0] elapsed time of no tile's spmm:37.2674
[0] elapsed time of allocating memory (spmm on forward): 0.001439
[1] elapsed time of allocating memory (spmm on forward): 0.000968
[1] elapsed time of no tile's kernel = 127.914ms
[1] elapsed time of no tile's spmm:127.981
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000713
[1] elapsed time of no tile's kernel = 7.2113[1] ms
[1] elapsed time of no tile's spmm:7.26728
[0] elapsed time of no tile's kernel = 161.328ms
[0] elapsed time of no tile's spmm:161.393
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000701
[0] elapsed time of no tile's kernel = [0] 7.20619ms
[0] elapsed time of no tile's spmm:7.25711
[1] elapsed time of allocating memory (spmm on forward): 0.001331
[1] elapsed time of no tile's kernel = 3.79469ms
[1] elapsed time of no tile's spmm:3.85109
[1] elapsed time of allocating memory (spmm on forward): 0.000926
[0] elapsed time of allocating memory (spmm on forward): 0.000964[0] 
[0] elapsed time of no tile's kernel = 3.87249ms
[0] elapsed time of no tile's spmm:3.92972[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.001059
[1] elapsed time of no tile's kernel = 149.921ms
[1] elapsed time of no tile's spmm:149.985
[0] elapsed time of no tile's kernel = 164.547ms
[0] elapsed time of no tile's spmm:164.606
[1] elapsed time of allocating memory (spmm on forward): 0.001247
[1] elapsed time of no tile's kernel = 20.0942ms
[1] elapsed time of no tile's spmm:20.1596
[0] elapsed time of allocating memory (spmm on forward): 0.001047[0] 
[0] elapsed time of no tile's kernel = 20.0061ms
[0] elapsed time of no tile's spmm:[0] 20.0798
[1] elapsed time of allocating memory (spmm on forward): 0.00122
[0] elapsed time of allocating memory (spmm on forward): 0.001333
[1] elapsed time of no tile's kernel = 766.759ms
[1] elapsed time of no tile's spmm:766.826
[0] elapsed time of no tile's kernel = 892.341ms
[0] elapsed time of no tile's spmm:892.414
[1] elapsed time of allocating memory (spmm on forward): 0.001178
[1] elapsed time of no tile's kernel = 19.9265ms
[1] elapsed time of no tile's spmm:19.9926
[1] elapsed time of allocating memory (spmm on forward): 0.001003
[0] elapsed time of allocating memory (spmm on forward): 0.000964
[0] elapsed time of no tile's kernel = 20.0992ms
[0] elapsed time of no tile's spmm:20.1653
[0] elapsed time of allocating memory (spmm on forward): 0.001193
[1] elapsed time of no tile's kernel = 825.297ms
[1] elapsed time of no tile's spmm:825.363
[0] elapsed time of no tile's kernel = 883.927ms
[0] elapsed time of no tile's spmm:884.017
[1] elapsed time of allocating memory (spmm on forward): 0.000893
[0] elapsed time of allocating memory (spmm on forward): 0.000898
[1] elapsed time of no tile's kernel = 729.21ms
[1] elapsed time of no tile's spmm:729.279
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000805
[1] elapsed time of no tile's kernel = [1] 37.0577ms
[1] elapsed time of no tile's spmm:37.1162
[0] elapsed time of no tile's kernel = 883.155ms
[0] elapsed time of no tile's spmm:883.227
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001005
[0] elapsed time of no tile's kernel = 37.4929ms
[0] elapsed time of no tile's spmm:37.5548
[1] elapsed time of allocating memory (spmm on forward): 0.001119
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001041
[1] elapsed time of no tile's kernel = 732.65ms
[1] elapsed time of no tile's spmm:732.716
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000805
[1] elapsed time of no tile's kernel = 36.701[1] ms
[1] elapsed time of no tile's spmm:36.7562
[0] elapsed time of no tile's kernel = 881.879ms
[0] elapsed time of no tile's spmm:881.961
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000634
[0] elapsed time of no tile's kernel = 37.2919ms
[0] elapsed time of no tile's spmm:37.349
[0] elapsed time of allocating memory (spmm on forward): 0.001097
[1] elapsed time of allocating memory (spmm on forward): 0.001158
[1] elapsed time of no tile's kernel = 127.96ms
[1] elapsed time of no tile's spmm:128.024
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000916
[1] elapsed time of no tile's kernel = 7.18499ms[1] 
[1] elapsed time of no tile's spmm:7.23962
[1] Time of prepare send data(ms): 9.322713129222393
[1] Time of prepare recv data(ms): 0.0006689224392175674
[1] Time of barrier (all to all)(ms): 165.1679261121899
[1] Time of comm data (all to all)(ms): 12.774837901815772
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.031800009310245514
[1] Time of comm_forward(ms): 190.85812801495194
[1] Time of local aggregate(ms): 788.0125020164996
[1] Time of async wait(ms): 0.011629890650510788
[1] Time of remote aggregate(ms): 37.192801013588905
[1] Time of sum up message(ms): 0.0010041985660791397
[1] Time of 1 dist conv forward(inner)(ms): 1016.1078651435673
[1] #########
[1] Time of propagate(inner)(ms) = 1016.2420989945531
[1] **************
[1] Time of linear(ms): 99.47310108691454
[1] Time of propagate(ms): 1016.2597978487611
[1] Time of add_bias(ms): 75.14306902885437
[1] Time of 1 dist conv forward(ms): 1190.8783819526434
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1194.2315
[1] Time of relu(ms): 50.6035
[1] Time of dropout(ms): 195.2203
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.10475898347795
[1] Time of prepare recv data(ms): 0.0006458722054958344
[1] Time of barrier (all to all)(ms): 156.71455604024231
[1] Time of comm data (all to all)(ms): 13.075059046968818
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030193012207746506
[1] Time of comm_forward(ms): 172.516762977466
[1] Time of local aggregate(ms): 147.21252000890672
[1] Time of async wait(ms): 0.029490096494555473
[1] Time of remote aggregate(ms): 7.700728019699454
[1] Time of sum up message(ms): 0.0012919772416353226
[1] Time of 1 dist conv forward(inner)(ms): 327.4909860920161
[1] #########
[1] Time of propagate(inner)(ms) = 327.62950100004673
[1] **************
[1] Time of linear(ms): 24.67826590873301
[1] Time of propagate(ms): 327.6442850474268
[1] Time of add_bias(ms): 15.579537954181433
[1] Time of 1 dist conv forward(ms): 367.9042188450694
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 4, loss: 0.8774119019508362
[1] $$$$
[1] Time of prepare send data(ms): 9.412308922037482
[1] Time of prepare recv data(ms): 0.0005611218512058258
[1] Time of barrier (all to all)(ms): 3.1757529359310865
[1] Time of comm data (all to all)(ms): 12.752881040796638
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029169023036956787
[1] Time of comm_forward(ms): 28.903190046548843
[1] Time of local aggregate(ms): 784.8839608486742
[1] Time of async wait(ms): 0.011865049600601196
[1] Time of remote aggregate(ms): 37.470109993591905
[1] Time of sum up message(ms): 0.0008190982043743134
[1] Time of 1 dist conv forward(inner)(ms): 851.2991140596569
[1] #########
[1] Time of propagate(inner)(ms) = 851.4256950002164
[1] **************
[1] Time of linear(ms): 54.103546077385545
[1] Time of propagate(ms): 851.4454558026046
[1] Time of add_bias(ms): 74.2491811979562
[1] Time of 1 dist conv forward(ms): 979.7993751708418
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 983.1424
[1] Time of relu(ms): 50.7471
[1] Time of dropout(ms): 195.4032
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.31081105954945
[1] Time of prepare recv data(ms): 0.0005799811333417892
[1] Time of barrier (all to all)(ms): 172.26326395757496
[1] Time of comm data (all to all)(ms): 12.826602905988693
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03160885535180569
[1] Time of comm_forward(ms): 197.96736212447286
[1] Time of local aggregate(ms): 787.1604349929839
[1] Time of async wait(ms): 0.012756092473864555
[1] Time of remote aggregate(ms): 37.40979288704693
[1] Time of sum up message(ms): 0.0008479692041873932
[1] Time of 1 dist conv forward(inner)(ms): 1022.5828029215336
[1] #########
[1] Time of propagate(inner)(ms) = 1022.7189010474831
[1] **************
[1] Time of linear(ms): 99.69396912492812
[1] Time of propagate(ms): 1022.7365279570222
[1] Time of add_bias(ms): 74.40075394697487
[1] Time of 1 dist conv forward(ms): 1196.8338550068438
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1200.2038
[1] Time of relu(ms): 50.9750
[1] Time of dropout(ms): 195.9277
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.150648972019553
[1] Time of prepare recv data(ms): 0.0003180466592311859
[1] Time of barrier (all to all)(ms): 158.2732719834894
[1] Time of comm data (all to all)(ms): 12.511668028309941
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.028788810595870018
[1] Time of comm_forward(ms): 173.62728505395353
[1] Time of local aggregate(ms): 152.38518710248172
[1] Time of async wait(ms): 0.011700903996825218
[1] Time of remote aggregate(ms): 7.703083101660013
[1] Time of sum up message(ms): 0.0006738118827342987
[1] Time of 1 dist conv forward(inner)(ms): 333.7567187845707
[1] #########
[1] Time of propagate(inner)(ms) = 333.87917396612465
[1] **************
[1] Time of linear(ms): 25.88012395426631
[1] Time of propagate(ms): 333.8982150889933
[1] Time of add_bias(ms): 15.669187996536493
[1] Time of 1 dist conv forward(ms): 375.4496299661696
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 5, loss: 0.6193291544914246
[1] $$$$
[1] Time of prepare send data(ms): 9.415135020390153
[1] Time of prepare recv data(ms): 0.00025890767574310303
[1] Time of barrier (all to all)(ms): 3.383341943845153
[1] Time of comm data (all to all)(ms): 12.740408070385456
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029264017939567566
[1] Time of comm_forward(ms): 29.106209985911846
[1] Time of local aggregate(ms): 783.47795503214
[1] Time of async wait(ms): 0.011893920600414276
[1] Time of remote aggregate(ms): 37.54144301638007
[1] Time of sum up message(ms): 0.001259148120880127
[1] Time of 1 dist conv forward(inner)(ms): 850.1680251210928
[1] #########
[1] Time of propagate(inner)(ms) = 850.2984601072967
[1] **************
[1] Time of linear(ms): 54.12979982793331
[1] Time of propagate(ms): 850.3162891138345
[1] Time of add_bias(ms): 73.67406692355871
[1] Time of 1 dist conv forward(ms): 978.121911874041
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 981.5037
[1] Time of relu(ms): 50.4093
[1] Time of dropout(ms): 195.1048
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.34480200521648
[1] Time of prepare recv data(ms): 0.0005830079317092896
[1] Time of barrier (all to all)(ms): 169.04302313923836
[1] Time of comm data (all to all)(ms): 12.402087915688753
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02932688221335411
[1] Time of comm_forward(ms): 194.33601899072528
[1] Time of local aggregate(ms): 787.1871469542384
[1] Time of async wait(ms): 0.013004988431930542
[1] Time of remote aggregate(ms): 37.19254699535668
[1] Time of sum up message(ms): 0.0011320225894451141
[1] Time of 1 dist conv forward(inner)(ms): 1018.7591768335551
[1] #########
[1] Time of propagate(inner)(ms) = 1018.8878530170768
[1] **************
[1] Time of linear(ms): 99.83136598020792
[1] Time of propagate(ms): 1018.9064450096339
[1] Time of add_bias(ms): 73.9069760311395
[1] Time of 1 dist conv forward(ms): 1192.6473849453032
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1195.9854
[1] Time of relu(ms): 50.6303
[1] Time of dropout(ms): 194.9940
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1137178409844637
[1] Time of prepare recv data(ms): 0.0006509944796562195
[1] Time of barrier (all to all)(ms): 164.19925214722753
[1] Time of comm data (all to all)(ms): 12.81486195512116
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030847033485770226
[1] Time of comm_forward(ms): 179.76279207505286
[0] elapsed time of no tile's kernel = [0] 161.165ms
[0] elapsed time of no tile's spmm:161.235
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000671
[0] elapsed time of no tile's kernel = 7.16418ms
[0] elapsed time of no tile's spmm:7.22498
[0] Time of prepare send data(ms): 11.043044971302152
[0] Time of prepare recv data(ms): 0.0005778856575489044
[0] Time of barrier (all to all)(ms): 0.2758360933512449
[0] Time of comm data (all to all)(ms): 13.02884891629219
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03969506360590458
[0] Time of comm_forward(ms): 28.872010065242648
[0] Time of local aggregate(ms): 933.5531978867948
[0] Time of async wait(ms): 0.028630951419472694
[0] Time of remote aggregate(ms): 37.94334316626191
[0] Time of sum up message(ms): 0.0007029157131910324
[0] Time of 1 dist conv forward(inner)(ms): 1000.4375800490379
[0] #########
[0] Time of propagate(inner)(ms) = 1000.5555681418628
[0] **************
[0] Time of linear(ms): 102.20437287352979
[0] Time of propagate(ms): 1000.5704259965569
[0] Time of add_bias(ms): 76.816103188321
[0] Time of 1 dist conv forward(ms): 1179.5928091742098
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1182.8335
[0] Time of relu(ms): 52.3625
[0] Time of dropout(ms): 201.4973
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.541795140132308
[0] Time of prepare recv data(ms): 0.0004728790372610092
[0] Time of barrier (all to all)(ms): 0.29237917624413967
[0] Time of comm data (all to all)(ms): 12.317457003518939
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032115960493683815
[0] Time of comm_forward(ms): 15.927835134789348
[0] Time of local aggregate(ms): 184.54150296747684
[0] Time of async wait(ms): 0.012563075870275497
[0] Time of remote aggregate(ms): 7.656057830899954
[0] Time of sum up message(ms): 0.0007019843906164169
[0] Time of 1 dist conv forward(inner)(ms): 208.17077695392072
[0] #########
[0] Time of propagate(inner)(ms) = 208.2836648914963
[0] **************
[0] Time of linear(ms): 24.351313011720777
[0] Time of propagate(ms): 208.29822891391814
[0] Time of add_bias(ms): 14.387218048796058
[0] Time of 1 dist conv forward(ms): 247.03806405887008
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 4, loss: 1.9948385953903198
[0] $$$$
[0] Time of prepare send data(ms): 11.221748078241944
[0] Time of prepare recv data(ms): 0.00026402994990348816
[0] Time of barrier (all to all)(ms): 0.2763899974524975
[0] Time of comm data (all to all)(ms): 13.019908918067813
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03053806722164154
[0] Time of comm_forward(ms): 28.77960097976029
[0] Time of local aggregate(ms): 943.2915858924389
[0] Time of async wait(ms): 0.012908130884170532
[0] Time of remote aggregate(ms): 37.79690689407289
[0] Time of sum up message(ms): 0.001043081283569336
[0] Time of 1 dist conv forward(inner)(ms): 1009.9125830456614
[0] #########
[0] Time of propagate(inner)(ms) = 1010.0319518242031
[0] **************
[0] Time of linear(ms): 54.35766605660319
[0] Time of propagate(ms): 1010.0476979278028
[0] Time of add_bias(ms): 77.87254708819091
[0] Time of 1 dist conv forward(ms): 1142.27963401936
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1145.6774
[0] Time of relu(ms): 53.1141
[0] Time of dropout(ms): 198.3617
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.896196821704507
[0] Time of prepare recv data(ms): 0.0003220047801733017
[0] Time of barrier (all to all)(ms): 0.3139059990644455
[0] Time of comm data (all to all)(ms): 13.081771088764071
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029613962396979332
[0] Time of comm_forward(ms): 28.530929004773498
[0] Time of local aggregate(ms): 936.8767940904945
[0] Time of async wait(ms): 0.013046897947788239
[0] Time of remote aggregate(ms): 37.690743105486035
[0] Time of sum up message(ms): 0.000726897269487381
[0] Time of 1 dist conv forward(inner)(ms): 1003.1418539583683
[0] #########
[0] Time of propagate(inner)(ms) = 1003.2571139745414
[0] **************
[0] Time of linear(ms): 101.39797697775066
[0] Time of propagate(ms): 1003.2713778782636
[0] Time of add_bias(ms): 77.11998606100678
[0] Time of 1 dist conv forward(ms): 1181.7908980883658
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1184.9967
[0] Time of relu(ms): 53.0942
[0] Time of dropout(ms): 199.5026
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.495194086804986
[0] Time of prepare recv data(ms): 0.0002470333129167557
[0] Time of barrier (all to all)(ms): 0.2857919316738844
[0] Time of comm data (all to all)(ms): 12.767525156959891
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.032111071050167084
[0] Time of comm_forward(ms): 16.3313418161124
[0] Time of local aggregate(ms): 184.79346297681332
[0] Time of async wait(ms): 0.011499039828777313
[0] Time of remote aggregate(ms): 7.655484136193991
[0] Time of sum up message(ms): 0.0007208436727523804
[0] Time of 1 dist conv forward(inner)(ms): 208.8246198836714
[0] #########
[0] Time of propagate(inner)(ms) = 208.9385490398854
[0] **************
[0] Time of linear(ms): 24.939465802162886
[0] Time of propagate(ms): 208.95642298273742
[0] Time of add_bias(ms): 14.433150179684162
[0] Time of 1 dist conv forward(ms): 248.33074398338795
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 5, loss: 1.7576215267181396
[0] $$$$
[0] Time of prepare send data(ms): 11.23167504556477
[0] Time of prepare recv data(ms): 0.000417931005358696
[0] Time of barrier (all to all)(ms): 0.31462893821299076
[0] Time of comm data (all to all)(ms): 12.974142096936703
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03017392009496689
[0] Time of comm_forward(ms): 28.771833050996065
[0] Time of local aggregate(ms): 938.5466240346432
[0] Time of async wait(ms): 0.012357952073216438
[0] Time of remote aggregate(ms): 37.973660975694656
[0] Time of sum up message(ms): 0.0007511116564273834
[0] Time of 1 dist conv forward(inner)(ms): 1005.3354010451585
[0] #########
[0] Time of propagate(inner)(ms) = 1005.4500699043274
[0] **************
[0] Time of linear(ms): 54.4667299836874
[0] Time of propagate(ms): 1005.4681089241058
[0] Time of add_bias(ms): 77.56113214418292
[0] Time of 1 dist conv forward(ms): 1137.4972970224917
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1141.0637
[0] Time of relu(ms): 52.5379
[0] Time of dropout(ms): 198.0792
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.930693009868264
[0] Time of prepare recv data(ms): 0.00034295953810214996
[0] Time of barrier (all to all)(ms): 0.261697918176651
[0] Time of comm data (all to all)(ms): 12.64654309488833
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029455171898007393
[0] Time of comm_forward(ms): 28.060948941856623
[0] Time of local aggregate(ms): 937.9820469766855
[0] Time of async wait(ms): 0.030111055821180344
[0] Time of remote aggregate(ms): 37.76175784878433
[0] Time of sum up message(ms): 0.0007711350917816162
[0] Time of 1 dist conv forward(inner)(ms): 1003.8650911301374
[0] #########
[0] Time of propagate(inner)(ms) = 1003.9790798909962
[0] **************
[0] Time of linear(ms): 101.4488898217678
[0] Time of propagate(ms): 1003.995014121756
[0] Time of add_bias(ms): 77.25434401072562
[0] Time of 1 dist conv forward(ms): 1182.6997899916023
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1185.9208
[0] Time of relu(ms): 52.7256
[0] Time of dropout(ms): 201.8781
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.509824000298977
[0] Time of prepare recv data(ms): 0.000341096892952919
[0] Time of barrier (all to all)(ms): 0.2719028852880001
[0] Time of comm data (all to all)(ms): 13.097483199089766
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.031131086871027946
[0] Time of comm_forward(ms): 16.687704948708415
[1] elapsed time of allocating memory (spmm on forward): 0.00108
[1] elapsed time of no tile's kernel = 3.8565ms
[1] elapsed time of no tile's spmm:3.92476
[1] elapsed time of allocating memory (spmm on forward): 0.001102
[0] elapsed time of allocating memory (spmm on forward): 0.001011
[0] elapsed time of no tile's kernel = 3.85246ms
[0] elapsed time of no tile's spmm:3.91049[0] 
[0] elapsed time of allocating memory (spmm on forward): 0.001121
[1] elapsed time of no tile's kernel = 150.643ms
[1] elapsed time of no tile's spmm:150.702
[0] elapsed time of no tile's kernel = 166.344[0] ms
[0] elapsed time of no tile's spmm:166.426
[1] elapsed time of allocating memory (spmm on forward): 0.001161
[1] elapsed time of no tile's kernel = 20.0998ms
[1] elapsed time of no tile's spmm:20.1655
[0] elapsed time of allocating memory (spmm on forward): 0.000977
[0] elapsed time of no tile's kernel = 19.9479ms
[0] elapsed time of no tile's spmm:20.0114[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001329
[0] elapsed time of allocating memory (spmm on forward): 0.000954
[1] elapsed time of no tile's kernel = [1] 767.629ms
[1] elapsed time of no tile's spmm:767.695
[0] elapsed time of no tile's kernel = 884.77ms
[0] elapsed time of no tile's spmm:884.841
[1] elapsed time of allocating memory (spmm on forward): 0.001109
[1] elapsed time of no tile's kernel = 20.0146ms
[1] elapsed time of no tile's spmm:20.0813
[1] elapsed time of allocating memory (spmm on forward): 0.00144
[0] elapsed time of allocating memory (spmm on forward): 0.000988
[0] elapsed time of no tile's kernel = 20.0652ms
[0] elapsed time of no tile's spmm:20.133
[0] elapsed time of allocating memory (spmm on forward): 0.000871
[1] elapsed time of no tile's kernel = 820.722ms
[1] elapsed time of no tile's spmm:820.812
[0] elapsed time of no tile's kernel = [0] 912.673ms
[0] elapsed time of no tile's spmm:912.767[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.000904
[0] elapsed time of allocating memory (spmm on forward): 0.000825
[1] elapsed time of no tile's kernel = [1] 734.183ms
[1] elapsed time of no tile's spmm:734.247
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000938
[1] elapsed time of no tile's kernel = [1] 37.1229ms
[1] elapsed time of no tile's spmm:37.1803
[0] elapsed time of no tile's kernel = 885.45ms
[0] elapsed time of no tile's spmm:885.536
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000892
[0] elapsed time of no tile's kernel = 37.0436[0] ms
[0] elapsed time of no tile's spmm:37.0992
[1] elapsed time of allocating memory (spmm on forward): 0.002282
[0] elapsed time of allocating memory (spmm on forward): 0.000999
[1] elapsed time of no tile's kernel = 732.576ms
[1] elapsed time of no tile's spmm:732.647
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000839
[1] elapsed time of no tile's kernel = [1] 36.8929ms
[1] elapsed time of no tile's spmm:36.9491
[0] elapsed time of no tile's kernel = 881.37ms
[0] elapsed time of no tile's spmm:881.444
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001233
[0] elapsed time of no tile's kernel = [0] 37.2322ms
[0] elapsed time of no tile's spmm:37.2893
[0] elapsed time of allocating memory (spmm on forward): 0.001423
[1] elapsed time of allocating memory (spmm on forward): 0.001213
[1] elapsed time of no tile's kernel = 127.929ms
[1] elapsed time of no tile's spmm:[1] 127.989
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000991
[1] elapsed time of no tile's kernel = 7.18694ms
[1] elapsed time of no tile's spmm:7.24031
[0] elapsed time of no tile's kernel = 161.674ms
[0] elapsed time of no tile's spmm:161.738
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00084
[0] elapsed time of no tile's kernel = 7.34493ms
[0] elapsed time of no tile's spmm:7.39666
[1] elapsed time of allocating memory (spmm on forward): 0.001161
[1] elapsed time of no tile's kernel = 3.87888ms
[1] elapsed time of no tile's spmm:3.93623[1] 
[1] elapsed time of allocating memory (spmm on forward): 0.00097
[0] elapsed time of allocating memory (spmm on forward): 0.001021
[0] elapsed time of no tile's kernel = 3.83474ms
[0] elapsed time of no tile's spmm:3.89256
[0] elapsed time of allocating memory (spmm on forward): 0.001016[0] 
[1] elapsed time of no tile's kernel = 151.875ms
[1] elapsed time of no tile's spmm:151.952
[0] elapsed time of no tile's kernel = 165.043ms
[0] elapsed time of no tile's spmm:165.105
[1] elapsed time of allocating memory (spmm on forward): 0.001135
[1] elapsed time of no tile's kernel = 19.952ms
[1] elapsed time of no tile's spmm:20.016
[0] elapsed time of allocating memory (spmm on forward): 0.001214
[0] elapsed time of no tile's kernel = 19.9032ms
[0] elapsed time of no tile's spmm:19.9688[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.000947
[0] elapsed time of allocating memory (spmm on forward): 0.001155
[1] elapsed time of no tile's kernel = 766.212ms
[1] elapsed time of no tile's spmm:766.28
[0] elapsed time of no tile's kernel = 887.187ms
[0] elapsed time of no tile's spmm:887.263
[1] elapsed time of allocating memory (spmm on forward): 0.001096
[1] elapsed time of no tile's kernel = 19.9363ms
[1] elapsed time of no tile's spmm:20
[1] elapsed time of allocating memory (spmm on forward): 0.001245
[0] elapsed time of allocating memory (spmm on forward): 0.001135
[0] elapsed time of no tile's kernel = 20.0423ms
[0] elapsed time of no tile's spmm:20.1076
[0] elapsed time of allocating memory (spmm on forward): 0.001143
[1] elapsed time of no tile's kernel = 823.392ms
[1] elapsed time of no tile's spmm:823.46
[0] elapsed time of no tile's kernel = 890.798ms
[0] elapsed time of no tile's spmm:890.887
[1] elapsed time of allocating memory (spmm on forward): 0.001243
[0] elapsed time of allocating memory (spmm on forward): 0.001283
[1] elapsed time of no tile's kernel = 736.61ms
[1] elapsed time of no tile's spmm:736.694
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000851
[1] elapsed time of no tile's kernel = 37.001[1] ms
[1] elapsed time of no tile's spmm:37.0577
[0] elapsed time of no tile's kernel = 887.341ms
[0] elapsed time of no tile's spmm:887.415
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001088
[0] elapsed time of no tile's kernel = [0] 37.3487ms
[0] elapsed time of no tile's spmm:37.4049
[1] elapsed time of allocating memory (spmm on forward): 0.001147
[0] elapsed time of allocating memory (spmm on forward): 0.000863
[1] elapsed time of no tile's kernel = 732.55ms
[1] elapsed time of no tile's spmm:732.634
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000904
[1] elapsed time of no tile's kernel = [1] 36.9993ms
[1] elapsed time of no tile's spmm:37.0558
[0] elapsed time of no tile's kernel = 880.71ms
[0] elapsed time of no tile's spmm:880.781
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000956
[0] elapsed time of no tile's kernel = [0] 37.1904ms
[0] elapsed time of no tile's spmm:37.2465
[0] elapsed time of allocating memory (spmm on forward): 0.001097
[1] elapsed time of allocating memory (spmm on forward): 0.001007
[1] elapsed time of no tile's kernel = 127.769ms
[1] elapsed time of no tile's spmm:127.829
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000874
[1] elapsed time of no tile's kernel = [1] 7.22024ms
[1] elapsed time of no tile's spmm:7.27398
[0] elapsed time of no tile's kernel = 160.345ms
[0] elapsed time of no tile's spmm:160.408
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000989
[0] elapsed time of no tile's kernel = [0] 7.25431ms[0] 
[0] elapsed time of no tile's spmm:7.30709[0] 
[1] elapsed time of allocating memory (spmm on forward): 0.001091
[1] elapsed time of no tile's kernel = 3.82742ms
[1] elapsed time of no tile's spmm:3.88384[1] 
[1] elapsed time of allocating memory (spmm on forward): 0.001398
[0] elapsed time of allocating memory (spmm on forward): 0.001103
[0] elapsed time of no tile's kernel = 3.84564ms
[0] elapsed time of no tile's spmm:3.90287
[0] elapsed time of allocating memory (spmm on forward): 0.001134
[1] elapsed time of no tile's kernel = 152.039ms
[1] elapsed time of no tile's spmm:152.099
[0] elapsed time of no tile's kernel = 166.242ms
[0] elapsed time of no tile's spmm:166.326
[1] elapsed time of allocating memory (spmm on forward): 0.001087
[1] elapsed time of no tile's kernel = 20.1199ms
[1] elapsed time of no tile's spmm:20.1886
[0] elapsed time of allocating memory (spmm on forward): 0.001057
[0] elapsed time of no tile's kernel = 19.9132ms
[0] elapsed time of no tile's spmm:[0] 19.9772
[1] elapsed time of allocating memory (spmm on forward): 0.00087
[0] elapsed time of allocating memory (spmm on forward): 0.00088
[1] elapsed time of no tile's kernel = 769.225ms
[1] elapsed time of no tile's spmm:769.293
[0] elapsed time of no tile's kernel = 885.499ms
[0] elapsed time of no tile's spmm:885.573
[1] elapsed time of allocating memory (spmm on forward): 0.001163
[1] elapsed time of no tile's kernel = 20.0274ms
[1] elapsed time of no tile's spmm:20.0932
[1] elapsed time of allocating memory (spmm on forward): 0.001242
[0] elapsed time of allocating memory (spmm on forward): 0.001053
[0] elapsed time of no tile's kernel = 20.0507ms
[0] elapsed time of no tile's spmm:20.1202
[0] elapsed time of allocating memory (spmm on forward): 0.000916
[1] elapsed time of no tile's kernel = 825.688ms
[1] elapsed time of no tile's spmm:825.757
[0] elapsed time of no tile's kernel = 887.625ms
[0] elapsed time of no tile's spmm:887.704
[1] elapsed time of allocating memory (spmm on forward): 0.000978
[0] elapsed time of allocating memory (spmm on forward): 0.000891
[1] elapsed time of no tile's kernel = [1] 734.779ms
[1] elapsed time of no tile's spmm:734.843
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000933
[1] elapsed time of no tile's kernel = [1] 37.4259ms
[1] elapsed time of no tile's spmm:37.4823
[1] Time of local aggregate(ms): 147.42618380114436
[1] Time of async wait(ms): 0.012375181540846825
[1] Time of remote aggregate(ms): 7.655290886759758
[1] Time of sum up message(ms): 0.0010640360414981842
[1] Time of 1 dist conv forward(inner)(ms): 334.8885530140251
[1] #########
[1] Time of propagate(inner)(ms) = 335.0536939688027
[1] **************
[1] Time of linear(ms): 24.75585020147264
[1] Time of propagate(ms): 335.06888896226883
[1] Time of add_bias(ms): 15.554379904642701
[1] Time of 1 dist conv forward(ms): 375.3818089608103
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 6, loss: 0.5120753049850464
[1] $$$$
[1] Time of prepare send data(ms): 9.436685126274824
[1] Time of prepare recv data(ms): 0.0003050081431865692
[1] Time of barrier (all to all)(ms): 2.983755897730589
[1] Time of comm data (all to all)(ms): 12.251100968569517
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.031109899282455444
[1] Time of comm_forward(ms): 28.215114027261734
[1] Time of local aggregate(ms): 788.7384230270982
[1] Time of async wait(ms): 0.011958880349993706
[1] Time of remote aggregate(ms): 37.618224043399096
[1] Time of sum up message(ms): 0.0008200295269489288
[1] Time of 1 dist conv forward(inner)(ms): 854.6156499069184
[1] #########
[1] Time of propagate(inner)(ms) = 854.741389863193
[1] **************
[1] Time of linear(ms): 54.30003395304084
[1] Time of propagate(ms): 854.7601990867406
[1] Time of add_bias(ms): 74.5799879077822
[1] Time of 1 dist conv forward(ms): 983.6416409816593
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 987.0046
[1] Time of relu(ms): 50.5173
[1] Time of dropout(ms): 195.1732
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.300498059019446
[1] Time of prepare recv data(ms): 0.0004868488758802414
[1] Time of barrier (all to all)(ms): 167.12058102712035
[1] Time of comm data (all to all)(ms): 12.2314200270921
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.027629081159830093
[1] Time of comm_forward(ms): 192.15963105671108
[1] Time of local aggregate(ms): 787.5124458223581
[1] Time of async wait(ms): 0.012322096154093742
[1] Time of remote aggregate(ms): 37.392351077869534
[1] Time of sum up message(ms): 0.001010950654745102
[1] Time of 1 dist conv forward(inner)(ms): 1017.1053900849074
[1] #########
[1] Time of propagate(inner)(ms) = 1017.2447587829083
[1] **************
[1] Time of linear(ms): 99.60988885723054
[1] Time of propagate(ms): 1017.2740479465574
[1] Time of add_bias(ms): 74.84853104688227
[1] Time of 1 dist conv forward(ms): 1191.7350098956376
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1195.0930
[1] Time of relu(ms): 50.9274
[1] Time of dropout(ms): 195.9615
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.0800710190087557
[1] Time of prepare recv data(ms): 0.0003059394657611847
[1] Time of barrier (all to all)(ms): 158.20490499027073
[1] Time of comm data (all to all)(ms): 13.08417203836143
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03476790152490139
[1] Time of comm_forward(ms): 174.05925504863262
[1] Time of local aggregate(ms): 147.37324509769678
[1] Time of async wait(ms): 0.012450851500034332
[1] Time of remote aggregate(ms): 7.685384945943952
[1] Time of sum up message(ms): 0.0007972121238708496
[1] Time of 1 dist conv forward(inner)(ms): 329.16590105742216
[1] #########
[1] Time of propagate(inner)(ms) = 329.2773710563779
[1] **************
[1] Time of linear(ms): 25.7083079777658
[1] Time of propagate(ms): 329.29398212581873
[1] Time of add_bias(ms): 16.8991528917104
[1] Time of 1 dist conv forward(ms): 371.90338782966137
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 7, loss: 0.46154290437698364
[1] $$$$
[1] Time of prepare send data(ms): 9.478382067754865
[1] Time of prepare recv data(ms): 0.0002230517566204071
[1] Time of barrier (all to all)(ms): 3.170246025547385
[1] Time of comm data (all to all)(ms): 12.895629974082112
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02843397669494152
[1] Time of comm_forward(ms): 29.09484109841287
[1] Time of local aggregate(ms): 790.77681992203
[1] Time of async wait(ms): 0.01137913204729557
[1] Time of remote aggregate(ms): 37.49109897762537
[1] Time of sum up message(ms): 0.001019798219203949
[1] Time of 1 dist conv forward(inner)(ms): 857.4035929050297
[1] #########
[1] Time of propagate(inner)(ms) = 857.5279889628291
[1] **************
[1] Time of linear(ms): 54.06111688353121
[1] Time of propagate(ms): 857.5578739400953
[1] Time of add_bias(ms): 75.81501198001206
[1] Time of 1 dist conv forward(ms): 987.4352780170739
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 990.8126
[1] Time of relu(ms): 50.7950
[1] Time of dropout(ms): 195.5353
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.320794139057398
[1] Time of prepare recv data(ms): 0.0003129243850708008
[1] Time of barrier (all to all)(ms): 163.08685904368758
[1] Time of comm data (all to all)(ms): 12.453031027689576
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029508955776691437
[1] Time of comm_forward(ms): 188.40198800899088
[1] Time of local aggregate(ms): 787.1859620790929
[1] Time of async wait(ms): 0.01309392973780632
[1] Time of remote aggregate(ms): 37.47958899475634
[1] Time of sum up message(ms): 0.0011259689927101135
[1] Time of 1 dist conv forward(inner)(ms): 1013.1112679373473
[1] #########
[1] Time of propagate(inner)(ms) = 1013.2405930198729
[1] **************
[1] Time of linear(ms): 99.58946402184665
[1] Time of propagate(ms): 1013.2583980448544
[1] Time of add_bias(ms): 74.89189901389182
[1] Time of 1 dist conv forward(ms): 1187.7419690135866
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1191.0240
[1] Time of relu(ms): 50.7451
[1] Time of dropout(ms): 195.2509
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.111738082021475
[1] Time of prepare recv data(ms): 0.0003050081431865692
[1] Time of barrier (all to all)(ms): 159.2950460035354
[1] Time of comm data (all to all)(ms): 12.340456014499068
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.03106100484728813
[1] Time of comm_forward(ms): 174.38921495340765
[1] Time of local aggregate(ms): 147.2237571142614
[1] Time of async wait(ms): 0.012346077710390091
[1] Time of remote aggregate(ms): 7.697003893554211
[1] Time of sum up message(ms): 0.0008489005267620087
[1] Time of 1 dist conv forward(inner)(ms): 329.3542319443077
[1] #########
[1] Time of propagate(inner)(ms) = 329.4902369379997
[1] **************
[1] Time of linear(ms): 24.505991954356432
[1] Time of propagate(ms): 329.50648409314454
[1] Time of add_bias(ms): 15.85247809998691
[1] Time of 1 dist conv forward(ms): 369.8675110936165
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 8, loss: 0.44207754731178284
[1] $$$$
[1] Time of prepare send data(ms): 9.409779915586114
[1] Time of prepare recv data(ms): 0.00046403147280216217
[1] Time of barrier (all to all)(ms): 3.1011849641799927
[1] Time of comm data (all to all)(ms): 12.373194098472595
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.05341786891222
[1] Time of comm_forward(ms): 28.486080933362246
[1] Time of local aggregate(ms): 788.9577820897102
[1] Time of async wait(ms): 0.01722504384815693
[1] Time of remote aggregate(ms): 37.88514691404998
[1] Time of sum up message(ms): 0.0009739305824041367
[1] Time of 1 dist conv forward(inner)(ms): 855.4006267804652
[1] #########
[1] Time of propagate(inner)(ms) = 855.5196691304445
[1] **************
[0] elapsed time of no tile's kernel = 882.254ms
[0] elapsed time of no tile's spmm:882.321
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00086
[0] elapsed time of no tile's kernel = 37.0789ms
[0] elapsed time of no tile's spmm:37.1355
[0] Time of local aggregate(ms): 179.63392403908074
[0] Time of async wait(ms): 0.0128219835460186
[0] Time of remote aggregate(ms): 7.61624681763351
[0] Time of sum up message(ms): 0.000800006091594696
[0] Time of 1 dist conv forward(inner)(ms): 203.9826288819313
[0] #########
[0] Time of propagate(inner)(ms) = 204.12985794246197
[0] **************
[0] Time of linear(ms): 24.251220049336553
[0] Time of propagate(ms): 204.14409204386175
[0] Time of add_bias(ms): 14.569299994036555
[0] Time of 1 dist conv forward(ms): 242.9662151262164
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 6, loss: 1.596253752708435
[0] $$$$
[0] Time of prepare send data(ms): 11.073881993070245
[0] Time of prepare recv data(ms): 0.0009390059858560562
[0] Time of barrier (all to all)(ms): 0.27581886388361454
[0] Time of comm data (all to all)(ms): 12.484933948144317
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030979979783296585
[0] Time of comm_forward(ms): 28.10141211375594
[0] Time of local aggregate(ms): 940.9252039622515
[0] Time of async wait(ms): 0.029440969228744507
[0] Time of remote aggregate(ms): 37.50784695148468
[0] Time of sum up message(ms): 0.000684056431055069
[0] Time of 1 dist conv forward(inner)(ms): 1006.5955680329353
[0] #########
[0] Time of propagate(inner)(ms) = 1006.7126709036529
[0] **************
[0] Time of linear(ms): 54.50039519928396
[0] Time of propagate(ms): 1006.728339008987
[0] Time of add_bias(ms): 78.35319195874035
[0] Time of 1 dist conv forward(ms): 1139.5832791458815
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1142.9714
[0] Time of relu(ms): 53.4009
[0] Time of dropout(ms): 198.9068
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 11.09081506729126
[0] Time of prepare recv data(ms): 0.00025704503059387207
[0] Time of barrier (all to all)(ms): 0.2725338563323021
[0] Time of comm data (all to all)(ms): 12.473996030166745
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030121998861432076
[0] Time of comm_forward(ms): 28.095356188714504
[0] Time of local aggregate(ms): 937.1621829923242
[0] Time of async wait(ms): 0.029668910428881645
[0] Time of remote aggregate(ms): 37.69300994463265
[0] Time of sum up message(ms): 0.0007140915840864182
[0] Time of 1 dist conv forward(inner)(ms): 1003.0110541265458
[0] #########
[0] Time of propagate(inner)(ms) = 1003.1439601443708
[0] **************
[0] Time of linear(ms): 101.19663085788488
[0] Time of propagate(ms): 1003.160489955917
[0] Time of add_bias(ms): 77.1273230202496
[0] Time of 1 dist conv forward(ms): 1181.486263871193
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1184.7011
[0] Time of relu(ms): 52.8388
[0] Time of dropout(ms): 199.6956
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.514085965231061
[0] Time of prepare recv data(ms): 0.0002600718289613724
[0] Time of barrier (all to all)(ms): 0.2783820964396
[0] Time of comm data (all to all)(ms): 12.301674811169505
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03158301115036011
[0] Time of comm_forward(ms): 15.92384185642004
[0] Time of local aggregate(ms): 180.12606306001544
[0] Time of async wait(ms): 0.01205899752676487
[0] Time of remote aggregate(ms): 7.788942893967032
[0] Time of sum up message(ms): 0.0008151400834321976
[0] Time of 1 dist conv forward(inner)(ms): 203.88330495916307
[0] #########
[0] Time of propagate(inner)(ms) = 204.0096560958773
[0] **************
[0] Time of linear(ms): 25.050672003999352
[0] Time of propagate(ms): 204.02521709911525
[0] Time of add_bias(ms): 14.599435962736607
[0] Time of 1 dist conv forward(ms): 243.67699795402586
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 7, loss: 1.4665358066558838
[0] $$$$
[0] Time of prepare send data(ms): 11.192962061613798
[0] Time of prepare recv data(ms): 0.0003541354089975357
[0] Time of barrier (all to all)(ms): 0.21919491700828075
[0] Time of comm data (all to all)(ms): 12.157394085079432
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030804891139268875
[0] Time of comm_forward(ms): 27.833529049530625
[0] Time of local aggregate(ms): 943.1757859420031
[0] Time of async wait(ms): 0.03025890327990055
[0] Time of remote aggregate(ms): 37.81845513731241
[0] Time of sum up message(ms): 0.0007080379873514175
[0] Time of 1 dist conv forward(inner)(ms): 1008.8895419612527
[0] #########
[0] Time of propagate(inner)(ms) = 1009.0051670558751
[0] **************
[0] Time of linear(ms): 54.48350706137717
[0] Time of propagate(ms): 1009.0227429755032
[0] Time of add_bias(ms): 78.06586194783449
[0] Time of 1 dist conv forward(ms): 1141.5734158363193
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1145.0126
[0] Time of relu(ms): 52.4016
[0] Time of dropout(ms): 198.4567
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.96340804360807
[0] Time of prepare recv data(ms): 0.00025890767574310303
[0] Time of barrier (all to all)(ms): 0.30032522045075893
[0] Time of comm data (all to all)(ms): 12.700658990070224
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029074959456920624
[0] Time of comm_forward(ms): 28.224935987964272
[0] Time of local aggregate(ms): 936.3217719364911
[0] Time of async wait(ms): 0.02947007305920124
[0] Time of remote aggregate(ms): 37.66234987415373
[0] Time of sum up message(ms): 0.001093139871954918
[0] Time of 1 dist conv forward(inner)(ms): 1002.2686959709972
[0] #########
[0] Time of propagate(inner)(ms) = 1002.3821629583836
[0] **************
[0] Time of linear(ms): 101.19299311190844
[0] Time of propagate(ms): 1002.3973230272532
[0] Time of add_bias(ms): 77.00975495390594
[0] Time of 1 dist conv forward(ms): 1180.60221709311
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1183.8452
[0] Time of relu(ms): 52.9933
[0] Time of dropout(ms): 200.1074
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.5615489576011896
[0] Time of prepare recv data(ms): 0.00026100315153598785
[0] Time of barrier (all to all)(ms): 0.2729790285229683
[0] Time of comm data (all to all)(ms): 12.601615861058235
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.029529212042689323
[0] Time of comm_forward(ms): 16.208825865760446
[0] Time of local aggregate(ms): 178.8185250479728
[0] Time of async wait(ms): 0.011683907359838486
[0] Time of remote aggregate(ms): 7.706935983151197
[0] Time of sum up message(ms): 0.0007811468094587326
[0] Time of 1 dist conv forward(inner)(ms): 202.77628116309643
[0] #########
[0] Time of propagate(inner)(ms) = 202.89650605991483
[0] **************
[0] Time of linear(ms): 24.18423816561699
[0] Time of propagate(ms): 202.9221779666841
[0] Time of add_bias(ms): 14.388964045792818
[0] Time of 1 dist conv forward(ms): 241.49677902460098
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 8, loss: 1.32866632938385
[0] $$$$
[0] Time of prepare send data(ms): 11.139719979837537
[0] Time of prepare recv data(ms): 0.0005830079317092896
[0] Time of barrier (all to all)(ms): 0.2926480956375599
[0] Time of comm data (all to all)(ms): 12.617266969755292
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.030288007110357285
[0] Time of comm_forward(ms): 28.297465993091464
[0] Time of local aggregate(ms): 937.8788331523538
[0] Time of async wait(ms): 0.01364690251648426
[0] Time of remote aggregate(ms): 37.562730023637414
[0] Time of sum up message(ms): 0.0007259659469127655
[0] Time of 1 dist conv forward(inner)(ms): 1003.7836900446564
[0] #########
[0] Time of propagate(inner)(ms) = 1003.8965791463852
[1] elapsed time of allocating memory (spmm on forward): 0.00095
[0] elapsed time of allocating memory (spmm on forward): 0.000953
[1] elapsed time of no tile's kernel = 739.078ms
[1] elapsed time of no tile's spmm:739.145
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000546
[1] elapsed time of no tile's kernel = 36.7581ms
[1] elapsed time of no tile's spmm:36.8125
[0] elapsed time of no tile's kernel = 886.495ms
[0] elapsed time of no tile's spmm:886.564
[0] elapsed time of allocating memory (spmm on forward): [0] 0.00099
[0] elapsed time of no tile's kernel = [0] 37.3825ms
[0] elapsed time of no tile's spmm:37.4448
[0] elapsed time of allocating memory (spmm on forward): 0.000963
[1] elapsed time of allocating memory (spmm on forward): 0.001101
[1] elapsed time of no tile's kernel = 128.403[1] ms
[1] elapsed time of no tile's spmm:128.468
[1] elapsed time of allocating memory (spmm on forward): [1] 0.00057
[1] elapsed time of no tile's kernel = 7.18286[1] ms
[1] elapsed time of no tile's spmm:7.23767
[0] elapsed time of no tile's kernel = 161.251ms
[0] elapsed time of no tile's spmm:161.32
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000762
[0] elapsed time of no tile's kernel = [0] 7.2972ms
[0] elapsed time of no tile's spmm:7.34941
[1] elapsed time of allocating memory (spmm on forward): 0.001433
[1] elapsed time of no tile's kernel = 3.79156ms
[1] elapsed time of no tile's spmm:3.84815
[1] elapsed time of allocating memory (spmm on forward): 0.000845
[0] elapsed time of allocating memory (spmm on forward): 0.001205
[0] elapsed time of no tile's kernel = 3.86749ms
[0] elapsed time of no tile's spmm:3.92424
[0] elapsed time of allocating memory (spmm on forward): 0.00111[0] 
[1] elapsed time of no tile's kernel = 150.533ms
[1] elapsed time of no tile's spmm:150.609
[0] elapsed time of no tile's kernel = 165.141ms
[0] elapsed time of no tile's spmm:165.199
[1] elapsed time of allocating memory (spmm on forward): 0.001096
[1] elapsed time of no tile's kernel = 20.0552ms
[1] elapsed time of no tile's spmm:20.1207
[0] elapsed time of allocating memory (spmm on forward): 0.001094[0] 
[0] elapsed time of no tile's kernel = 20.0249ms
[0] elapsed time of no tile's spmm:20.0931
[1] elapsed time of allocating memory (spmm on forward): 0.001218
[0] elapsed time of allocating memory (spmm on forward): 0.000944
[1] elapsed time of no tile's kernel = 767.092ms
[1] elapsed time of no tile's spmm:767.161
[0] elapsed time of no tile's kernel = 887.546ms
[0] elapsed time of no tile's spmm:887.622
[1] elapsed time of allocating memory (spmm on forward): 0.001024
[1] elapsed time of no tile's kernel = 20.129ms
[1] elapsed time of no tile's spmm:20.191
[1] elapsed time of allocating memory (spmm on forward): 0.001068
[0] elapsed time of allocating memory (spmm on forward): 0.001327
[0] elapsed time of no tile's kernel = 20.0446ms
[0] elapsed time of no tile's spmm:20.1094
[0] elapsed time of allocating memory (spmm on forward): 0.001186
[1] elapsed time of no tile's kernel = 826.196ms
[1] elapsed time of no tile's spmm:826.281
[0] elapsed time of no tile's kernel = 885.792ms
[0] elapsed time of no tile's spmm:885.882
[1] elapsed time of allocating memory (spmm on forward): 0.001204
[0] elapsed time of allocating memory (spmm on forward): 0.000889[0] 
[1] elapsed time of no tile's kernel = 733.364ms
[1] elapsed time of no tile's spmm:733.432
[1] elapsed time of allocating memory (spmm on forward): [1] 0.001001
[1] elapsed time of no tile's kernel = [1] 36.9386ms
[1] elapsed time of no tile's spmm:36.9937
[0] elapsed time of no tile's kernel = 885.895ms
[0] elapsed time of no tile's spmm:885.969
[0] elapsed time of allocating memory (spmm on forward): [0] 0.001124
[0] elapsed time of no tile's kernel = [0] 37.0895ms
[0] elapsed time of no tile's spmm:37.1522
[1] elapsed time of allocating memory (spmm on forward): 0.001036
[0] elapsed time of allocating memory (spmm on forward): 0.001006
[1] elapsed time of no tile's kernel = 731.824ms
[1] elapsed time of no tile's spmm:731.892
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000703
[1] elapsed time of no tile's kernel = 36.9723ms
[1] elapsed time of no tile's spmm:37.0519
[0] elapsed time of no tile's kernel = 882.317ms
[0] elapsed time of no tile's spmm:882.387
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000704
[0] elapsed time of no tile's kernel = [0] 37.2842ms
[0] elapsed time of no tile's spmm:37.3393
[0] elapsed time of allocating memory (spmm on forward): 0.001482
[1] elapsed time of allocating memory (spmm on forward): 0.000881
[1] elapsed time of no tile's kernel = 128.312ms
[1] elapsed time of no tile's spmm:128.373
[1] elapsed time of allocating memory (spmm on forward): [1] 0.000761
[1] elapsed time of no tile's kernel = 7.28863ms
[1] elapsed time of no tile's spmm:7.34113
[0] elapsed time of no tile's kernel = 160.526ms
[0] elapsed time of no tile's spmm:160.597
[0] elapsed time of allocating memory (spmm on forward): [0] 0.000948
[0] elapsed time of no tile's kernel = [0] 7.09406ms
[0] elapsed time of no tile's spmm:7.14538
[1] Time of linear(ms): 54.29442599415779
[1] Time of propagate(ms): 855.5367349181324
[1] Time of add_bias(ms): 74.53563320450485
[1] Time of 1 dist conv forward(ms): 984.3681170605123
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 987.7279
[1] Time of relu(ms): 50.4334
[1] Time of dropout(ms): 195.2081
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.446084965020418
[1] Time of prepare recv data(ms): 0.0006188638508319855
[1] Time of barrier (all to all)(ms): 163.00949407741427
[1] Time of comm data (all to all)(ms): 12.218520045280457
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.02805003896355629
[1] Time of comm_forward(ms): 188.1716139614582
[1] Time of local aggregate(ms): 793.6517428606749
[1] Time of async wait(ms): 0.012661097571253777
[1] Time of remote aggregate(ms): 37.25188411772251
[1] Time of sum up message(ms): 0.0006989575922489166
[1] Time of 1 dist conv forward(inner)(ms): 1019.1166510339826
[1] #########
[1] Time of propagate(inner)(ms) = 1019.2381429951638
[1] **************
[1] Time of linear(ms): 99.21924490481615
[1] Time of propagate(ms): 1019.2545601166785
[1] Time of add_bias(ms): 74.0234418772161
[1] Time of 1 dist conv forward(ms): 1192.499368917197
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1195.8358
[1] Time of relu(ms): 51.7368
[1] Time of dropout(ms): 196.0477
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.1176100708544254
[1] Time of prepare recv data(ms): 0.0003059394657611847
[1] Time of barrier (all to all)(ms): 157.99153712578118
[1] Time of comm data (all to all)(ms): 12.257889844477177
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.030467985197901726
[1] Time of comm_forward(ms): 173.05733100511134
[1] Time of local aggregate(ms): 147.88976800628006
[1] Time of async wait(ms): 0.012970063835382462
[1] Time of remote aggregate(ms): 7.674010004848242
[1] Time of sum up message(ms): 0.0008170027285814285
[1] Time of 1 dist conv forward(inner)(ms): 328.6653640680015
[1] #########
[1] Time of propagate(inner)(ms) = 328.7967520300299
[1] **************
[1] Time of linear(ms): 25.648514972999692
[1] Time of propagate(ms): 328.8147230632603
[1] Time of add_bias(ms): 15.772456070408225
[1] Time of 1 dist conv forward(ms): 370.23800518363714
[1] **************
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] rank: 1, epoch: 9, loss: 0.42289137840270996
[1] training end.
[1] sparse_tensor test!
[1] $$$$
[1] Time of prepare send data(ms): 9.451017947867513
[1] Time of prepare recv data(ms): 0.0002530869096517563
[1] Time of barrier (all to all)(ms): 3.233382012695074
[1] Time of comm data (all to all)(ms): 12.273643864318728
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.04128599539399147
[1] Time of comm_forward(ms): 28.472516918554902
[1] Time of local aggregate(ms): 787.1585940010846
[1] Time of async wait(ms): 0.011746073141694069
[1] Time of remote aggregate(ms): 37.43179701268673
[1] Time of sum up message(ms): 0.0008270144462585449
[1] Time of 1 dist conv forward(inner)(ms): 853.1167670153081
[1] #########
[1] Time of propagate(inner)(ms) = 853.2553100958467
[1] **************
[1] Time of linear(ms): 54.09926897846162
[1] Time of propagate(ms): 853.2746930141002
[1] Time of add_bias(ms): 73.80561903119087
[1] Time of 1 dist conv forward(ms): 981.1809910461307
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 984.5391
[1] Time of relu(ms): 50.8896
[1] Time of dropout(ms): 0.0427
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 9.318612050265074
[1] Time of prepare recv data(ms): 0.0002689193934202194
[1] Time of barrier (all to all)(ms): 163.97509211674333
[1] Time of comm data (all to all)(ms): 12.57049199193716
[1] $$$$
[1] tensor([  0, 256], dtype=torch.int32)
[1] tensor([  0, 256], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029546907171607018
[1] Time of comm_forward(ms): 189.31321008130908
[1] Time of local aggregate(ms): 786.599081940949
[1] Time of async wait(ms): 0.011383090168237686
[1] Time of remote aggregate(ms): 37.49382495880127
[1] Time of sum up message(ms): 0.0008109491318464279
[1] Time of 1 dist conv forward(inner)(ms): 1013.447857927531
[1] #########
[1] Time of propagate(inner)(ms) = 1013.5672250762582
[1] **************
[1] Time of linear(ms): 98.76255202107131
[1] Time of propagate(ms): 1013.5843520984054
[1] Time of add_bias(ms): 74.24052292481065
[1] Time of 1 dist conv forward(ms): 1186.5894100628793
[1] **************
[1] ----------------------------------------
[1] Time of conv(ms): 1189.7396
[1] Time of relu(ms): 50.7498
[1] Time of dropout(ms): 0.0450
[1] ----------------------------------------
[1] $$$$
[1] Time of prepare send data(ms): 2.131422981619835
[1] Time of prepare recv data(ms): 0.0004868488758802414
[1] Time of barrier (all to all)(ms): 157.10465121082962
[1] Time of comm data (all to all)(ms): 12.829885818064213
[1] $$$$
[1] tensor([ 0, 47], dtype=torch.int32)
[1] tensor([ 0, 47], dtype=torch.int32)
[1] #########
[1] Time of prepare comm_forward(ms): 0.029925024136900902
[1] Time of comm_forward(ms): 172.7397060021758
[1] Time of local aggregate(ms): 147.79009600169957
[1] Time of async wait(ms): 0.012079952284693718
[1] Time of remote aggregate(ms): 7.764982059597969
[1] Time of sum up message(ms): 0.001125037670135498
[1] Time of 1 dist conv forward(inner)(ms): 328.3379140775651
[1] #########
[1] Time of propagate(inner)(ms) = 328.4486688207835
[1] **************
[1] Time of linear(ms): 25.76083713211119
[1] Time of propagate(ms): 328.4651869907975
[1] Time of add_bias(ms): 15.864746877923608
[1] Time of 1 dist conv forward(ms): 370.09282992221415
[1] **************
[1] local num_correct_data = 86152, local num_entire_dataset = 92940
[1] local num_correct_data = 17733, local num_entire_dataset = 19448
[1] local num_correct_data = 804874, local num_entire_dataset = 1096739
[0] **************
[0] Time of linear(ms): 54.47656288743019
[0] Time of propagate(ms): 1003.9123299065977
[0] Time of add_bias(ms): 78.14094913192093
[0] Time of 1 dist conv forward(ms): 1136.5315199363977
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1139.9532
[0] Time of relu(ms): 52.8330
[0] Time of dropout(ms): 198.7945
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 11.012976989150047
[0] Time of prepare recv data(ms): 0.0006509944796562195
[0] Time of barrier (all to all)(ms): 0.27087097987532616
[0] Time of comm data (all to all)(ms): 12.468145927414298
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.0302980188280344
[0] Time of comm_forward(ms): 27.97886892221868
[0] Time of local aggregate(ms): 942.1594589948654
[0] Time of async wait(ms): 0.011986121535301208
[0] Time of remote aggregate(ms): 37.89073182269931
[0] Time of sum up message(ms): 0.0007301568984985352
[0] Time of 1 dist conv forward(inner)(ms): 1008.0720740370452
[0] #########
[0] Time of propagate(inner)(ms) = 1008.1920598167926
[0] **************
[0] Time of linear(ms): 101.16510698571801
[0] Time of propagate(ms): 1008.2063060253859
[0] Time of add_bias(ms): 77.13685696944594
[0] Time of 1 dist conv forward(ms): 1186.5096809342504
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1189.7639
[0] Time of relu(ms): 52.4716
[0] Time of dropout(ms): 200.6580
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.6531778275966644
[0] Time of prepare recv data(ms): 0.00027008354663848877
[0] Time of barrier (all to all)(ms): 0.2807870041579008
[0] Time of comm data (all to all)(ms): 12.537665897980332
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.0306800939142704
[0] Time of comm_forward(ms): 16.260232077911496
[0] Time of local aggregate(ms): 179.71857683733106
[0] Time of async wait(ms): 0.011528143659234047
[0] Time of remote aggregate(ms): 7.761026034131646
[0] Time of sum up message(ms): 0.0007378403097391129
[0] Time of 1 dist conv forward(inner)(ms): 203.78278102725744
[0] #########
[0] Time of propagate(inner)(ms) = 203.9040771778673
[0] **************
[0] Time of linear(ms): 24.932747008278966
[0] Time of propagate(ms): 203.91882117837667
[0] Time of add_bias(ms): 14.376451959833503
[0] Time of 1 dist conv forward(ms): 243.22943901643157
[0] **************
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] rank: 0, epoch: 9, loss: 1.2066011428833008
[0] training end.
[0] forward_time(ms): 42503.1875
[0] backward_time(ms): 49656.5859375
[0] share_grad_time(ms): 0.0130385160446167
[0] update_weight_time(ms): 87.20706176757812
[0] total_training_time(ms): 92254.7265625
[0] sparse_tensor test!
[0] $$$$
[0] Time of prepare send data(ms): 10.973296128213406
[0] Time of prepare recv data(ms): 0.0004169996827840805
[0] Time of barrier (all to all)(ms): 0.2835600171238184
[0] Time of comm data (all to all)(ms): 12.515177950263023
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.03614113666117191
[0] Time of comm_forward(ms): 28.0340148601681
[0] Time of local aggregate(ms): 941.4536701515317
[0] Time of async wait(ms): 0.02996879629790783
[0] Time of remote aggregate(ms): 37.55796700716019
[0] Time of sum up message(ms): 0.0007061753422021866
[0] Time of 1 dist conv forward(inner)(ms): 1007.1124681271613
[0] #########
[0] Time of propagate(inner)(ms) = 1007.227387977764
[0] **************
[0] Time of linear(ms): 54.61311084218323
[0] Time of propagate(ms): 1007.244038162753
[0] Time of add_bias(ms): 76.8743809312582
[0] Time of 1 dist conv forward(ms): 1138.7326130643487
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1142.1587
[0] Time of relu(ms): 52.3709
[0] Time of dropout(ms): 0.0434
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 10.952145094051957
[0] Time of prepare recv data(ms): 0.0003189779818058014
[0] Time of barrier (all to all)(ms): 0.3020181320607662
[0] Time of comm data (all to all)(ms): 12.821667827665806
[0] $$$$
[0] tensor([  0, 256], dtype=torch.int32)
[0] tensor([  0, 256], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02911803312599659
[0] Time of comm_forward(ms): 28.279837919399142
[0] Time of local aggregate(ms): 937.5929520465434
[0] Time of async wait(ms): 0.012859003618359566
[0] Time of remote aggregate(ms): 37.771533941850066
[0] Time of sum up message(ms): 0.0006980262696743011
[0] Time of 1 dist conv forward(inner)(ms): 1003.6869989708066
[0] #########
[0] Time of propagate(inner)(ms) = 1003.8173028733581
[0] **************
[0] Time of linear(ms): 100.74503812938929
[0] Time of propagate(ms): 1003.8333418779075
[0] Time of add_bias(ms): 76.91354607231915
[0] Time of 1 dist conv forward(ms): 1181.4933919813484
[0] **************
[0] ----------------------------------------
[0] Time of conv(ms): 1184.6692
[0] Time of relu(ms): 53.5489
[0] Time of dropout(ms): 0.0419
[0] ----------------------------------------
[0] $$$$
[0] Time of prepare send data(ms): 2.619061851873994
[0] Time of prepare recv data(ms): 0.00040209852159023285
[0] Time of barrier (all to all)(ms): 0.2725459635257721
[0] Time of comm data (all to all)(ms): 13.095533940941095
[0] $$$$
[0] tensor([ 0, 47], dtype=torch.int32)
[0] tensor([ 0, 47], dtype=torch.int32)
[0] #########
[0] Time of prepare comm_forward(ms): 0.02971803769469261
[0] Time of comm_forward(ms): 16.778317047283053
[0] Time of local aggregate(ms): 180.01107405871153
[0] Time of async wait(ms): 0.011930009350180626
[0] Time of remote aggregate(ms): 7.536589866504073
[0] Time of sum up message(ms): 0.0007359776645898819
[0] Time of 1 dist conv forward(inner)(ms): 204.36836499720812
[0] #########
[0] Time of propagate(inner)(ms) = 204.4772629160434
[0] **************
[0] Time of linear(ms): 24.939456954598427
[0] Time of propagate(ms): 204.49201110750437
[0] Time of add_bias(ms): 14.502533944323659
[0] Time of 1 dist conv forward(ms): 243.93528909422457
[0] **************
[0] local num_correct_data = 73458, local num_entire_dataset = 103675
[0] local num_correct_data = 14125, local num_entire_dataset = 19875
[0] local num_correct_data = 624767, local num_entire_dataset = 1116352
[0] size of correct training sample = 159610, size of correct valid sample = 31858, size of correct test sample = 1429641
[0] size of all training sample = 196615, size of all valid sample = 39323, size of all test sample = 2213091
[0] Train: 0.8118, Val: 0.8102, Test: 0.6460
End Time:    Fri Jun  9 01:24:51 JST 2023
