OMP: Info #155: KMP_AFFINITY: Initial OS proc set respected: 0-19,40-59
OMP: Info #216: KMP_AFFINITY: decoding x2APIC ids.
OMP: Info #157: KMP_AFFINITY: 40 available OS procs
OMP: Info #158: KMP_AFFINITY: Uniform topology
OMP: Info #287: KMP_AFFINITY: topology layer "LL cache" is equivalent to "socket".
OMP: Info #287: KMP_AFFINITY: topology layer "L3 cache" is equivalent to "socket".
OMP: Info #287: KMP_AFFINITY: topology layer "L2 cache" is equivalent to "core".
OMP: Info #287: KMP_AFFINITY: topology layer "L1 cache" is equivalent to "core".
OMP: Info #192: KMP_AFFINITY: 1 socket x 20 cores/socket x 2 threads/core (20 total cores)
OMP: Info #218: KMP_AFFINITY: OS proc to physical thread map:
OMP: Info #172: KMP_AFFINITY: OS proc 0 maps to socket 0 core 0 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 40 maps to socket 0 core 0 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 1 maps to socket 0 core 1 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 41 maps to socket 0 core 1 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 2 maps to socket 0 core 2 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 42 maps to socket 0 core 2 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 3 maps to socket 0 core 3 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 43 maps to socket 0 core 3 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 4 maps to socket 0 core 4 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 44 maps to socket 0 core 4 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 5 maps to socket 0 core 8 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 45 maps to socket 0 core 8 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 6 maps to socket 0 core 9 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 46 maps to socket 0 core 9 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 7 maps to socket 0 core 10 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 47 maps to socket 0 core 10 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 8 maps to socket 0 core 11 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 48 maps to socket 0 core 11 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 9 maps to socket 0 core 12 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 49 maps to socket 0 core 12 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 10 maps to socket 0 core 16 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 50 maps to socket 0 core 16 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 11 maps to socket 0 core 17 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 51 maps to socket 0 core 17 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 12 maps to socket 0 core 18 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 52 maps to socket 0 core 18 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 13 maps to socket 0 core 19 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 53 maps to socket 0 core 19 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 14 maps to socket 0 core 20 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 54 maps to socket 0 core 20 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 15 maps to socket 0 core 24 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 55 maps to socket 0 core 24 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 16 maps to socket 0 core 25 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 56 maps to socket 0 core 25 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 17 maps to socket 0 core 26 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 57 maps to socket 0 core 26 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 18 maps to socket 0 core 27 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 58 maps to socket 0 core 27 thread 1 
OMP: Info #172: KMP_AFFINITY: OS proc 19 maps to socket 0 core 28 thread 0 
OMP: Info #172: KMP_AFFINITY: OS proc 59 maps to socket 0 core 28 thread 1 
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920507 thread 0 bound to OS proc set 0
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920510 thread 1 bound to OS proc set 1
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920511 thread 2 bound to OS proc set 2
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920512 thread 3 bound to OS proc set 3
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920514 thread 5 bound to OS proc set 5
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920513 thread 4 bound to OS proc set 4
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920515 thread 6 bound to OS proc set 6
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920516 thread 7 bound to OS proc set 7
/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/python3.9/site-packages/torch_geometric-2.0.4-py3.9.egg/torch_geometric/nn/spmm_kernel.py:11: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  target_flops_on_rows = total_flops_on_rows // num_threads_on_row
OMP: Info #254: KMP_AFFINITY: pid 2920507 tid 2920605 thread 8 bound to OS proc set 8
graph_name = arxiv, model_name = sage, is_async = False, is_fp16 = False
num_epochs = 10, in_channels = 128, hidden_channels = 256, out_channels = 40
input_dir = ../dataset/ogbn_arxiv_new/ogbn_arxiv_1_part
Rank = 0, Number of threads = 8
int64
nodes_id_range: 0 - 169342
nodes_feat_list.shape:
(169343, 128)
float32
int64
[[   411    640   1162 ...  30351  35711 103121]
 [     0      0      0 ... 169341 169341 169341]]
local remote_nodes_num_from_each_subgraph:
tensor([0])
int64
elapsed time of loading dataset mask(ms) = 2.2302549332380295
elapsed time of obtaining number of remote nodes(ms) = 14.052671962417662
elapsed time of obtaining list of remote nodes(ms) = 0.11720799375325441
convs.0.bias torch.Size([256])
convs.0.lin.weight torch.Size([256, 128])
convs.1.bias torch.Size([256])
convs.1.lin.weight torch.Size([256, 256])
convs.2.bias torch.Size([40])
convs.2.lin.weight torch.Size([40, 256])
tensor([     0,  21483,  41571,  62717,  81415, 103299, 123993, 147144, 169343],
       dtype=torch.int32)
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.05647307261824608
Time of comm_forward(ms): 0.018103979527950287
Time of allocate out(ms): 6.224773940630257
Time of local aggregate(ms): 767.5068241078407
Time of async wait(ms): 0.0012009404599666595
Time of remote aggregate(ms): 0.006251037120819092
Time of sum up message(ms): 0.00026193447411060333
Time of 1 dist conv forward(inner)(ms): 773.813889012672
#########
Time of propagate(inner)(ms) = 773.9203129895031
**************
Time of linear(ms): 15.455469023436308
Time of propagate(ms): 773.9468649961054
Time of add_bias(ms): 13.085323967970908
Time of 1 dist conv forward(ms): 809.8750120261684
**************
----------------------------------------
Time of conv(ms): 810.4289
Time of relu(ms): 8.5463
Time of dropout(ms): 31.9544
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023385975509881973
Time of comm_forward(ms): 0.013999058865010738
Time of allocate out(ms): 6.153736962005496
Time of local aggregate(ms): 20.41257405653596
Time of async wait(ms): 0.0009259674698114395
Time of remote aggregate(ms): 0.006246962584555149
Time of sum up message(ms): 0.00026996713131666183
Time of 1 dist conv forward(inner)(ms): 26.61113895010203
#########
Time of propagate(inner)(ms) = 26.691632927395403
**************
Time of linear(ms): 23.79491808824241
Time of propagate(ms): 26.70535200741142
Time of add_bias(ms): 13.154975953511894
Time of 1 dist conv forward(ms): 70.3993410570547
**************
----------------------------------------
Time of conv(ms): 71.0896
Time of relu(ms): 8.4657
Time of dropout(ms): 31.2737
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022765016183257103
Time of comm_forward(ms): 0.014744000509381294
Time of allocate out(ms): 1.451643998734653
Time of local aggregate(ms): 3.95381695125252
Time of async wait(ms): 0.001050066202878952
Time of remote aggregate(ms): 0.004441011697053909
Time of sum up message(ms): 0.00016600824892520905
Time of 1 dist conv forward(inner)(ms): 5.4486270528286695
#########
Time of propagate(inner)(ms) = 5.522117950022221
**************
Time of linear(ms): 5.55914209689945
Time of propagate(ms): 5.533267976716161
Time of add_bias(ms): 1.9393980037420988
Time of 1 dist conv forward(ms): 20.381508977152407
**************
tensor([     0,  21421,  42761,  63542,  84604, 106135, 127069, 148286, 169343],
       dtype=torch.int32)
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.0049889786168932915
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005912967026233673
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.0074160052463412285
#########
rank: 0, epoch: 0, loss: 3.7211735248565674
Epoch: 0 time: 2.068 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02536596730351448
Time of comm_forward(ms): 0.014733988791704178
Time of allocate out(ms): 6.050206022337079
Time of local aggregate(ms): 20.402945927344263
Time of async wait(ms): 0.0008720671758055687
Time of remote aggregate(ms): 0.004309928044676781
Time of sum up message(ms): 0.00029010698199272156
Time of 1 dist conv forward(inner)(ms): 26.498724007979035
#########
Time of propagate(inner)(ms) = 26.594373979605734
**************
Time of linear(ms): 14.715904020704329
Time of propagate(ms): 26.607378968037665
Time of add_bias(ms): 12.835589004680514
Time of 1 dist conv forward(ms): 54.15986105799675
**************
----------------------------------------
Time of conv(ms): 54.7096
Time of relu(ms): 8.6816
Time of dropout(ms): 31.9144
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.024146982468664646
Time of comm_forward(ms): 0.016193022020161152
Time of allocate out(ms): 5.896870046854019
Time of local aggregate(ms): 20.44959692284465
Time of async wait(ms): 0.001425039954483509
Time of remote aggregate(ms): 0.005634035915136337
Time of sum up message(ms): 0.0001869630068540573
Time of 1 dist conv forward(inner)(ms): 26.394053013063967
#########
Time of propagate(inner)(ms) = 26.476514991372824
**************
Time of linear(ms): 25.548091041855514
Time of propagate(ms): 26.48882905486971
Time of add_bias(ms): 12.980589992366731
Time of 1 dist conv forward(ms): 65.018480992876
**************
----------------------------------------
Time of conv(ms): 65.7011
Time of relu(ms): 8.7526
Time of dropout(ms): 31.4738
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022899010218679905
Time of comm_forward(ms): 0.015484052710235119
Time of allocate out(ms): 1.5860339626669884
Time of local aggregate(ms): 4.002562956884503
Time of async wait(ms): 0.001318054273724556
Time of remote aggregate(ms): 0.006629037670791149
Time of sum up message(ms): 0.00020291190594434738
Time of 1 dist conv forward(inner)(ms): 5.635129986330867
#########
Time of propagate(inner)(ms) = 5.713513935916126
**************
Time of linear(ms): 5.9303040616214275
Time of propagate(ms): 5.725174909457564
Time of add_bias(ms): 1.8584240460768342
Time of 1 dist conv forward(ms): 13.51489603985101
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.0063069164752960205
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.007411930710077286
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00667001586407423
#########
rank: 0, epoch: 1, loss: 3.1321048736572266
Epoch: 1 time: 0.4498 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023954082280397415
Time of comm_forward(ms): 0.015613972209393978
Time of allocate out(ms): 6.144018960185349
Time of local aggregate(ms): 20.457850070670247
Time of async wait(ms): 0.0008560018613934517
Time of remote aggregate(ms): 0.006179907359182835
Time of sum up message(ms): 0.00019907020032405853
Time of 1 dist conv forward(inner)(ms): 26.648672064766288
#########
Time of propagate(inner)(ms) = 26.72185399569571
**************
Time of linear(ms): 14.695371966809034
Time of propagate(ms): 26.753647020086646
Time of add_bias(ms): 12.900123954750597
Time of 1 dist conv forward(ms): 54.349950049072504
**************
----------------------------------------
Time of conv(ms): 54.8914
Time of relu(ms): 8.2888
Time of dropout(ms): 32.0714
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02330401912331581
Time of comm_forward(ms): 0.015489058569073677
Time of allocate out(ms): 6.133171962574124
Time of local aggregate(ms): 20.40269400458783
Time of async wait(ms): 0.0008320203050971031
Time of remote aggregate(ms): 0.005490030162036419
Time of sum up message(ms): 0.0002039596438407898
Time of 1 dist conv forward(inner)(ms): 26.581185054965317
#########
Time of propagate(inner)(ms) = 26.700891088694334
**************
Time of linear(ms): 25.228067999705672
Time of propagate(ms): 26.714766048826277
Time of add_bias(ms): 12.87500699982047
Time of 1 dist conv forward(ms): 64.81873407028615
**************
----------------------------------------
Time of conv(ms): 65.5048
Time of relu(ms): 8.6218
Time of dropout(ms): 31.5837
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02451101318001747
Time of comm_forward(ms): 0.015710946172475815
Time of allocate out(ms): 1.2456850381568074
Time of local aggregate(ms): 3.984758979640901
Time of async wait(ms): 0.000908970832824707
Time of remote aggregate(ms): 0.005181995220482349
Time of sum up message(ms): 0.0002019805833697319
Time of 1 dist conv forward(inner)(ms): 5.276958923786879
#########
Time of propagate(inner)(ms) = 5.348894977942109
**************
Time of linear(ms): 4.554864019155502
Time of propagate(ms): 5.360106937587261
Time of add_bias(ms): 1.8201629864051938
Time of 1 dist conv forward(ms): 11.735960957594216
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00599399209022522
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006656046025454998
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005860929377377033
#########
rank: 0, epoch: 2, loss: 3.376132011413574
Epoch: 2 time: 0.4445 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.024138018488883972
Time of comm_forward(ms): 0.013910001143813133
Time of allocate out(ms): 6.159647018648684
Time of local aggregate(ms): 20.48474201001227
Time of async wait(ms): 0.0009819632396101952
Time of remote aggregate(ms): 0.005629030056297779
Time of sum up message(ms): 0.00026694033294916153
Time of 1 dist conv forward(inner)(ms): 26.689314981922507
#########
Time of propagate(inner)(ms) = 26.761006098240614
**************
Time of linear(ms): 14.472468057647347
Time of propagate(ms): 26.773580932058394
Time of add_bias(ms): 13.030963018536568
Time of 1 dist conv forward(ms): 54.27800491452217
**************
----------------------------------------
Time of conv(ms): 54.8264
Time of relu(ms): 8.3679
Time of dropout(ms): 31.8032
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023888074792921543
Time of comm_forward(ms): 0.015057972632348537
Time of allocate out(ms): 6.0561009449884295
Time of local aggregate(ms): 20.62299009412527
Time of async wait(ms): 0.0010099029168486595
Time of remote aggregate(ms): 0.005650101229548454
Time of sum up message(ms): 0.00016891863197088242
Time of 1 dist conv forward(inner)(ms): 26.72486600931734
#########
Time of propagate(inner)(ms) = 26.801044936291873
**************
Time of linear(ms): 24.458403000608087
Time of propagate(ms): 26.813078904524446
Time of add_bias(ms): 12.857180088758469
Time of 1 dist conv forward(ms): 64.12964407354593
**************
----------------------------------------
Time of conv(ms): 64.8261
Time of relu(ms): 8.5337
Time of dropout(ms): 31.3511
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022862921468913555
Time of comm_forward(ms): 0.014286022633314133
Time of allocate out(ms): 1.4857479836791754
Time of local aggregate(ms): 3.8968990556895733
Time of async wait(ms): 0.0010279472917318344
Time of remote aggregate(ms): 0.0056730350479483604
Time of sum up message(ms): 0.0001869630068540573
Time of 1 dist conv forward(inner)(ms): 5.426683928817511
#########
Time of propagate(inner)(ms) = 5.499199964106083
**************
Time of linear(ms): 5.626286030746996
Time of propagate(ms): 5.511548952199519
Time of add_bias(ms): 1.8426270689815283
Time of 1 dist conv forward(ms): 12.981225037947297
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005046953447163105
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006795977242290974
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.0059390440583229065
#########
rank: 0, epoch: 3, loss: 3.0679128170013428
Epoch: 3 time: 0.4432 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02604501787573099
Time of comm_forward(ms): 0.016617937944829464
Time of allocate out(ms): 6.155956070870161
Time of local aggregate(ms): 20.49763291142881
Time of async wait(ms): 0.0008140923455357552
Time of remote aggregate(ms): 0.0049578957259655
Time of sum up message(ms): 0.00027404166758060455
Time of 1 dist conv forward(inner)(ms): 26.702297967858613
#########
Time of propagate(inner)(ms) = 26.791897951625288
**************
Time of linear(ms): 14.573441003449261
Time of propagate(ms): 26.80488396435976
Time of add_bias(ms): 12.93225004337728
Time of 1 dist conv forward(ms): 54.311410058289766
**************
----------------------------------------
Time of conv(ms): 54.8653
Time of relu(ms): 8.4456
Time of dropout(ms): 31.8174
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023294007405638695
Time of comm_forward(ms): 0.015666009858250618
Time of allocate out(ms): 6.000851979479194
Time of local aggregate(ms): 20.487328991293907
Time of async wait(ms): 0.000959029421210289
Time of remote aggregate(ms): 0.005176989361643791
Time of sum up message(ms): 0.0002019805833697319
Time of 1 dist conv forward(inner)(ms): 26.533478987403214
#########
Time of propagate(inner)(ms) = 26.60929097328335
**************
Time of linear(ms): 24.242414045147598
Time of propagate(ms): 26.621966972015798
Time of add_bias(ms): 12.93173898011446
Time of 1 dist conv forward(ms): 63.796992995776236
**************
----------------------------------------
Time of conv(ms): 64.4891
Time of relu(ms): 8.7052
Time of dropout(ms): 31.7800
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022856052964925766
Time of comm_forward(ms): 0.014437944628298283
Time of allocate out(ms): 1.4661649474874139
Time of local aggregate(ms): 4.0185950929299
Time of async wait(ms): 0.0010289950296282768
Time of remote aggregate(ms): 0.006377929821610451
Time of sum up message(ms): 0.00026402994990348816
Time of 1 dist conv forward(inner)(ms): 5.52972499281168
#########
Time of propagate(inner)(ms) = 5.611701984889805
**************
Time of linear(ms): 4.453631932847202
Time of propagate(ms): 5.623416043817997
Time of add_bias(ms): 1.805483945645392
Time of 1 dist conv forward(ms): 11.883649975061417
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.0065159983932971954
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006921007297933102
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006644055247306824
#########
rank: 0, epoch: 4, loss: 3.020237445831299
Epoch: 4 time: 0.4443 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.024526030756533146
Time of comm_forward(ms): 0.015815021470189095
Time of allocate out(ms): 6.201092037372291
Time of local aggregate(ms): 20.426505943760276
Time of async wait(ms): 0.0009019859135150909
Time of remote aggregate(ms): 0.004610046744346619
Time of sum up message(ms): 0.0003420282155275345
Time of 1 dist conv forward(inner)(ms): 26.67379309423268
#########
Time of propagate(inner)(ms) = 26.760836946778
**************
Time of linear(ms): 14.60968202445656
Time of propagate(ms): 26.773063000291586
Time of add_bias(ms): 12.902125949040055
Time of 1 dist conv forward(ms): 54.28589601069689
**************
----------------------------------------
Time of conv(ms): 54.8330
Time of relu(ms): 8.1508
Time of dropout(ms): 31.7624
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022766063921153545
Time of comm_forward(ms): 0.015184981748461723
Time of allocate out(ms): 6.161998026072979
Time of local aggregate(ms): 20.482494961470366
Time of async wait(ms): 0.0008940696716308594
Time of remote aggregate(ms): 0.006026006303727627
Time of sum up message(ms): 0.0001859152689576149
Time of 1 dist conv forward(inner)(ms): 26.689550024457276
#########
Time of propagate(inner)(ms) = 26.767331059090793
**************
Time of linear(ms): 24.990229052491486
Time of propagate(ms): 26.779572945088148
Time of add_bias(ms): 12.809892068617046
Time of 1 dist conv forward(ms): 64.58068499341607
**************
----------------------------------------
Time of conv(ms): 65.2492
Time of relu(ms): 8.3911
Time of dropout(ms): 31.2294
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.026450026780366898
Time of comm_forward(ms): 0.015474972315132618
Time of allocate out(ms): 1.5264221001416445
Time of local aggregate(ms): 3.90912895090878
Time of async wait(ms): 0.0007280614227056503
Time of remote aggregate(ms): 0.005044974386692047
Time of sum up message(ms): 0.00016600824892520905
Time of 1 dist conv forward(inner)(ms): 5.483415094204247
#########
Time of propagate(inner)(ms) = 5.554410978220403
**************
Time of linear(ms): 5.501790903508663
Time of propagate(ms): 5.565869039855897
Time of add_bias(ms): 1.8197799799963832
Time of 1 dist conv forward(ms): 12.8883789293468
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00587396789342165
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.007385970093309879
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006616930477321148
#########
rank: 0, epoch: 5, loss: 2.960744857788086
Epoch: 5 time: 0.443 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.025023939087986946
Time of comm_forward(ms): 0.014774035662412643
Time of allocate out(ms): 6.132452050223947
Time of local aggregate(ms): 20.50188893917948
Time of async wait(ms): 0.0009890645742416382
Time of remote aggregate(ms): 0.005877926014363766
Time of sum up message(ms): 0.00020302832126617432
Time of 1 dist conv forward(inner)(ms): 26.681208983063698
#########
Time of propagate(inner)(ms) = 26.764009962789714
**************
Time of linear(ms): 14.60321806371212
Time of propagate(ms): 26.776427985168993
Time of add_bias(ms): 12.838960974477232
Time of 1 dist conv forward(ms): 54.21985301654786
**************
----------------------------------------
Time of conv(ms): 54.7439
Time of relu(ms): 8.4642
Time of dropout(ms): 31.8125
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.025106011889874935
Time of comm_forward(ms): 0.015219906345009804
Time of allocate out(ms): 6.05526810977608
Time of local aggregate(ms): 20.52607899531722
Time of async wait(ms): 0.0010059447959065437
Time of remote aggregate(ms): 0.005632056854665279
Time of sum up message(ms): 0.0001828884705901146
Time of 1 dist conv forward(inner)(ms): 26.628493913449347
#########
Time of propagate(inner)(ms) = 26.705570053309202
**************
Time of linear(ms): 24.91535199806094
Time of propagate(ms): 26.71767002902925
Time of add_bias(ms): 13.011196977458894
Time of 1 dist conv forward(ms): 64.64502098970115
**************
----------------------------------------
Time of conv(ms): 65.3411
Time of relu(ms): 8.6987
Time of dropout(ms): 31.6398
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023703090846538544
Time of comm_forward(ms): 0.015223980881273746
Time of allocate out(ms): 0.588621012866497
Time of local aggregate(ms): 3.8883909583091736
Time of async wait(ms): 0.0010760268196463585
Time of remote aggregate(ms): 0.004826928488910198
Time of sum up message(ms): 0.00018009450286626816
Time of 1 dist conv forward(inner)(ms): 4.522022092714906
#########
Time of propagate(inner)(ms) = 4.588062991388142
**************
Time of linear(ms): 4.517778987064958
Time of propagate(ms): 4.598833969794214
Time of add_bias(ms): 1.9018009770661592
Time of 1 dist conv forward(ms): 11.019231984391809
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006224028766155243
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00704603735357523
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005764886736869812
#########
rank: 0, epoch: 6, loss: 2.872819662094116
Epoch: 6 time: 0.4446 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.030642026104032993
Time of comm_forward(ms): 0.013909069821238518
Time of allocate out(ms): 6.171840941533446
Time of local aggregate(ms): 20.434656995348632
Time of async wait(ms): 0.0014550751075148582
Time of remote aggregate(ms): 0.005771988071501255
Time of sum up message(ms): 0.00027299392968416214
Time of 1 dist conv forward(inner)(ms): 26.65854908991605
#########
Time of propagate(inner)(ms) = 26.730058016255498
**************
Time of linear(ms): 14.345588977448642
Time of propagate(ms): 26.74371504690498
Time of add_bias(ms): 13.077826006338
Time of 1 dist conv forward(ms): 54.1681150207296
**************
----------------------------------------
Time of conv(ms): 54.7266
Time of relu(ms): 8.3443
Time of dropout(ms): 31.8407
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.022060004994273186
Time of comm_forward(ms): 0.01469592098146677
Time of allocate out(ms): 6.070582079701126
Time of local aggregate(ms): 20.59656393248588
Time of async wait(ms): 0.0008700881153345108
Time of remote aggregate(ms): 0.006261980161070824
Time of sum up message(ms): 0.0003440072759985924
Time of 1 dist conv forward(inner)(ms): 26.711378013715148
#########
Time of propagate(inner)(ms) = 26.799676939845085
**************
Time of linear(ms): 24.51636700425297
Time of propagate(ms): 26.81344107259065
Time of add_bias(ms): 13.072476955130696
Time of 1 dist conv forward(ms): 64.40354499500245
**************
----------------------------------------
Time of conv(ms): 65.0847
Time of relu(ms): 8.8048
Time of dropout(ms): 31.3282
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023261993192136288
Time of comm_forward(ms): 0.014137942343950272
Time of allocate out(ms): 0.593707081861794
Time of local aggregate(ms): 3.9316440233960748
Time of async wait(ms): 0.0007979106158018112
Time of remote aggregate(ms): 0.00512308906763792
Time of sum up message(ms): 0.00017997808754444122
Time of 1 dist conv forward(inner)(ms): 4.5688520185649395
#########
Time of propagate(inner)(ms) = 4.639812046661973
**************
Time of linear(ms): 4.481679992750287
Time of propagate(ms): 4.651200957596302
Time of add_bias(ms): 2.0365749951452017
Time of 1 dist conv forward(ms): 11.170179932378232
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.004553003236651421
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006266054697334766
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.01423293724656105
#########
rank: 0, epoch: 7, loss: 2.7403564453125
Epoch: 7 time: 0.442 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.025735003873705864
Time of comm_forward(ms): 0.016339938156306744
Time of allocate out(ms): 6.246700068004429
Time of local aggregate(ms): 20.48620895948261
Time of async wait(ms): 0.0008910428732633591
Time of remote aggregate(ms): 0.00508397351950407
Time of sum up message(ms): 0.00018300488591194153
Time of 1 dist conv forward(inner)(ms): 26.78114199079573
#########
Time of propagate(inner)(ms) = 26.89446194563061
**************
Time of linear(ms): 14.407620066776872
Time of propagate(ms): 26.90693992190063
Time of add_bias(ms): 13.009599992074072
Time of 1 dist conv forward(ms): 54.32496895082295
**************
----------------------------------------
Time of conv(ms): 54.8731
Time of relu(ms): 8.2668
Time of dropout(ms): 31.8667
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02084404695779085
Time of comm_forward(ms): 0.01463096123188734
Time of allocate out(ms): 6.132623995654285
Time of local aggregate(ms): 20.537623087875545
Time of async wait(ms): 0.0009019859135150909
Time of remote aggregate(ms): 0.006361980922520161
Time of sum up message(ms): 0.00018195714801549911
Time of 1 dist conv forward(inner)(ms): 26.71316801570356
#########
Time of propagate(inner)(ms) = 26.788859046064317
**************
Time of linear(ms): 24.628927931189537
Time of propagate(ms): 26.800506049767137
Time of add_bias(ms): 12.936598039232194
Time of 1 dist conv forward(ms): 64.36730909626931
**************
----------------------------------------
Time of conv(ms): 65.0440
Time of relu(ms): 8.6667
Time of dropout(ms): 31.7263
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02304802183061838
Time of comm_forward(ms): 0.015686964616179466
Time of allocate out(ms): 0.6208419799804688
Time of local aggregate(ms): 3.9297359762713313
Time of async wait(ms): 0.0006420304998755455
Time of remote aggregate(ms): 0.0049889786168932915
Time of sum up message(ms): 0.00016798730939626694
Time of 1 dist conv forward(inner)(ms): 4.595111939124763
#########
Time of propagate(inner)(ms) = 4.6610410790890455
**************
Time of linear(ms): 4.471963969990611
Time of propagate(ms): 4.670803085900843
Time of add_bias(ms): 1.8927159253507853
Time of 1 dist conv forward(ms): 11.036360985599458
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005813897587358952
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00682496465742588
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006741960532963276
#########
rank: 0, epoch: 8, loss: 2.6902554035186768
Epoch: 8 time: 0.4423 sec
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.025585992261767387
Time of comm_forward(ms): 0.014898017980158329
Time of allocate out(ms): 6.19680795352906
Time of local aggregate(ms): 20.49253205768764
Time of async wait(ms): 0.001174979843199253
Time of remote aggregate(ms): 0.005131005309522152
Time of sum up message(ms): 0.0002869637683033943
Time of 1 dist conv forward(inner)(ms): 26.73641697037965
#########
Time of propagate(inner)(ms) = 26.811779011040926
**************
Time of linear(ms): 14.510141918435693
Time of propagate(ms): 26.825706008821726
Time of add_bias(ms): 13.023338979110122
Time of 1 dist conv forward(ms): 54.360394016839564
**************
----------------------------------------
Time of conv(ms): 54.9176
Time of relu(ms): 8.3635
Time of dropout(ms): 32.0746
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023074098862707615
Time of comm_forward(ms): 0.015541911125183105
Time of allocate out(ms): 5.934337037615478
Time of local aggregate(ms): 20.560453995130956
Time of async wait(ms): 0.0008729984983801842
Time of remote aggregate(ms): 0.005563022568821907
Time of sum up message(ms): 0.0002150190994143486
Time of 1 dist conv forward(inner)(ms): 26.54005808290094
#########
Time of propagate(inner)(ms) = 26.6183769563213
**************
Time of linear(ms): 24.73408996593207
Time of propagate(ms): 26.630524080246687
Time of add_bias(ms): 12.936979997903109
Time of 1 dist conv forward(ms): 64.30266599636525
**************
----------------------------------------
Time of conv(ms): 64.9974
Time of relu(ms): 8.6599
Time of dropout(ms): 31.6988
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02316501922905445
Time of comm_forward(ms): 0.015198951587080956
Time of allocate out(ms): 0.5816210759803653
Time of local aggregate(ms): 3.9499119156971574
Time of async wait(ms): 0.0009160721674561501
Time of remote aggregate(ms): 0.004581990651786327
Time of sum up message(ms): 0.00027299392968416214
Time of 1 dist conv forward(inner)(ms): 4.575668019242585
#########
Time of propagate(inner)(ms) = 4.6476180432364345
**************
Time of linear(ms): 4.458829993382096
Time of propagate(ms): 4.658454097807407
Time of add_bias(ms): 1.8757309298962355
Time of 1 dist conv forward(ms): 10.993829928338528
**************
tensor([ 0, 40], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.006421003490686417
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.00813603401184082
#########
tensor([  0, 256], dtype=torch.int32)
#########
Time of scatter gradient to local nodes(ms): 0.005905982106924057
#########
rank: 0, epoch: 9, loss: 2.5905184745788574
Epoch: 9 time: 0.4446 sec
training end.
forward_time(ms): 2935.3984375
backward_time(ms): 3123.19580078125
share_grad_time(ms): 0.022029154002666473
update_weight_time(ms): 7.8115386962890625
total_training_time(ms): 6067.234375
sparse_tensor test!
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02591405063867569
Time of comm_forward(ms): 0.016639940440654755
Time of allocate out(ms): 6.154622999019921
Time of local aggregate(ms): 20.501681021414697
Time of async wait(ms): 0.0009069917723536491
Time of remote aggregate(ms): 0.004708999767899513
Time of sum up message(ms): 0.00018603168427944183
Time of 1 dist conv forward(inner)(ms): 26.70466003473848
#########
Time of propagate(inner)(ms) = 26.77805908024311
**************
Time of linear(ms): 14.658710919320583
Time of propagate(ms): 26.790083036758006
Time of add_bias(ms): 12.851663050241768
Time of 1 dist conv forward(ms): 54.301780997775495
**************
----------------------------------------
Time of conv(ms): 54.8469
Time of relu(ms): 8.2497
Time of dropout(ms): 0.0446
----------------------------------------
tensor([  0, 256], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.023799948394298553
Time of comm_forward(ms): 0.01548707950860262
Time of allocate out(ms): 5.981381982564926
Time of local aggregate(ms): 20.402434980496764
Time of async wait(ms): 0.0011220108717679977
Time of remote aggregate(ms): 0.004895031452178955
Time of sum up message(ms): 0.00018195714801549911
Time of 1 dist conv forward(inner)(ms): 26.429302990436554
#########
Time of propagate(inner)(ms) = 26.518726954236627
**************
Time of linear(ms): 24.67004698701203
Time of propagate(ms): 26.532309013418853
Time of add_bias(ms): 12.977625010535121
Time of 1 dist conv forward(ms): 64.18076902627945
**************
----------------------------------------
Time of conv(ms): 64.7464
Time of relu(ms): 8.7253
Time of dropout(ms): 0.0375
----------------------------------------
tensor([ 0, 40], dtype=torch.int32)
#########
Time of prepare comm_forward(ms): 0.02157490234822035
Time of comm_forward(ms): 0.015573110431432724
Time of allocate out(ms): 0.6084139458835125
Time of local aggregate(ms): 3.9156910497695208
Time of async wait(ms): 0.0009048962965607643
Time of remote aggregate(ms): 0.005111098289489746
Time of sum up message(ms): 0.00036600977182388306
Time of 1 dist conv forward(inner)(ms): 4.567635012790561
#########
Time of propagate(inner)(ms) = 4.637645906768739
**************
Time of linear(ms): 4.562568967230618
Time of propagate(ms): 4.6487080398947
Time of add_bias(ms): 1.9185020355507731
Time of 1 dist conv forward(ms): 11.13048696424812
**************
local num_correct_data = 29966, local num_entire_dataset = 90941
local num_correct_data = 10748, local num_entire_dataset = 29799
local num_correct_data = 16550, local num_entire_dataset = 48603
size of correct training sample = 29966, size of correct valid sample = 10748, size of correct test sample = 16550
size of all training sample = 90941, size of all valid sample = 29799, size of all test sample = 48603
Train: 0.3295, Val: 0.3607, Test: 0.3405
