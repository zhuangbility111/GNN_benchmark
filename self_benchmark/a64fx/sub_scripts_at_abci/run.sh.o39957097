NUM_THREADS: 20
CONDA_PREFIX: /home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10
Running 2 tasks on 1 nodes
CCL count: ,2
Affinity: , 0 1 20 21
/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/bin/python
/bin/gcc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpicc
/apps/intel/2023.0/mpi/2021.8.0/bin/mpiexec.hydra
#### INITIAL ENV ####
Using CCL_ROOT=/groups/4/gac50544/gaa10008ku.ori/gaa10008ku.group2/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/python3.9/site-packages/oneccl_bind_pt-1.10.0-py3.9-linux-x86_64.egg/torch_ccl
Using CCL_WORKER_AFFINITY=0,1,20,21
Using CCL_WORKER_COUNT=2
Using I_MPI_HYDRA_BOOTSTRAP=sge
Using I_MPI_JOB_RESPECT_PROCESS_PLACEMENT=0
Using I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000]
Using I_MPI_ROOT=/apps/intel/2023.0/mpi/2021.8.0
Using KMP_AFFINITY=compact,1,granularity=fine,verbose
Using KMP_BLOCKTIME=1
Using OMP_NUM_THREADS=18
Using LD_PRELOAD=/home/aaa10008ku/gcn.work/dgl_intel_setting_1/sub407/miniconda3/envs/torch-1.10/lib/libiomp5.so
Using ARGS_NTASKS=2
Using ARGS_PPN=1
#### INITIAL ENV ####
PyTorch version: 1.10.0
MASTER_ADDR=g0028.abci.local
Running mpiexec.hydra -np 2 -ppn 1  -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18  python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=true --num_epochs=20
[0] g0028.abci.local
[1] g0029.abci.local
Running mpiexec.hydra -np 2 -ppn 1 -l -genv I_MPI_PIN_DOMAIN=[0x00000FFFFC,0xFFFFC00000] -genv CCL_WORKER_AFFINITY=0,1,20,21 -genv CCL_WORKER_COUNT=2 -genv OMP_NUM_THREADS=18 python dist_pyg_test.py --graph_name=products --model=sage --is_async=false --input_dir=./dataset/ogbn_products_new/ogbn_products_2_part --random_seed=0 --is_fp16=true --num_epochs=20
Start Time:  Fri Jun  9 01:28:47 JST 2023
[1] graph_name = products, model_name = sage, is_async = False, is_fp16 = True
[1] num_epochs = 20, in_channels = 100, hidden_channels = 256, out_channels = 47
[1] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[1] PMI_SIZE = 2
[1] PMI_RANK = 1
[1] use ccl backend for torch.distributed package on x86 cpu.
[1] dist_info RANK: 1, SIZE: 2
[1] Rank = 1, Number of threads = 18
[1] int64
[1] nodes_id_range: 1239902 - 2449028
[1] nodes_feat_list.shape:
[1] (1209127, 100)
[1] float32
[1] int64
[1] [[    567    1560    3949 ... 1127231 1158662 1174515]
[1]  [      0       0       0 ... 1209126 1209126 1209126]]
[1] local remote_nodes_num_from_each_subgraph:
[1] tensor([289377,      0])
[1] int64
[1] elapsed time of loading dataset mask(ms) = 73.32778698764741
[1] elapsed time of obtaining number of remote nodes(ms) = 2031.2948960345238
[1] elapsed time of obtaining list of remote nodes(ms) = 139.8228849284351
[1] convs.0.bias torch.Size([256])
[1] convs.0.lin.weight torch.Size([256, 100])
[1] convs.1.bias torch.Size([256])
[1] convs.1.lin.weight torch.Size([256, 256])
[1] convs.2.bias torch.Size([47])
[1] convs.2.lin.weight torch.Size([47, 256])
[0] graph_name = products, model_name = sage, is_async = False, is_fp16 = True
[0] num_epochs = 20, in_channels = 100, hidden_channels = 256, out_channels = 47
[0] input_dir = ./dataset/ogbn_products_new/ogbn_products_2_part
[0] PMI_SIZE = 2
[0] PMI_RANK = 0
[0] use ccl backend for torch.distributed package on x86 cpu.
[0] dist_info RANK: 0, SIZE: 2
[0] Rank = 0, Number of threads = 18
[0] int64
[0] nodes_id_range: 0 - 1239901
[0] nodes_feat_list.shape:
[0] (1239902, 100)
[0] float32
[0] int64
[0] [[    100     642    1983 ...  499311  808625  964678]
[0]  [      0       0       0 ... 1239901 1239901 1239901]]
[0] local remote_nodes_num_from_each_subgraph:
[0] tensor([     0, 244144])
[0] int64
[0] elapsed time of loading dataset mask(ms) = 154.45711510255933
[0] elapsed time of obtaining number of remote nodes(ms) = 2207.247314043343
[0] elapsed time of obtaining list of remote nodes(ms) = 139.87417286261916
[0] convs.0.bias torch.Size([256])
[0] convs.0.lin.weight torch.Size([256, 100])
[0] convs.1.bias torch.Size([256])
[0] convs.1.lin.weight torch.Size([256, 256])
[0] convs.2.bias torch.Size([47])
[0] convs.2.lin.weight torch.Size([47, 256])
End Time:    Fri Jun  9 01:29:33 JST 2023
